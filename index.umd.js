(function(e,t){typeof exports==`object`&&typeof module<`u`?t(exports,require(`quill`)):typeof define==`function`&&define.amd?define([`exports`,`quill`],t):(e=typeof globalThis<`u`?globalThis:e||self,t(e.TableUp={},e.Quill))})(this,function(e,t){Object.defineProperty(e,`__esModule`,{value:!0});var n=Object.create,r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,o=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,c=(e,t,n,o)=>{if(t&&typeof t==`object`||typeof t==`function`)for(var c=a(t),l=0,u=c.length,d;l<u;l++)d=c[l],!s.call(e,d)&&d!==n&&r(e,d,{get:(e=>t[e]).bind(null,d),enumerable:!(o=i(t,d))||o.enumerable});return e};t=((e,t,i)=>(i=e==null?{}:n(o(e)),c(t||!e||!e.__esModule?r(i,`default`,{value:e,enumerable:!0}):i,e)))(t);function l(e,t){this.v=e,this.k=t}function u(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function d(e){if(Array.isArray(e))return e}function f(e){if(Array.isArray(e))return u(e)}function p(e){if(e===void 0)throw ReferenceError(`this hasn't been initialised - super() hasn't been called`);return e}function m(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(e){n(e);return}s.done?t(c):Promise.resolve(c).then(r,i)}function h(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){m(a,r,i,o,s,`next`,e)}function s(e){m(a,r,i,o,s,`throw`,e)}o(void 0)})}}function g(e,t,n){return t=C(t),ee(e,T()?Reflect.construct(t,n||[],C(e).constructor):t.apply(e,n))}function _(e,t){if(!(e instanceof t))throw TypeError(`Cannot call a class as a function`)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,`value`in r&&(r.writable=!0),Object.defineProperty(e,ie(r.key),r)}}function y(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),Object.defineProperty(e,`prototype`,{writable:!1}),e}function b(e,t){var n=typeof Symbol<`u`&&e[Symbol.iterator]||e[`@@iterator`];if(!n){if(Array.isArray(e)||(n=oe(e))||t&&e&&typeof e.length==`number`){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||n.return==null||n.return()}finally{if(s)throw a}}}}function x(e,t,n){return(t=ie(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(){return S=typeof Reflect<`u`&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=ne(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},S.apply(null,arguments)}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}function w(e,t){if(typeof t!=`function`&&t!==null)throw TypeError(`Super expression must either be null or a function`);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,`prototype`,{writable:!1}),t&&te(e,t)}function T(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(T=function(){return!!e})()}function E(e){if(typeof Symbol<`u`&&e[Symbol.iterator]!=null||e[`@@iterator`]!=null)return Array.from(e)}function D(e,t){var n=e==null?null:typeof Symbol<`u`&&e[Symbol.iterator]||e[`@@iterator`];if(n!=null){var r,i,a,o,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}function O(){throw TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k(){throw TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?A(Object(n),!0).forEach(function(t){x(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function M(e,t){if(e==null)return{};var n,r,i=N(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function N(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function ee(e,t){if(t&&(typeof t==`object`||typeof t==`function`))return t;if(t!==void 0)throw TypeError(`Derived constructors may only return object or undefined`);return p(e)}function P(){P=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=typeof Symbol==`function`?Symbol:{},a=i.iterator||`@@iterator`,o=i.asyncIterator||`@@asyncIterator`,s=i.toStringTag||`@@toStringTag`;function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},``)}catch(e){c=function(e,t,n){return e[t]=n}}function l(t,n,r,i){var a=n&&n.prototype instanceof f?n:f,o=Object.create(a.prototype);return c(o,`_invoke`,function(t,n,r){var i=1;return function(a,o){if(i===3)throw Error(`Generator is already running`);if(i===4){if(a===`throw`)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if(r.method===`next`)r.sent=r._sent=r.arg;else if(r.method===`throw`){if(i===1)throw i=4,r.arg;r.dispatchException(r.arg)}else r.method===`return`&&r.abrupt(`return`,r.arg);i=3;var l=u(t,n,r);if(l.type===`normal`){if(i=r.done?4:2,l.arg===d)continue;return{value:l.arg,done:r.done}}l.type===`throw`&&(i=4,r.method=`throw`,r.arg=l.arg)}}}(t,r,new w(i||[])),!0),o}function u(e,t,n){try{return{type:`normal`,arg:e.call(t,n)}}catch(e){return{type:`throw`,arg:e}}}t.wrap=l;var d={};function f(){}function p(){}function m(){}var h={};c(h,a,function(){return this});var g=Object.getPrototypeOf,_=g&&g(g(T([])));_&&_!==n&&r.call(_,a)&&(h=_);var v=m.prototype=f.prototype=Object.create(h);function y(e){[`next`,`throw`,`return`].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function b(e,t){function n(i,a,o,s){var c=u(e[i],e,a);if(c.type!==`throw`){var l=c.arg,d=l.value;return d&&typeof d==`object`&&r.call(d,`__await`)?t.resolve(d.__await).then(function(e){n(`next`,e,o,s)},function(e){n(`throw`,e,o,s)}):t.resolve(d).then(function(e){l.value=e,o(l)},function(e){return n(`throw`,e,o,s)})}s(c.arg)}var i;c(this,`_invoke`,function(e,r){function a(){return new t(function(t,i){n(e,r,t,i)})}return i=i?i.then(a,a):a()},!0)}function x(t,n){var r=n.method,i=t.i[r];if(i===e)return n.delegate=null,r===`throw`&&t.i.return&&(n.method=`return`,n.arg=e,x(t,n),n.method===`throw`)||r!==`return`&&(n.method=`throw`,n.arg=TypeError(`The iterator does not provide a '`+r+`' method`)),d;var a=u(i,t.i,n.arg);if(a.type===`throw`)return n.method=`throw`,n.arg=a.arg,n.delegate=null,d;var o=a.arg;return o?o.done?(n[t.r]=o.value,n.next=t.n,n.method!==`return`&&(n.method=`next`,n.arg=e),n.delegate=null,d):o:(n.method=`throw`,n.arg=TypeError(`iterator result is not an object`),n.delegate=null,d)}function S(e){this.tryEntries.push(e)}function C(t){var n=t[4]||{};n.type=`normal`,n.arg=e,t[4]=n}function w(e){this.tryEntries=[[-1]],e.forEach(S,this),this.reset(!0)}function T(t){if(t!=null){var n=t[a];if(n)return n.call(t);if(typeof t.next==`function`)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw TypeError(typeof t+` is not iterable`)}return p.prototype=m,c(v,`constructor`,m),c(m,`constructor`,p),p.displayName=c(m,s,`GeneratorFunction`),t.isGeneratorFunction=function(e){var t=typeof e==`function`&&e.constructor;return!!t&&(t===p||(t.displayName||t.name)===`GeneratorFunction`)},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,s,`GeneratorFunction`)),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},y(b.prototype),c(b.prototype,o,function(){return this}),t.AsyncIterator=b,t.async=function(e,n,r,i,a){a===void 0&&(a=Promise);var o=new b(l(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},y(v),c(v,s,`Generator`),c(v,a,function(){return this}),c(v,`toString`,function(){return`[object Generator]`}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=T,w.prototype={constructor:w,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method=`next`,this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)n.charAt(0)===`t`&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if(e.type===`throw`)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){o.type=`throw`,o.arg=t,n.next=e}for(var i=n.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a[4],s=this.prev,c=a[1],l=a[2];if(a[0]===-1)return r(`end`),!1;if(!c&&!l)throw Error(`try statement without catch or finally`);if(a[0]!=null&&a[0]<=s){if(s<c)return this.method=`next`,this.arg=e,r(c),!0;if(s<l)return r(l),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var i=r;break}}i&&(e===`break`||e===`continue`)&&i[0]<=t&&t<=i[2]&&(i=null);var a=i?i[4]:{};return a.type=e,a.arg=t,i?(this.method=`next`,this.next=i[2],d):this.complete(a)},complete:function(e,t){if(e.type===`throw`)throw e.arg;return e.type===`break`||e.type===`continue`?this.next=e.arg:e.type===`return`?(this.rval=this.arg=e.arg,this.method=`return`,this.next=`end`):e.type===`normal`&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),C(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if(r.type===`throw`){var i=r.arg;C(n)}return i}}throw Error(`illegal catch attempt`)},delegateYield:function(t,n,r){return this.delegate={i:T(t),r:n,n:r},this.method===`next`&&(this.arg=e),d}},t}function te(e,t){return te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},te(e,t)}function F(e,t){return d(e)||D(e,t)||oe(e,t)||O()}function ne(e,t){for(;!{}.hasOwnProperty.call(e,t)&&(e=C(e))!==null;);return e}function I(e,t,n,r){var i=S(C(1&r?e.prototype:e),t,n);return 2&r&&typeof i==`function`?function(e){return i.apply(n,e)}:i}function L(e){return f(e)||E(e)||oe(e)||k()}function re(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function ie(e){var t=re(e,`string`);return typeof t==`symbol`?t:t+``}function ae(e){"@babel/helpers - typeof";return ae=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?function(e){return typeof e}:function(e){return e&&typeof Symbol==`function`&&e.constructor===Symbol&&e!==Symbol.prototype?`symbol`:typeof e},ae(e)}function oe(e,t){if(e){if(typeof e==`string`)return u(e,t);var n={}.toString.call(e).slice(8,-1);return n===`Object`&&e.constructor&&(n=e.constructor.name),n===`Map`||n===`Set`?Array.from(e):n===`Arguments`||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function se(e){var t,n;function r(t,n){try{var a=e[t](n),o=a.value,s=o instanceof l;Promise.resolve(s?o.v:o).then(function(n){if(s){var c=t===`return`?`return`:`next`;if(!o.k||n.done)return r(c,n);n=e[c](n).value}i(a.done?`return`:`normal`,n)},function(e){r(`throw`,e)})}catch(e){i(`throw`,e)}}function i(e,i){switch(e){case`return`:t.resolve({value:i,done:!0});break;case`throw`:t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise(function(a,o){var s={key:e,arg:i,resolve:a,reject:o,next:null};n?n=n.next=s:(t=n=s,r(e,i))})},typeof e.return!=`function`&&(this.return=void 0)}se.prototype[typeof Symbol==`function`&&Symbol.asyncIterator||`@@asyncIterator`]=function(){return this},se.prototype.next=function(e){return this._invoke(`next`,e)},se.prototype.throw=function(e){return this._invoke(`throw`,e)},se.prototype.return=function(e){return this._invoke(`return`,e)};var R={container:`table-up-container`,tableCaption:`table-up-caption`,tableWrapper:`table-up`,tableMain:`table-up-main`,tableColgroup:`table-up-colgroup`,tableCol:`table-up-col`,tableHead:`table-up-head`,tableBody:`table-up-body`,tableFoot:`table-up-foot`,tableRow:`table-up-row`,tableCell:`table-up-cell`,tableCellInner:`table-up-cell-inner`},z={colMinWidthPre:5,colMinWidthPx:40,colDefaultWidth:100,rowMinHeightPx:36},B={AFTER_TABLE_RESIZE:`after-table-resize`,TABLE_SELECTION_DRAG_START:`table-selection-drag-start`,TABLE_SELECTION_DRAG_END:`table-selection-drag-end`,TABLE_SELECTION_CHANGE:`table-selection-change`,TABLE_SELECTION_DISPLAY_CHANGE:`table-selection-display-change`},V={moduleName:`table-up`,tableSelectionName:`table-selection`},ce=[[`rgb(255, 255, 255)`,`rgb(0, 0, 0)`,`rgb(72, 83, 104)`,`rgb(41, 114, 244)`,`rgb(0, 163, 245)`,`rgb(49, 155, 98)`,`rgb(222, 60, 54)`,`rgb(248, 136, 37)`,`rgb(245, 196, 0)`,`rgb(153, 56, 215)`],[`rgb(242, 242, 242)`,`rgb(127, 127, 127)`,`rgb(243, 245, 247)`,`rgb(229, 239, 255)`,`rgb(229, 246, 255)`,`rgb(234, 250, 241)`,`rgb(254, 233, 232)`,`rgb(254, 243, 235)`,`rgb(254, 249, 227)`,`rgb(253, 235, 255)`],[`rgb(216, 216, 216)`,`rgb(89, 89, 89)`,`rgb(197, 202, 211)`,`rgb(199, 220, 255)`,`rgb(199, 236, 255)`,`rgb(195, 234, 213)`,`rgb(255, 201, 199)`,`rgb(255, 220, 196)`,`rgb(255, 238, 173)`,`rgb(242, 199, 255)`],[`rgb(191, 191, 191)`,`rgb(63, 63, 63)`,`rgb(128, 139, 158)`,`rgb(153, 190, 255)`,`rgb(153, 221, 255)`,`rgb(152, 215, 182)`,`rgb(255, 156, 153)`,`rgb(255, 186, 132)`,`rgb(255, 226, 112)`,`rgb(213, 142, 255)`],[`rgb(165, 165, 165)`,`rgb(38, 38, 38)`,`rgb(53, 59, 69)`,`rgb(20, 80, 184)`,`rgb(18, 116, 165)`,`rgb(39, 124, 79)`,`rgb(158, 30, 26)`,`rgb(184, 96, 20)`,`rgb(163, 130, 0)`,`rgb(94, 34, 129)`],[`rgb(147, 147, 147)`,`rgb(13, 13, 13)`,`rgb(36, 39, 46)`,`rgb(12, 48, 110)`,`rgb(10, 65, 92)`,`rgb(24, 78, 50)`,`rgb(88, 17, 14)`,`rgb(92, 48, 10)`,`rgb(102, 82, 0)`,`rgb(59, 21, 81)`]],le=`table-up`,ue=new Set([R.tableCellInner]),de=function(e){return ue.has(e.statics.blotName)};function fe(e){return e&&e.parent?de(e.parent)?!0:fe(e.parent):!1}function H(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:le,n=t?`${t}-`:``;return{b:function(){return`${n}${e}`},be:function(t){return t?`${n}${e}__${t}`:``},bm:function(t){return t?`${n}${e}--${t}`:``},bem:function(t,r){return t&&r?`${n}${e}__${t}--${r}`:``},ns:function(e){return e?`${n}${e}`:``},bs:function(t){return t?`${n}${e}-${t}`:``},cv:function(e){return e?`--${n}${e}`:``},is:function(e){return`is-${e}`}}}function U(e,t){for(var n=e.parent;n&&n.statics.blotName!==t&&n!==e.scroll;)n=n.parent;if(n===e.scroll)throw Error(`${e.statics.blotName} must be a child of ${t}`);return n}function pe(e,t){for(var n=Array(t.length),r=new Map(t.map(function(e,t){return[e,t]})),i=e.parent;i&&i!==e.scroll&&r.size!==0;){if(r.has(i.statics.blotName)){var a=r.get(i.statics.blotName);n[a]=i,r.delete(i.statics.blotName)}i=i.parent}if(r.size>0)throw Error(`${e.statics.blotName} must be a child of ${Array.from(r.keys()).join(`, `)}`);return n}function me(e){for(var t=new Map,n=e;n&&n.statics.blotName!==`scroll`;)t.set(n.statics.blotName,n),n=n.parent;return t}function he(e,t){for(var n=[],r=e.children.iterator(),i=null;i=r();)i instanceof t&&n.push(i);return n}function ge(e,t,n){var r=b(Object.getOwnPropertyNames(t)),i;try{for(r.s();!(i=r.n()).done;){var a=i.value;n&&n.test(a)||Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}}catch(e){r.e(e)}finally{r.f()}return e}function _e(e,t){var n=function(e){function t(){_(this,t);for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return g(this,t,[].concat(n))}return w(t,e),y(t)}(e),r=b(t),i;try{for(r.s();!(i=r.n()).done;){var a=i.value;ge(n.prototype,a.prototype,/^constructor$/)}}catch(e){r.e(e)}finally{r.f()}return n}function ve(e,t){return e.prototype&&e.prototype instanceof t}function ye(e,t){return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)}function be(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b)),a:Math.min(1,Math.max(0,e.a))}}function xe(e){return e=e.startsWith(`#`)?e.slice(1):e,{r:Number.parseInt(e.slice(0,2),16),g:Number.parseInt(e.slice(2,4),16),b:Number.parseInt(e.slice(4,6),16),a:Number((Number.parseInt(e.slice(6,8)||`ff`,16)/255).toFixed(2))}}function Se(e){var t=e.r,n=e.g,r=e.b,i=e.a;t=ye(t,255),n=ye(n,255),r=ye(r,255);var a=Math.max(t,n,r),o=Math.min(t,n,r),s,c=a,l=a-o,u=a===0?0:l/a;if(a===o)s=0;else{switch(a){case t:s=(n-r)/l+(n<r?6:0);break;case n:s=(r-t)/l+2;break;case r:s=(t-n)/l+4;break}s/=6}return{h:s*360,s:u*100,b:c*100,a:i}}function Ce(e){var t=e.h,n=e.s,r=e.b,i=e.a;t=ye(t,360)*6,n=ye(n,100),r=ye(r,100);var a=Math.floor(t),o=t-a,s=r*(1-n),c=r*(1-o*n),l=r*(1-(1-o)*n),u=a%6,d=[r,c,s,s,l,r][u],f=[l,r,r,c,s,s][u],p=[s,s,l,r,r,c][u];return{r:Math.round(d*255),g:Math.round(f*255),b:Math.round(p*255),a:i}}function we(e){var t=[e.r.toString(16),e.g.toString(16),e.b.toString(16),Math.round(e.a*255).toString(16)];for(var n in t)t[n].length===1&&(t[n]=`0${t[n]}`);return t.join(``)}var Te=function(e){return we(Ce(e))},Ee=function(e){return typeof e==`function`},De=Array.isArray,Oe=function(e){return typeof e==`string`},ke=function(e){return typeof e==`number`},Ae=function(e){return e!==null&&ae(e)===`object`},je=function(e){return e===void 0},Me=function(e){return!Number.isNaN(e)&&Number(e)>0},Ne=function(e){return De(e)?e:[e]};function Pe(e){var t=e||{},n=t.type,r=n===void 0?`default`:n,i=t.content,a=H(`button`),o=document.createElement(`button`);return o.classList.add(a.b(),r),i&&(Oe(i)?o.textContent=i:o.appendChild(i)),o}function Fe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=230,n=150,r=10,i=Se(xe(e.color||`#ff0000`)),a=H(`color-picker`),o=document.createElement(`div`);o.classList.add(a.b());var s=document.createElement(`div`);s.classList.add(a.be(`content`));var c=document.createElement(`div`);c.classList.add(a.be(`selector`));var l=document.createElement(`div`);l.classList.add(a.be(`background`)),c.appendChild(l);var u=document.createElement(`div`);u.classList.add(a.be(`background-handle`)),l.appendChild(u);var d=document.createElement(`div`);d.classList.add(a.be(`alpha`));var f=document.createElement(`div`);f.classList.add(a.be(`alpha-bg`));var p=document.createElement(`div`);p.classList.add(a.be(`alpha-handle`)),d.appendChild(f),d.appendChild(p);var m=document.createElement(`div`);m.classList.add(a.be(`hue`));var h=document.createElement(`div`);h.classList.add(a.be(`hue-handle`)),m.appendChild(h);var g=document.createElement(`div`);g.classList.add(a.be(`action`));var _=F([`r`,`g`,`b`,`a`].map(function(e){var t=document.createElement(`div`);t.classList.add(a.be(`action-item`),e);var n=document.createElement(`label`);n.textContent=e.toUpperCase();var r=document.createElement(`input`);return r.classList.add(a.be(`input`)),r.addEventListener(`input`,function(){r.value=r.value.replaceAll(/[^0-9]/g,``)}),r.addEventListener(`change`,function(){var t=Math.round(Number(r.value));e===`a`&&(t/=100),ee(be(Se(Object.assign({},Ce(i),x({},e,t))))),N()}),t.appendChild(n),t.appendChild(r),g.appendChild(t),r}),4),v=_[0],y=_[1],S=_[2],C=_[3];s.appendChild(m),s.appendChild(c),s.appendChild(d),o.appendChild(s),o.appendChild(g);var w=!1,T=!1,E=!1;function D(){var e=Te(i),t=b([v,y,S].entries()),n;try{for(t.s();!(n=t.n()).done;){var r=F(n.value,2),a=r[0],o=r[1];o.value=String(Number.parseInt(e[a*2]+e[a*2+1],16))}}catch(e){t.e(e)}finally{t.f()}C.value=String((i.a*100).toFixed(0))}function O(){Object.assign(u.style,{left:`${Math.floor(t*i.s/100)}px`,top:`${Math.floor(n*(100-i.b)/100)}px`})}function k(){c.style.backgroundColor=`#${we(Ce({h:i.h,s:100,b:100,a:1}))}`}function A(){h.style.top=`${Math.floor(n-n*i.h/360)}px`}function j(){p.style.left=`${i.a*100}%`}function M(){var e=Ce(i),t=e.r,n=e.g,r=e.b;f.style.background=`linear-gradient(to right, rgba(${t}, ${n}, ${r}, 0) 0%, rgba(${t}, ${n}, ${r}, 1) 100%)`}function N(){O(),k(),A(),j(),M(),D()}function ee(t){i=be(Object.assign({},i,t)),D(),e.onChange&&e.onChange(`#${Te(i)}`)}function P(e){var r=c.getBoundingClientRect(),i=r.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),a=r.left+document.body.scrollLeft;ee({s:Math.floor(100*Math.max(0,Math.min(t,e.pageX-a))/t),b:Math.floor(100*(n-Math.max(0,Math.min(n,e.pageY-i)))/n)}),N()}function te(e){var t=m.getBoundingClientRect().top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0);ee({h:Math.floor(360*(n-Math.max(0,Math.min(n,e.pageY-t)))/n)}),N()}function ne(e){var t=e.pageX,n=d.getBoundingClientRect(),i=t-n.left;i=Math.max(r/2,i),i=Math.min(i,n.width-r/2),ee({a:Math.round((i-10/2)/(n.width-10)*100)/100}),N()}function I(e){w&&(e.preventDefault(),P(e)),T&&(e.preventDefault(),te(e)),E&&(e.preventDefault(),ne(e))}function L(){document.removeEventListener(`mousemove`,I),document.removeEventListener(`mouseup`,L),w=!1}function re(e){document.addEventListener(`mousemove`,I),document.addEventListener(`mouseup`,L),w=!0,P(e)}c.addEventListener(`mousedown`,re);function ie(){document.removeEventListener(`mousemove`,I),document.removeEventListener(`mouseup`,ie),T=!1}function ae(e){document.addEventListener(`mousemove`,I),document.addEventListener(`mouseup`,ie),T=!0,te(e)}m.addEventListener(`mousedown`,ae);function oe(){document.removeEventListener(`mousemove`,I),document.removeEventListener(`mouseup`,oe),E=!1}function se(e){document.addEventListener(`mousemove`,I),document.addEventListener(`mouseup`,oe),E=!0,ne(e)}return d.addEventListener(`mousedown`,se),N(),o}var Ie=8e3;function Le(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.child,n=e.target,r=n===void 0?document.body:n,i=e.beforeClose,a=i===void 0?function(){}:i,o=H(`dialog`),s=r,c=document.createElement(`div`);c.classList.add(o.b()),c.style.zIndex=String(Ie);var l=document.createElement(`div`);if(l.classList.add(o.be(`overlay`)),c.appendChild(l),t){var u=document.createElement(`div`);u.classList.add(o.be(`content`)),u.appendChild(t),l.appendChild(u),u.addEventListener(`click`,function(e){e.stopPropagation()})}var d=getComputedStyle(s).overflow;s.style.overflow=`hidden`,s.appendChild(c);var f=function(){a(),c.remove(),s.style.overflow=d};return c.addEventListener(`click`,f),Ie+=1,{dialog:c,close:f}}function Re(e){return ze.apply(this,arguments)}function ze(){return ze=h(P().mark(function e(t){var n,r,i;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.message,r=t.confirm,i=t.cancel,e.abrupt(`return`,new Promise(function(e){var t=document.createElement(`div`);Object.assign(t.style,{padding:`8px 12px`,fontSize:`14px`,lineHeight:`1.5`});var a=document.createElement(`p`);a.textContent=n;var o=document.createElement(`div`);Object.assign(o.style,{display:`flex`,justifyContent:`flex-end`,gap:`6px`});var s=Pe({content:i}),c=Pe({type:`confirm`,content:r});o.appendChild(s),o.appendChild(c),t.appendChild(a),t.appendChild(o);var l=Le({child:t}).close;s.addEventListener(`click`,function(){e(!1),l()}),c.addEventListener(`click`,function(){e(!0),l()})}));case 1:case`end`:return e.stop()}},e)})),ze.apply(this,arguments)}function Be(e,t){var n=H(`input`);t.type||(t.type=`text`),t.value||(t.value=``);var r=document.createElement(`div`);if(r.classList.add(n.be(`item`)),e){var i=document.createElement(`span`);i.classList.add(n.be(`label`)),i.textContent=e,r.appendChild(i)}var a=document.createElement(`div`);a.classList.add(n.be(`input`));var o=document.createElement(`input`);for(var s in t)o.setAttribute(s,t[s]);return(t.max||t.min)&&o.addEventListener(`blur`,function(){t.max&&t.max<=Number(o.value)&&(o.value=String(t.max)),t.min&&t.min>=Number(o.value)&&(o.value=String(t.min))}),a.appendChild(o),r.appendChild(a),o.addEventListener(`focus`,function(){a.classList.add(`focus`)}),o.addEventListener(`blur`,function(){a.classList.remove(`focus`)}),{item:r,input:o,errorTip:function(e){var t;return a.classList.contains(`error`)?t=a.querySelector(`.${n.be(`error-tip`)}`):(t=document.createElement(`span`),t.classList.add(n.be(`error-tip`)),a.appendChild(t)),t.textContent=e,a.classList.add(`error`),{removeError:function(){a.classList.remove(`error`),t.remove()}}}}}function Ve(){return He.apply(this,arguments)}function He(){return He=h(P().mark(function e(){var t,n,r,i,a,o,s,c,l,u,d,f,p,m,g,_,v,y=arguments;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=y.length>0&&y[0]!==void 0?y[0]:{},n=H(`creator`),r=document.createElement(`div`),r.classList.add(n.b()),i=document.createElement(`div`),i.classList.add(n.be(`input`)),a=Be(t.rowText||`Row`,{type:`number`,value:String(t.row||``),max:99}),o=a.item,s=a.input,c=a.errorTip,l=Be(t.colText||`Column`,{type:`number`,value:String(t.col||``),max:99}),u=l.item,d=l.input,f=l.errorTip,i.appendChild(o),i.appendChild(u),r.appendChild(i),p=document.createElement(`div`),p.classList.add(n.be(`control`)),m=Pe({type:`confirm`,content:t.confirmText||`Confirm`}),g=Pe({type:`default`,content:t.cancelText||`Cancel`}),p.appendChild(m),p.appendChild(g),r.appendChild(p),_=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number(s.value),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number(d.value);if(Number.isNaN(e)||e<=0){c(t.notPositiveNumberError||`Please enter a positive integer`);return}if(Number.isNaN(n)||n<=0){f(t.notPositiveNumberError||`Please enter a positive integer`);return}return{row:e,col:n}},v=function(e){e.key===`Escape`&&(close(),document.removeEventListener(`keydown`,v))},e.abrupt(`return`,new Promise(function(e,t){var n=Le({child:r,beforeClose:t}).close;s.focus();for(var i=0,a=[s,d];i<a.length;i++)a[i].addEventListener(`keydown`,function(t){if(t.key===`Enter`){var r=_();r&&(e(r),n())}});m.addEventListener(`click`,h(P().mark(function t(){var r;return P().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=_(),r&&(e(r),n());case 1:case`end`:return t.stop()}},t)}))),document.addEventListener(`keydown`,v),g.addEventListener(`click`,n)}).finally(function(){document.removeEventListener(`keydown`,v)}));case 1:case`end`:return e.stop()}},e)})),He.apply(this,arguments)}function Ue(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=H(`select-box`),n=document.createElement(`div`);n.classList.add(t.b());var r=document.createElement(`div`);r.classList.add(t.be(`block`));for(var i=0;i<(e.row||8);i++)for(var a=0;a<(e.col||8);a++){var o=document.createElement(`div`);o.classList.add(t.be(`item`)),o.dataset.row=String(i+1),o.dataset.col=String(a+1),r.appendChild(o)}var s=function(){for(var e=n.dataset,t=e.row,i=e.col,a=0,o=Array.from(r.querySelectorAll(`.active`));a<o.length;a++)o[a].classList.remove(`active`);if(!(!t||!i))for(var s=Array.from(r.children),c=0;c<s.length;c++){var l=s[c].dataset,u=l.row,d=l.col;if(u>t&&d>i)return;s[c].classList.toggle(`active`,u<=t&&d<=i)}};if(r.addEventListener(`mousemove`,function(e){if(e.target){var t=e.target.dataset,r=t.row,i=t.col;!r||!i||(n.dataset.row=r,n.dataset.col=i,s())}}),r.addEventListener(`mouseleave`,function(){n.removeAttribute(`data-row`),n.removeAttribute(`data-col`),s()}),r.addEventListener(`click`,function(){var t=n.dataset,r=t.row,i=t.col;!r||!i||e.onSelect&&e.onSelect(Number(r),Number(i))}),n.appendChild(r),e.customBtn){var c=e.texts||{},l=document.createElement(`div`);l.classList.add(t.be(`custom`)),l.textContent=c.customBtnText||`Custom`,l.addEventListener(`click`,h(P().mark(function t(){var n;return P().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ve(c);case 1:n=t.sent,n&&e.onSelect&&e.onSelect(n.row,n.col);case 2:case`end`:return t.stop()}},t)}))),n.appendChild(l)}return n}function We(e){"@babel/helpers - typeof";return We=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?function(e){return typeof e}:function(e){return e&&typeof Symbol==`function`&&e.constructor===Symbol&&e!==Symbol.prototype?`symbol`:typeof e},We(e)}function Ge(e,t){if(We(e)!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(We(r)!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function Ke(e){var t=Ge(e,`string`);return We(t)==`symbol`?t:t+``}function qe(e,t,n){return(t=Ke(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?Je(Object(n),!0).forEach(function(t){qe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let Ye=Math.min,Xe=Math.max,Ze=Math.round,Qe=Math.floor,$e=e=>({x:e,y:e}),et={left:`right`,right:`left`,bottom:`top`,top:`bottom`},tt={start:`end`,end:`start`};function nt(e,t,n){return Xe(e,Ye(t,n))}function rt(e,t){return typeof e==`function`?e(t):e}function it(e){return e.split(`-`)[0]}function at(e){return e.split(`-`)[1]}function ot(e){return e===`x`?`y`:`x`}function st(e){return e===`y`?`height`:`width`}let ct=new Set([`top`,`bottom`]);function lt(e){return ct.has(it(e))?`y`:`x`}function ut(e){return ot(lt(e))}function dt(e,t,n){n===void 0&&(n=!1);let r=at(e),i=ut(e),a=st(i),o=i===`x`?r===(n?`end`:`start`)?`right`:`left`:r===`start`?`bottom`:`top`;return t.reference[a]>t.floating[a]&&(o=bt(o)),[o,bt(o)]}function ft(e){let t=bt(e);return[pt(e),t,pt(t)]}function pt(e){return e.replace(/start|end/g,e=>tt[e])}let mt=[`left`,`right`],ht=[`right`,`left`],gt=[`top`,`bottom`],_t=[`bottom`,`top`];function vt(e,t,n){switch(e){case`top`:case`bottom`:return n?t?ht:mt:t?mt:ht;case`left`:case`right`:return t?gt:_t;default:return[]}}function yt(e,t,n,r){let i=at(e),a=vt(it(e),n===`start`,r);return i&&(a=a.map(e=>e+`-`+i),t&&(a=a.concat(a.map(pt)))),a}function bt(e){return e.replace(/left|right|bottom|top/g,e=>et[e])}function xt(e){return W({top:0,right:0,bottom:0,left:0},e)}function St(e){return typeof e==`number`?{top:e,right:e,bottom:e,left:e}:xt(e)}function Ct(e){let{x:t,y:n,width:r,height:i}=e;return{width:r,height:i,top:n,left:t,right:t+r,bottom:n+i,x:t,y:n}}function wt(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(e){n(e);return}s.done?t(c):Promise.resolve(c).then(r,i)}function Tt(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){wt(a,r,i,o,s,`next`,e)}function s(e){wt(a,r,i,o,s,`throw`,e)}o(void 0)})}}function Et(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function Dt(e,t){if(e==null)return{};var n,r,i=Et(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}let Ot=[`mainAxis`,`crossAxis`,`fallbackPlacements`,`fallbackStrategy`,`fallbackAxisSideDirection`,`flipAlignment`],kt=[`mainAxis`,`crossAxis`,`limiter`];function At(e,t,n){let{reference:r,floating:i}=e,a=lt(t),o=ut(t),s=st(o),c=it(t),l=a===`y`,u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,f=r[s]/2-i[s]/2,p;switch(c){case`top`:p={x:u,y:r.y-i.height};break;case`bottom`:p={x:u,y:r.y+r.height};break;case`right`:p={x:r.x+r.width,y:d};break;case`left`:p={x:r.x-i.width,y:d};break;default:p={x:r.x,y:r.y}}switch(at(t)){case`start`:p[o]-=f*(n&&l?-1:1);break;case`end`:p[o]+=f*(n&&l?-1:1);break}return p}let jt=function(){var e=Tt(function*(e,t,n){let{placement:r=`bottom`,strategy:i=`absolute`,middleware:a=[],platform:o}=n,s=a.filter(Boolean),c=yield o.isRTL==null?void 0:o.isRTL(t),l=yield o.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=At(l,r,c),f=r,p={},m=0;for(let n=0;n<s.length;n++){let{name:a,fn:h}=s[n],{x:g,y:_,data:v,reset:y}=yield h({x:u,y:d,initialPlacement:r,placement:f,strategy:i,middlewareData:p,rects:l,platform:o,elements:{reference:e,floating:t}});u=g==null?u:g,d=_==null?d:_,p=W(W({},p),{},{[a]:W(W({},p[a]),v)}),y&&m<=50&&(m++,typeof y==`object`&&(y.placement&&(f=y.placement),y.rects&&(l=y.rects===!0?yield o.getElementRects({reference:e,floating:t,strategy:i}):y.rects),{x:u,y:d}=At(l,f,c)),n=-1)}return{x:u,y:d,placement:f,strategy:i,middlewareData:p}});return function(t,n,r){return e.apply(this,arguments)}}();function Mt(e,t){return Nt.apply(this,arguments)}function Nt(){return Nt=Tt(function*(e,t){var n;t===void 0&&(t={});let{x:r,y:i,platform:a,rects:o,elements:s,strategy:c}=e,{boundary:l=`clippingAncestors`,rootBoundary:u=`viewport`,elementContext:d=`floating`,altBoundary:f=!1,padding:p=0}=rt(t,e),m=St(p),h=s[f?d===`floating`?`reference`:`floating`:d],g=Ct(yield a.getClippingRect({element:(n=yield a.isElement==null?void 0:a.isElement(h))==null||n?h:h.contextElement||(yield a.getDocumentElement==null?void 0:a.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),_=d===`floating`?{x:r,y:i,width:o.floating.width,height:o.floating.height}:o.reference,v=yield a.getOffsetParent==null?void 0:a.getOffsetParent(s.floating),y=(yield a.isElement==null?void 0:a.isElement(v))&&(yield a.getScale==null?void 0:a.getScale(v))||{x:1,y:1},b=Ct(a.convertOffsetParentRelativeRectToViewportRelativeRect?yield a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:_,offsetParent:v,strategy:c}):_);return{top:(g.top-b.top+m.top)/y.y,bottom:(b.bottom-g.bottom+m.bottom)/y.y,left:(g.left-b.left+m.left)/y.x,right:(b.right-g.right+m.right)/y.x}}),Nt.apply(this,arguments)}let Pt=function(e){return e===void 0&&(e={}),{name:`flip`,options:e,fn(t){return Tt(function*(){var n,r;let{placement:i,middlewareData:a,rects:o,initialPlacement:s,platform:c,elements:l}=t,u=rt(e,t),{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:m=`bestFit`,fallbackAxisSideDirection:h=`none`,flipAlignment:g=!0}=u,_=Dt(u,Ot);if((n=a.arrow)!=null&&n.alignmentOffset)return{};let v=it(i),y=lt(s),b=it(s)===s,x=yield c.isRTL==null?void 0:c.isRTL(l.floating),S=p||(b||!g?[bt(s)]:ft(s)),C=h!==`none`;!p&&C&&S.push(...yt(s,g,h,x));let w=[s,...S],T=yield Mt(t,_),E=[],D=((r=a.flip)==null?void 0:r.overflows)||[];if(d&&E.push(T[v]),f){let e=dt(i,o,x);E.push(T[e[0]],T[e[1]])}if(D=[...D,{placement:i,overflows:E}],!E.every(e=>e<=0)){var O,k;let e=(((O=a.flip)==null?void 0:O.index)||0)+1,t=w[e];if(t&&(!(f===`alignment`&&y!==lt(t))||D.every(e=>lt(e.placement)===y?e.overflows[0]>0:!0)))return{data:{index:e,overflows:D},reset:{placement:t}};let n=(k=D.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])==null?void 0:k.placement;if(!n)switch(m){case`bestFit`:{var A;let e=(A=D.filter(e=>{if(C){let t=lt(e.placement);return t===y||t===`y`}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])==null?void 0:A[0];e&&(n=e);break}case`initialPlacement`:n=s;break}if(i!==n)return{reset:{placement:n}}}return{}})()}}},Ft=new Set([`left`,`top`]);function It(e,t){return Lt.apply(this,arguments)}function Lt(){return Lt=Tt(function*(e,t){let{placement:n,platform:r,elements:i}=e,a=yield r.isRTL==null?void 0:r.isRTL(i.floating),o=it(n),s=at(n),c=lt(n)===`y`,l=Ft.has(o)?-1:1,u=a&&c?-1:1,d=rt(t,e),{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof d==`number`?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&typeof m==`number`&&(p=s===`end`?m*-1:m),c?{x:p*u,y:f*l}:{x:f*l,y:p*u}}),Lt.apply(this,arguments)}let Rt=function(e){return e===void 0&&(e=0),{name:`offset`,options:e,fn(t){return Tt(function*(){var n,r;let{x:i,y:a,placement:o,middlewareData:s}=t,c=yield It(t,e);return o===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:i+c.x,y:a+c.y,data:W(W({},c),{},{placement:o})}})()}}},zt=function(e){return e===void 0&&(e={}),{name:`shift`,options:e,fn(t){return Tt(function*(){let{x:n,y:r,placement:i}=t,a=rt(e,t),{mainAxis:o=!0,crossAxis:s=!1,limiter:c={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}}}=a,l=Dt(a,kt),u={x:n,y:r},d=yield Mt(t,l),f=lt(it(i)),p=ot(f),m=u[p],h=u[f];if(o){let e=p===`y`?`top`:`left`,t=p===`y`?`bottom`:`right`,n=m+d[e],r=m-d[t];m=nt(n,m,r)}if(s){let e=f===`y`?`top`:`left`,t=f===`y`?`bottom`:`right`,n=h+d[e],r=h-d[t];h=nt(n,h,r)}let g=c.fn(W(W({},t),{},{[p]:m,[f]:h}));return W(W({},g),{},{data:{x:g.x-n,y:g.y-r,enabled:{[p]:o,[f]:s}}})})()}}},Bt=function(e){return e===void 0&&(e={}),{options:e,fn(t){let{x:n,y:r,placement:i,rects:a,middlewareData:o}=t,{offset:s=0,mainAxis:c=!0,crossAxis:l=!0}=rt(e,t),u={x:n,y:r},d=lt(i),f=ot(d),p=u[f],m=u[d],h=rt(s,t),g=typeof h==`number`?{mainAxis:h,crossAxis:0}:W({mainAxis:0,crossAxis:0},h);if(c){let e=f===`y`?`height`:`width`,t=a.reference[f]-a.floating[e]+g.mainAxis,n=a.reference[f]+a.reference[e]-g.mainAxis;p<t?p=t:p>n&&(p=n)}if(l){var _,v;let e=f===`y`?`width`:`height`,t=Ft.has(it(i)),n=a.reference[d]-a.floating[e]+(t&&((_=o.offset)==null?void 0:_[d])||0)+(t?0:g.crossAxis),r=a.reference[d]+a.reference[e]+(t?0:((v=o.offset)==null?void 0:v[d])||0)-(t?g.crossAxis:0);m<n?m=n:m>r&&(m=r)}return{[f]:p,[d]:m}}}};function Vt(){return typeof window<`u`}function Ht(e){return Gt(e)?(e.nodeName||``).toLowerCase():`#document`}function Ut(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Wt(e){var t;return(t=(Gt(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Gt(e){return Vt()?e instanceof Node||e instanceof Ut(e).Node:!1}function Kt(e){return Vt()?e instanceof Element||e instanceof Ut(e).Element:!1}function qt(e){return Vt()?e instanceof HTMLElement||e instanceof Ut(e).HTMLElement:!1}function Jt(e){return!Vt()||typeof ShadowRoot>`u`?!1:e instanceof ShadowRoot||e instanceof Ut(e).ShadowRoot}let Yt=new Set([`inline`,`contents`]);function Xt(e){let{overflow:t,overflowX:n,overflowY:r,display:i}=un(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!Yt.has(i)}let Zt=new Set([`table`,`td`,`th`]);function Qt(e){return Zt.has(Ht(e))}let $t=[`:popover-open`,`:modal`];function en(e){return $t.some(t=>{try{return e.matches(t)}catch(e){return!1}})}let tn=[`transform`,`translate`,`scale`,`rotate`,`perspective`],nn=[`transform`,`translate`,`scale`,`rotate`,`perspective`,`filter`],rn=[`paint`,`layout`,`strict`,`content`];function an(e){let t=sn(),n=Kt(e)?un(e):e;return tn.some(e=>n[e]?n[e]!==`none`:!1)||(n.containerType?n.containerType!==`normal`:!1)||!t&&(n.backdropFilter?n.backdropFilter!==`none`:!1)||!t&&(n.filter?n.filter!==`none`:!1)||nn.some(e=>(n.willChange||``).includes(e))||rn.some(e=>(n.contain||``).includes(e))}function on(e){let t=fn(e);for(;qt(t)&&!ln(t);){if(an(t))return t;if(en(t))return null;t=fn(t)}return null}function sn(){return typeof CSS>`u`||!CSS.supports?!1:CSS.supports(`-webkit-backdrop-filter`,`none`)}let cn=new Set([`html`,`body`,`#document`]);function ln(e){return cn.has(Ht(e))}function un(e){return Ut(e).getComputedStyle(e)}function dn(e){return Kt(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function fn(e){if(Ht(e)===`html`)return e;let t=e.assignedSlot||e.parentNode||Jt(e)&&e.host||Wt(e);return Jt(t)?t.host:t}function pn(e){let t=fn(e);return ln(t)?e.ownerDocument?e.ownerDocument.body:e.body:qt(t)&&Xt(t)?t:pn(t)}function mn(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);let i=pn(e),a=i===((r=e.ownerDocument)==null?void 0:r.body),o=Ut(i);if(a){let e=hn(o);return t.concat(o,o.visualViewport||[],Xt(i)?i:[],e&&n?mn(e):[])}return t.concat(i,mn(i,[],n))}function hn(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function gn(e){let t=un(e),n=parseFloat(t.width)||0,r=parseFloat(t.height)||0,i=qt(e),a=i?e.offsetWidth:n,o=i?e.offsetHeight:r,s=Ze(n)!==a||Ze(r)!==o;return s&&(n=a,r=o),{width:n,height:r,$:s}}function _n(e){return Kt(e)?e:e.contextElement}function vn(e){let t=_n(e);if(!qt(t))return $e(1);let n=t.getBoundingClientRect(),{width:r,height:i,$:a}=gn(t),o=(a?Ze(n.width):n.width)/r,s=(a?Ze(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!s||!Number.isFinite(s))&&(s=1),{x:o,y:s}}let yn=$e(0);function bn(e){let t=Ut(e);return!sn()||!t.visualViewport?yn:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function xn(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Ut(e)?!1:t}function Sn(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);let i=e.getBoundingClientRect(),a=_n(e),o=$e(1);t&&(r?Kt(r)&&(o=vn(r)):o=vn(e));let s=xn(a,n,r)?bn(a):$e(0),c=(i.left+s.x)/o.x,l=(i.top+s.y)/o.y,u=i.width/o.x,d=i.height/o.y;if(a){let e=Ut(a),t=r&&Kt(r)?Ut(r):r,n=e,i=hn(n);for(;i&&r&&t!==n;){let e=vn(i),t=i.getBoundingClientRect(),r=un(i),a=t.left+(i.clientLeft+parseFloat(r.paddingLeft))*e.x,o=t.top+(i.clientTop+parseFloat(r.paddingTop))*e.y;c*=e.x,l*=e.y,u*=e.x,d*=e.y,c+=a,l+=o,n=Ut(i),i=hn(n)}}return Ct({width:u,height:d,x:c,y:l})}function Cn(e,t){let n=dn(e).scrollLeft;return t?t.left+n:Sn(Wt(e)).left+n}function wn(e,t){let n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-Cn(e,n),y:n.top+t.scrollTop}}function Tn(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e,a=i===`fixed`,o=Wt(r),s=t?en(t.floating):!1;if(r===o||s&&a)return n;let c={scrollLeft:0,scrollTop:0},l=$e(1),u=$e(0),d=qt(r);if((d||!d&&!a)&&((Ht(r)!==`body`||Xt(o))&&(c=dn(r)),qt(r))){let e=Sn(r);l=vn(r),u.x=e.x+r.clientLeft,u.y=e.y+r.clientTop}let f=o&&!d&&!a?wn(o,c):$e(0);return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x+f.x,y:n.y*l.y-c.scrollTop*l.y+u.y+f.y}}function En(e){return Array.from(e.getClientRects())}function Dn(e){let t=Wt(e),n=dn(e),r=e.ownerDocument.body,i=Xe(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),a=Xe(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight),o=-n.scrollLeft+Cn(e),s=-n.scrollTop;return un(r).direction===`rtl`&&(o+=Xe(t.clientWidth,r.clientWidth)-i),{width:i,height:a,x:o,y:s}}function On(e,t){let n=Ut(e),r=Wt(e),i=n.visualViewport,a=r.clientWidth,o=r.clientHeight,s=0,c=0;if(i){a=i.width,o=i.height;let e=sn();(!e||e&&t===`fixed`)&&(s=i.offsetLeft,c=i.offsetTop)}let l=Cn(r);if(l<=0){let e=r.ownerDocument,t=e.body,n=getComputedStyle(t),i=e.compatMode===`CSS1Compat`&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,o=Math.abs(r.clientWidth-t.clientWidth-i);o<=25&&(a-=o)}else l<=25&&(a+=l);return{width:a,height:o,x:s,y:c}}let kn=new Set([`absolute`,`fixed`]);function An(e,t){let n=Sn(e,!0,t===`fixed`),r=n.top+e.clientTop,i=n.left+e.clientLeft,a=qt(e)?vn(e):$e(1);return{width:e.clientWidth*a.x,height:e.clientHeight*a.y,x:i*a.x,y:r*a.y}}function jn(e,t,n){let r;if(t===`viewport`)r=On(e,n);else if(t===`document`)r=Dn(Wt(e));else if(Kt(t))r=An(t,n);else{let n=bn(e);r={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return Ct(r)}function Mn(e,t){let n=fn(e);return n===t||!Kt(n)||ln(n)?!1:un(n).position===`fixed`||Mn(n,t)}function Nn(e,t){let n=t.get(e);if(n)return n;let r=mn(e,[],!1).filter(e=>Kt(e)&&Ht(e)!==`body`),i=null,a=un(e).position===`fixed`,o=a?fn(e):e;for(;Kt(o)&&!ln(o);){let t=un(o),n=an(o);!n&&t.position===`fixed`&&(i=null),(a?!n&&!i:!n&&t.position===`static`&&i&&kn.has(i.position)||Xt(o)&&!n&&Mn(e,o))?r=r.filter(e=>e!==o):i=t,o=fn(o)}return t.set(e,r),r}function Pn(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e,a=[...n===`clippingAncestors`?en(t)?[]:Nn(t,this._c):[].concat(n),r],o=a[0],s=a.reduce((e,n)=>{let r=jn(t,n,i);return e.top=Xe(r.top,e.top),e.right=Ye(r.right,e.right),e.bottom=Ye(r.bottom,e.bottom),e.left=Xe(r.left,e.left),e},jn(t,o,i));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function Fn(e){let{width:t,height:n}=gn(e);return{width:t,height:n}}function In(e,t,n){let r=qt(t),i=Wt(t),a=n===`fixed`,o=Sn(e,!0,a,t),s={scrollLeft:0,scrollTop:0},c=$e(0);function l(){c.x=Cn(i)}if(r||!r&&!a)if((Ht(t)!==`body`||Xt(i))&&(s=dn(t)),r){let e=Sn(t,!0,a,t);c.x=e.x+t.clientLeft,c.y=e.y+t.clientTop}else i&&l();a&&!r&&i&&l();let u=i&&!r&&!a?wn(i,s):$e(0);return{x:o.left+s.scrollLeft-c.x-u.x,y:o.top+s.scrollTop-c.y-u.y,width:o.width,height:o.height}}function Ln(e){return un(e).position===`static`}function Rn(e,t){if(!qt(e)||un(e).position===`fixed`)return null;if(t)return t(e);let n=e.offsetParent;return Wt(e)===n&&(n=n.ownerDocument.body),n}function zn(e,t){let n=Ut(e);if(en(e))return n;if(!qt(e)){let t=fn(e);for(;t&&!ln(t);){if(Kt(t)&&!Ln(t))return t;t=fn(t)}return n}let r=Rn(e,t);for(;r&&Qt(r)&&Ln(r);)r=Rn(r,t);return r&&ln(r)&&Ln(r)&&!an(r)?n:r||on(e)||n}let Bn=function(){var e=Tt(function*(e){let t=this.getOffsetParent||zn,n=this.getDimensions,r=yield n(e.floating);return{reference:In(e.reference,yield t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}});return function(t){return e.apply(this,arguments)}}();function Vn(e){return un(e).direction===`rtl`}let Hn={convertOffsetParentRelativeRectToViewportRelativeRect:Tn,getDocumentElement:Wt,getClippingRect:Pn,getOffsetParent:zn,getElementRects:Bn,getClientRects:En,getDimensions:Fn,getScale:vn,isElement:Kt,isRTL:Vn};function Un(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Wn(e,t){let n=null,r,i=Wt(e);function a(){var e;clearTimeout(r),(e=n)==null||e.disconnect(),n=null}function o(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),a();let l=e.getBoundingClientRect(),{left:u,top:d,width:f,height:p}=l;if(s||t(),!f||!p)return;let m=Qe(d),h=Qe(i.clientWidth-(u+f)),g=Qe(i.clientHeight-(d+p)),_=Qe(u),v={rootMargin:-m+`px `+-h+`px `+-g+`px `+-_+`px`,threshold:Xe(0,Ye(1,c))||1},y=!0;function b(t){let n=t[0].intersectionRatio;if(n!==c){if(!y)return o();n?o(!1,n):r=setTimeout(()=>{o(!1,1e-7)},1e3)}n===1&&!Un(l,e.getBoundingClientRect())&&o(),y=!1}try{n=new IntersectionObserver(b,W(W({},v),{},{root:i.ownerDocument}))}catch(e){n=new IntersectionObserver(b,v)}n.observe(e)}return o(!0),a}function Gn(e,t,n,r){r===void 0&&(r={});let{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver==`function`,layoutShift:s=typeof IntersectionObserver==`function`,animationFrame:c=!1}=r,l=_n(e),u=i||a?[...l?mn(l):[],...mn(t)]:[];u.forEach(e=>{i&&e.addEventListener(`scroll`,n,{passive:!0}),a&&e.addEventListener(`resize`,n)});let d=l&&s?Wn(l,n):null,f=-1,p=null;o&&(p=new ResizeObserver(e=>{let[r]=e;r&&r.target===l&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var e;(e=p)==null||e.observe(t)})),n()}),l&&!c&&p.observe(l),p.observe(t));let m,h=c?Sn(e):null;c&&g();function g(){let t=Sn(e);h&&!Un(h,t)&&n(),h=t,m=requestAnimationFrame(g)}return n(),()=>{var e;u.forEach(e=>{i&&e.removeEventListener(`scroll`,n),a&&e.removeEventListener(`resize`,n)}),d?.(),(e=p)==null||e.disconnect(),p=null,c&&cancelAnimationFrame(m)}}let Kn=Rt,qn=zt,Jn=Pt,Yn=Bt,Xn=(e,t,n)=>{let r=new Map,i=W({platform:Hn},n),a=W(W({},i.platform),{},{_c:r});return jt(e,t,W(W({},i),{},{platform:a}))};function Zn(e,t,n,r,i){return i&&clearTimeout(i),e.addEventListener(`transitionend`,n,r),setTimeout(function(){n()},t)}var Qn=4,$n;function er(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.msg,r=n===void 0?``:n,i=t.delay,a=i===void 0?150:i,o=t.content,s=t.direction,c=s===void 0?`bottom`:s,l=t.type,u=l===void 0?`hover`:l,d=t.container,f=t.onOpen,p=t.onClose,m=t.closed,h=t.onDestroy,g=H(`tooltip`);if(r||o){$n||($n=document.createElement(`div`));var _=d||$n,v=document.createElement(`div`);v.classList.add(g.b(),`hidden`,`transparent`),o?v.appendChild(o):r&&(v.textContent=r);var y,b,x,S=function(){x&&x(),Xn(e,v,{placement:c,middleware:[Jn(),qn({limiter:Yn()}),Kn(Qn)]}).then(function(e){var t=e.x,n=e.y;Object.assign(v.style,{left:`${t}px`,top:`${n}px`})})},C=function(){v.classList.add(`hidden`),_.contains(v)&&(_.removeChild(v),_===$n&&!$n.hasChildNodes()&&document.body.removeChild($n)),x&&x(),m&&m()},w=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;b&&clearTimeout(b),y=setTimeout(function(){if(f){var n=f(t);if(!t&&n)return}_===$n&&!$n.parentElement&&document.body.appendChild($n),_.appendChild(v),v.removeEventListener(`transitionend`,C),v.classList.remove(`hidden`),x=Gn(e,v,S),v.classList.remove(`transparent`)},a)},T=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;y&&clearTimeout(y),b=setTimeout(function(){if(p){var t=p(e);if(!e&&t)return}Zn(v,150,C,{once:!0}),v.classList.add(`transparent`)},a)},E={hover:function(){var t=[e,v],n=T.bind(void 0,!1),r=w.bind(void 0,!1);return{prepare:function(){for(var e=0,i=t;e<i.length;e++){var a=i[e];a.addEventListener(`mouseenter`,r),a.addEventListener(`mouseleave`,n)}},show:w,hide:T,destroy:function(){for(var e=0,i=t;e<i.length;e++){var a=i[e];a.removeEventListener(`mouseenter`,r),a.removeEventListener(`mouseleave`,n)}}}},click:function(){var t=function(e){e.stopPropagation(),T(!1)},n=function(e){e.stopPropagation(),w(),document.removeEventListener(`click`,t),document.addEventListener(`click`,t,{once:!0})};return{prepare:function(){v.addEventListener(`click`,function(e){return e.stopPropagation()}),e.addEventListener(`click`,n)},show:w,hide:function(){T(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1),document.removeEventListener(`click`,t)},destroy:function(){e.removeEventListener(`click`,n),document.removeEventListener(`click`,t)}}}}[u](),D=E.prepare,O=E.show,k=E.hide,A=E.destroy;return D(),{show:O,hide:k,destroy:function(){k(!0),h&&h(),A(),x&&x(),v.remove()}}}return null}function tr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.axis,r=n===void 0?`both`:n,i=t.onMove,a=i===void 0?function(){}:i,o=t.onStart,s=o===void 0?function(){}:o,c=t.onEnd,l=c===void 0?function(){}:c,u=t.buttons,d=u===void 0?[0]:u,f=t.container,p=t.draggingElement,m=p===void 0?document:p,h=t.exact,g=h===void 0?!0:h,_={x:0,y:0},v;function y(t){if(v){var n=e.getBoundingClientRect(),i=_,a=i.x,o=i.y;(r===`x`||r===`both`)&&(a=t.clientX-v.x,f&&(a=Math.min(Math.max(0,a),f.scrollWidth-n.width))),(r===`y`||r===`both`)&&(o=t.clientY-v.y,f&&(o=Math.min(Math.max(0,o),f.scrollHeight-n.height))),_={x:a,y:o}}}function b(t){var n;if(d.includes(t.button)&&!(g&&t.target!==e)){m.addEventListener(`pointerup`,S),m.addEventListener(`pointermove`,x);var r=f==null||(n=f.getBoundingClientRect)==null?void 0:n.call(f),i=e.getBoundingClientRect(),a={x:t.clientX-(f?i.left-r.left+f.scrollLeft:i.left),y:t.clientY-(f?i.top-r.top+f.scrollTop:i.top)};s({position:_,startPosition:a},t)!==!1&&(v=a,_=a)}}function x(e){v&&(y(e),a({position:_,startPosition:v},e))}function S(e){m.removeEventListener(`pointermove`,x),m.removeEventListener(`pointerup`,S),y(e),l({position:_,startPosition:v},e),v=void 0,_={x:0,y:0}}return m.addEventListener(`pointerdown`,b),{stop:function(){m.removeEventListener(`pointerdown`,b)}}}function nr(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=e.x,a=e.y,o=e.x1,s=e.y1,c=t.x,l=t.y,u=t.x1,d=t.y1,f,p;return r?(f=o<c+n||i-n>u,p=s<l+n||a-n>d):(f=o<=c+n||i-n>=u,p=s<=l+n||a-n>=d),!(f||p)}function rr(e,t){var n=t.getBoundingClientRect();return{x:e.x-n.x-t.scrollLeft,y:e.y-n.y-t.scrollTop,x1:e.x-n.x-t.scrollLeft+e.width,y1:e.y-n.y-t.scrollTop+e.height,width:e.width,height:e.height}}var ir=8;function ar(e){var t=e.left,n=e.top,r=e.width,i=e.height,a=document.documentElement,o=a.clientWidth,s=a.clientHeight,c=!1,l=!1;return t+r>o?(t=o-r-ir,c=!0):t<0&&(t=ir,c=!0),n+i>s?(n=s-i-ir,l=!0):n<0&&(n=ir,l=!0),{left:t,top:n,leftLimited:c,topLimited:l}}function or(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=Symbol(`ignoreFirstBind`),r=new Set,i=new ResizeObserver(function(r){t.ignoreFirstBind&&r.some(function(e){var t=e.target,r=t[n];return t[n]=!0,!r})||e(r)}),a=i.observe;i.observe=function(e,t){r.add(e),a.call(i,e,t)};var o=i.unobserve;i.unobserve=function(e){r.has(e)&&(r.delete(e),e[n]=void 0),o.call(i,e)};var s=i.disconnect;return i.disconnect=function(){var e=b(r.values()),t;try{for(e.s();!(t=e.n()).done;){var a=t.value;a[n]=void 0}}catch(t){e.e(t)}finally{e.f()}s.call(i)},i}function sr(e,t){e.addEventListener(`scroll`,t),this.scrollHandler.push([e,t])}function cr(e,t){for(var n=0;n<this.scrollHandler.length;n++){var r=F(this.scrollHandler[n],2),i=r[0],a=r[1];if(i===e&&a===t){this.scrollHandler.splice(n,1);break}}}function lr(){for(var e=0;e<this.scrollHandler.length;e++){var t=F(this.scrollHandler[e],2),n=t[0],r=t[1];n.removeEventListener(`scroll`,r)}this.scrollHandler=[]}function ur(e){return{y:e.scrollTop,x:e.scrollLeft}}function dr(){var e,t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).target,n=t===void 0?document.body:t,r=document.createElement(`div`);Object.assign(r.style,{visibility:`hidden`,width:`100px`,height:`100%`,overflow:`auto`,position:`absolute`,top:`-9999px`}),n.appendChild(r);var i=r.offsetWidth;r.style.overflow=`scroll`;var a=document.createElement(`div`);a.style.width=`100%`,r.appendChild(a);var o=a.offsetWidth;return(e=r.parentNode)==null||e.removeChild(r),i-o}var fr=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:20,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:20;_(this,e),x(this,`scrollThresholdX`,void 0),x(this,`scrollThresholdY`,void 0),x(this,`maxScrollSpeed`,void 0),x(this,`mouseY`,0),x(this,`mouseX`,0),x(this,`animationId`,null),this.scrollThresholdX=t,this.scrollThresholdY=n,this.maxScrollSpeed=r}return y(e,[{key:`checkMinY`,value:function(e){return this.mouseY<e.top+this.scrollThresholdY}},{key:`checkMaxY`,value:function(e){return this.mouseY>e.bottom-this.scrollThresholdY}},{key:`checkMinX`,value:function(e){return this.mouseX<e.left+this.scrollThresholdX}},{key:`checkMaxX`,value:function(e){return this.mouseX>e.right-this.scrollThresholdX}},{key:`start`,value:function(e,t){var n=this,r=e.getBoundingClientRect(),i=function(){var a=!1,o=0,s=0;if(n.checkMinY(r)){var c=r.top+n.scrollThresholdY-n.mouseY,l=Math.min(c/n.scrollThresholdY*n.maxScrollSpeed,n.maxScrollSpeed);e.scrollTop-=l,s=-1*l,a=!0}else if(n.checkMaxY(r)){var u=n.mouseY-(r.bottom-n.scrollThresholdY),d=Math.min(u/n.scrollThresholdY*n.maxScrollSpeed,n.maxScrollSpeed);e.scrollTop+=d,s=d,a=!0}if(n.checkMinX(r)){var f=r.left+n.scrollThresholdX-n.mouseX,p=Math.min(f/n.scrollThresholdX*n.maxScrollSpeed,n.maxScrollSpeed);e.scrollLeft-=p,o=-1*p,a=!0}else if(n.checkMaxX(r)){var m=n.mouseX-(r.right-n.scrollThresholdX),h=Math.min(m/n.scrollThresholdX*n.maxScrollSpeed,n.maxScrollSpeed);e.scrollLeft+=h,o=h,a=!0}a&&t&&t(o,s),n.animationId=requestAnimationFrame(i)};this.animationId=requestAnimationFrame(i)}},{key:`updateMousePosition`,value:function(e,t){this.mouseX=e,this.mouseY=t}},{key:`stop`,value:function(){this.animationId!==null&&(cancelAnimationFrame(this.animationId),this.animationId=null)}}])}();function pr(e){return e.replaceAll(/([A-Z])/g,` $1`).trim().split(` `).join(`-`).toLowerCase()}function mr(e){return e.replaceAll(/-(\w)/g,function(e,t){return t.toUpperCase()})}function hr(e){var t={};if(!e.style.cssText)return t;var n=b(e.style.cssText.split(`;`).filter(function(e){return e.trim()})),r;try{for(n.s();!(r=n.n()).done;){var i=r.value,a=i.indexOf(`:`);if(a!==-1){var o=i.slice(0,a).trim();t[o]=i.slice(a+1).trim()}}}catch(e){n.e(e)}finally{n.f()}return t}function gr(e){for(var t={},n=e.trim().split(`;`),r=0;r<n.length;r++){var i=n[r].trim();if(i){var a=i.indexOf(`:`);if(a!==-1){var o=i.slice(0,Math.max(0,a)).trim(),s=i.slice(Math.max(0,a+1)).trim();t[mr(o)]=s}}}return t}function _r(e){return Object.entries(e).map(function(e){var t=F(e,2),n=t[0],r=t[1];return`${pr(n)}: ${r};`}).join(` `)}var G=function(){return Math.random().toString(36).slice(2)};function vr(e,t){var n;return function(){for(var r=this,i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];n&&clearTimeout(n),n=setTimeout(function(){e.apply(r,a)},t)}}var yr=t.default.import(`parchment`),br=t.default.import(`blots/container`),xr=t.default.import(`blots/block`),Sr=t.default.import(`blots/block/embed`),K=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t,[{key:`setFormatValue`,value:function(e,t){if(this.statics.allowAttrs.has(e)||this.statics.allowDataAttrs.has(e)){var n=e;this.statics.allowDataAttrs.has(e)&&(n=`data-${e}`),t?this.domNode.setAttribute(n,t):this.domNode.removeAttribute(n);var r=this.statics.allowDataAttrsChangeHandler[e];r&&Ee(this[r])&&this[r](t)}}},{key:`optimize`,value:function(e){if(this.children.length===0)if(this.statics.defaultChild!=null){var t=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(t)}else this.remove();this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}},{key:`enforceAllowedChildren`,value:function(){var e=this;this.children.forEach(function(n){e.statics.allowedChildren.some(function(e){return n instanceof e})||(n.statics.scope===yr.Scope.BLOCK_BLOT?(n.parent instanceof t?(n.next!=null&&n.parent.splitAfter(n),n.prev!=null&&n.parent.splitAfter(n.prev)):(n.next!=null&&e.splitAfter(n),n.prev!=null&&e.splitAfter(n.prev)),n.parent.unwrap()):n instanceof yr.ParentBlot?n.unwrap():n.remove())})}}],[{key:`create`,value:function(e){var t=document.createElement(this.tagName);return this.className&&t.classList.add(this.className),t}}])}(br);x(K,`tagName`,void 0),x(K,`blotName`,R.container),x(K,`scope`,yr.Scope.BLOCK_BLOT),x(K,`allowedChildren`,[xr,Sr,br]),x(K,`requiredContainer`,void 0),x(K,`defaultChild`,void 0),x(K,`allowAttrs`,new Set([])),x(K,`allowDataAttrs`,new Set([])),x(K,`allowDataAttrsChangeHandler`,{});var Cr=function(e){return Me(e)?e:1};function wr(e,t){return Object.keys(e).every(function(n){return JSON.stringify(e[n])===JSON.stringify(t[n])})}var Tr=t.default.import(`parchment`),Er=t.default.import(`blots/block`),Dr=t.default.import(`blots/block/embed`),Or=t.default.import(`blots/container`),kr=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t,[{key:`replaceWith`,value:function(e,t){var n=Oe(e)?this.scroll.create(e,t):e;if(n instanceof Tr.ParentBlot)if(n.statics.blotName===R.tableCellInner){var r=null;try{if(r=U(this,R.tableCellInner),wr(r.formats(),n.formats()))return r}catch(e){}if(r)r.insertBefore(n,this),n.appendChild(this),r.children.length===0&&r.remove();else{for(var i=this,a=i;i.parent!==this.scroll&&i.parent instanceof Or;)a=i,i=i.parent;i===this.scroll&&(i=a);var o=this.offset(i),s=this.length(),c=i.isolate(o,s);c&&c.parent&&c.parent.insertBefore(n,c.next),n.appendChild(this)}return n}else this.moveChildren(n);return this.parent!==null&&(this.parent.insertBefore(n,this.next),this.remove()),this.attributes.copy(n),n}},{key:`format`,value:function(e,n){if(e===R.tableCellInner&&this.parent.statics.blotName===e&&!n){if(this.prev&&this.prev instanceof Dr)return;try{U(this,R.tableCellInner).unwrap()}catch(e){console.error(`unwrap TableCellInner error`)}}else I(t,`format`,this,3)([e,n])}}])}(Er),Ar=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t,[{key:`delta`,value:function(){var e=I(t,`delta`,this,3)([]),n=jr(this);return n[R.tableCellInner]&&e.insert(`
`,x({},R.tableCellInner,n[R.tableCellInner])),e}},{key:`length`,value:function(){return jr(this)[R.tableCellInner]?I(t,`length`,this,3)([])+1:I(t,`length`,this,3)([])}},{key:`formatAt`,value:function(e,t,n,r){if(n===R.tableCellInner)try{var i=U(this,R.tableCellInner),a=this.scroll.create(R.tableCellInner,r);i.insertBefore(a,this),a.appendChild(this),i.length()===0&&i.remove()}catch(e){}else this.format(n,r)}}])}(t.default.import(`blots/block/embed`));function jr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return e==null||(`formats`in e&&typeof e.formats==`function`&&(t=j(j({},t),e.formats()),n&&delete t[`code-token`]),e.parent==null||e.parent.statics.blotName===`scroll`||e.parent.statics.scope!==e.statics.scope)?t:jr(e.parent,t,n)}var Mr=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t,[{key:`tableId`,get:function(){return this.domNode.dataset.tableId}},{key:`checkMerge`,value:function(){var e=this.next;return e!==null&&e.statics.blotName===this.statics.blotName&&e.tableId===this.tableId}},{key:`optimize`,value:function(e){var n=this.parent;if(n!==null&&n.statics.blotName!==R.tableMain){var r=this.tableId;this.wrap(R.tableMain,{tableId:r})}I(t,`optimize`,this,3)([e])}},{key:`convertBody`,value:function(e){var t=b(this.descendants(q)),n;try{for(t.s();!(n=t.n()).done;){var r=n.value;r.wrapTag=e}}catch(e){t.e(e)}finally{t.f()}}},{key:`getRows`,value:function(){var e=this;return Array.from(this.domNode.querySelectorAll(`tr`)).map(function(t){return e.scroll.find(t)}).filter(Boolean)}}],[{key:`create`,value:function(e){var n=I(t,`create`,this,2)([]);return n.dataset.tableId=e,n}}])}(K);x(Mr,`blotName`,R.tableBody),x(Mr,`tagName`,`tbody`);var Nr=t.default.import(`blots/block`),Pr=t.default.import(`blots/block/embed`),q=function(e){function t(e,n,r){var i;return _(this,t),i=g(this,t,[e,n]),n.setAttribute(`contenteditable`,String(e.isEnabled())),i}return w(t,e),y(t,[{key:`setFormatValue`,value:function(e,n){if(arguments.length>2&&arguments[2]!==void 0&&arguments[2]){if(!this.statics.isAllowStyle(e))return}else I(t,`setFormatValue`,this,3)([e,n]);this.parent&&this.parent.statics.blotName===R.tableCell&&this.parent.setFormatValue(e,n),this.clearCache()}},{key:`clearCache`,value:function(){var e=b(this.descendants(Nr,0)),t;try{for(e.s();!(t=e.n()).done;){var n=t.value;n.cache={}}}catch(t){e.e(t)}finally{e.f()}}},{key:`tableId`,get:function(){return this.domNode.dataset.tableId}},{key:`rowId`,get:function(){return this.domNode.dataset.rowId},set:function(e){this.setFormatValue(`row-id`,e)}},{key:`colId`,get:function(){return this.domNode.dataset.colId},set:function(e){this.setFormatValue(`col-id`,e)}},{key:`rowspan`,get:function(){return Number(this.domNode.dataset.rowspan)},set:function(e){this.setFormatValue(`rowspan`,e)}},{key:`colspan`,get:function(){return Number(this.domNode.dataset.colspan)},set:function(e){this.setFormatValue(`colspan`,e)}},{key:`emptyRow`,get:function(){try{return JSON.parse(this.domNode.dataset.emptyRow)}catch(e){return[]}},set:function(e){if(this.emptyRow.toString()!==e.toString())try{e.length>0?this.setFormatValue(`empty-row`,JSON.stringify(e),!1):this.setFormatValue(`empty-row`,null,!1)}catch(e){this.setFormatValue(`empty-row`,null,!1)}}},{key:`wrapTag`,get:function(){return this.domNode.dataset.wrapTag||`tbody`},set:function(e){this.setFormatValue(`wrap-tag`,e)}},{key:`getColumnIndex`,value:function(){return U(this,R.tableMain).getColIds().indexOf(this.colId)}},{key:`getRowIndex`,value:function(){return U(this,R.tableMain).getRowIds().indexOf(this.rowId)}},{key:`getTableBody`,value:function(){for(var e=this.parent;e&&!(e instanceof Mr)&&e!==this.scroll;)e=e.parent;return e===this.scroll?null:e}},{key:`getTableRow`,value:function(){try{return U(this,R.tableRow)}catch(e){return null}}},{key:`setStyleByString`,value:function(e){for(var t=gr(e),n=0,r=Object.entries(t);n<r.length;n++){var i=F(r[n],2),a=i[0],o=i[1];this.setFormatValue(a,o,!0)}}},{key:`convertTableCell`,value:function(){this.parent.statics.blotName===R.tableCell&&(this.parent.convertTableCell(),this.clearCache())}},{key:`formatAt`,value:function(e,n,r,i){if(this.children.length===0){var a=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(a),n+=a.length()}I(t,`formatAt`,this,3)([e,n,r,i]),i&&i.style&&this.setStyleByString(i.style)}},{key:`insertAt`,value:function(e,n,r){var i=F(this.children.find(e),1)[0];if(!i&&this.statics.defaultChild){var a=this.scroll.create(this.statics.defaultChild.blotName||`block`);this.appendChild(a)}I(t,`insertAt`,this,3)([e,n,r]),(r==null?this.scroll.create(`text`,n):this.scroll.create(n,r))instanceof Pr&&i&&i.length()<=1&&i.remove()}},{key:`formats`,value:function(){var e=this.statics.formats(this.domNode);return x({},this.statics.blotName,e)}},{key:`checkMerge`,value:function(){var e=this.colId,t=this.rowId,n=this.colspan,r=this.rowspan,i=this.next;return i!==null&&i.statics.blotName===this.statics.blotName&&i.rowId===t&&i.colId===e&&i.colspan===n&&i.rowspan===r}},{key:`optimize`,value:function(){var e=this.parent,t=this.statics.formats(this.domNode);if(this.prev&&this.prev instanceof Pr){var n=this.prev;if(this.insertBefore(n,this.children.head),this.length()<=1){var r=this.scroll.create(`block`);this.insertBefore(r,n.next)}}var i=e!==null&&e.statics.blotName!==R.tableCell;if(i&&(this.wrap(R.tableCell,t),this.children.length===0)){var a=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(a)}this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove()),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0?this.remove():this.domNode.dataset.style&&i&&e.domNode.style.cssText!==this.domNode.dataset.style&&this.setStyleByString(this.domNode.dataset.style)}},{key:`insertBefore`,value:function(e,n){if(e.statics.blotName===this.statics.blotName){var r=e,i=this.statics.formats(r.domNode),a=this.statics.formats(this.domNode);if(wr(a,i)){var o=this.split(n?n.offset():0);return this.parent.insertBefore(r,o)}else{var s=F(pe(this,[R.tableRow,R.tableCell]),2),c=s[0],l=s[1],u=l;if(n){var d=n.offset(),f=this.length();if(d!==0&&d<f){var p=this.split(d).wrap(R.tableCell,a);c.insertBefore(p,l.next),u=p}}if(this.tableId!==r.tableId){var m=U(this,R.tableWrapper),h=this.offset(m),g=m.split(h);return m.parent.insertBefore(r,g)}if(this.rowId!==r.rowId){var _=c,v=n;if(v){var y=v.offset(c);_=c.split(y)}var b=this.scroll.create(R.tableRow,i),x=this.scroll.create(R.tableCell,i);return x.appendChild(r),b.appendChild(x),c.parent.insertBefore(b,_)}return c.insertBefore(r.wrap(R.tableCell,i),u)}}else if(e.statics.blotName===R.tableCol){try{var S=U(this,R.tableBody),C=this.offset(S),w=S.split(C);S.parent.insertBefore(e,w),e.optimize({})}catch(e){console.warn(`TableCellInner not in TableBody`)}return}I(t,`insertBefore`,this,3)([e,n])}}],[{key:`isAllowStyle`,value:function(e){var t=mr(e),n=b(this.allowStyle),r;try{for(n.s();!(r=n.n()).done;){var i=r.value;if(t.startsWith(mr(i)))return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:`create`,value:function(e){var n=e.tableId,r=e.rowId,i=e.colId,a=e.rowspan,o=e.colspan,s=e.style,c=e.emptyRow,l=e.tag,u=l===void 0?`td`:l,d=e.wrapTag,f=d===void 0?`tbody`:d,p=I(t,`create`,this,2)([]);p.dataset.tableId=n,p.dataset.rowId=r,p.dataset.colId=i,p.dataset.rowspan=String(Cr(a)),p.dataset.colspan=String(Cr(o)),p.dataset.tag=u,p.dataset.wrapTag=f,s&&(p.dataset.style=s);try{c&&(p.dataset.emptyRow=JSON.stringify(c))}catch(e){}return p}},{key:`formats`,value:function(e){var t=e.dataset,n=t.tableId,r=t.rowId,i=t.colId,a=t.rowspan,o=t.colspan,s=t.style,c=t.emptyRow,l=t.tag,u=l===void 0?`td`:l,d=t.wrapTag,f=d===void 0?`tbody`:d,p={tableId:String(n),rowId:String(r),colId:String(i),rowspan:Number(Cr(a)),colspan:Number(Cr(o)),tag:u,wrapTag:f};s&&(p.style=s);try{c&&(p.emptyRow=JSON.parse(c))}catch(e){}return p}}])}(K);x(q,`blotName`,R.tableCellInner),x(q,`tagName`,`div`),x(q,`className`,`ql-table-cell-inner`),x(q,`allowDataAttrs`,new Set([`table-id`,`row-id`,`col-id`,`rowspan`,`colspan`,`empty-row`,`wrap-tag`])),x(q,`defaultChild`,Nr),x(q,`allowStyle`,new Set([`background-color`,`border`,`height`]));var Fr=t.default.import(`parchment`),Ir=function(e){function n(){return _(this,n),g(this,n,arguments)}return w(n,e),y(n,[{key:`enable`,value:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=t.default.import(`formats/${R.tableCellInner}`),i=this.domNode.querySelectorAll(`.${r.className}`),a=0,o=Array.from(i);a<o.length;a++)o[a].setAttribute(`contenteditable`,String(!!e));for(var s=t.default.import(`formats/${R.tableCaption}`),c=this.domNode.querySelectorAll(`.${s.className}`),l=0,u=Array.from(c);l<u.length;l++)u[l].setAttribute(`contenteditable`,String(!!e));I(n,`enable`,this,3)([e])}},{key:`createBlock`,value:function(e,t){var n,r={};if(e[R.tableCellInner])n=R.tableCellInner;else for(var i=0,a=Object.entries(e);i<a.length;i++){var o=F(a[i],2),s=o[0],c=o[1];this.query(s,Fr.Scope.BLOCK&Fr.Scope.BLOT)==null?r[s]=c:n=s}n===R.tableCellInner&&(r=j({},e),delete r[n]);var l=this.create(n||this.statics.defaultChild.blotName,n?e[n]:void 0);this.insertBefore(l,t||void 0);var u=l.length();l instanceof q&&u===0&&(u+=1);for(var d=0,f=Object.entries(r);d<f.length;d++){var p=F(f[d],2),m=p[0],h=p[1];l.formatAt(0,u,m,h)}return l}}])}(t.default.import(`blots/scroll`)),Lr=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">\r
  <!-- Icon from Tabler Icons by Paweł Kuna - https://github.com/tabler/tabler-icons/blob/master/LICENSE -->\r
  <path\r
    fill="none"\r
    stroke="currentColor"\r
    stroke-linecap="round"\r
    stroke-linejoin="round"\r
    stroke-width="2"\r
    d="M7 3v18m3-15L7 3L4 6m16 12l-3 3l-3-3m3 3V3"\r
  />\r
</svg>\r
`,Rr=t.default.import(`parchment`),zr=t.default.import(`blots/inline`),Br=t.default.import(`blots/text`),Vr=function(e){function t(e,n,r){var i;return _(this,t),i=g(this,t,[e,n]),n.setAttribute(`contenteditable`,String(e.isEnabled())),i.attachUI(i.createUI()),i.domNode.addEventListener(`mouseenter`,function(){i.scroll.isEnabled()&&(i.uiNode.style.display=`flex`)}),i.domNode.addEventListener(`mouseleave`,function(){i.scroll.isEnabled()&&(i.uiNode.style.display=`none`)}),i.uiNode.style.display=`none`,i}return w(t,e),y(t,[{key:`createUI`,value:function(){var e=this,t=document.createElement(`i`);return t.classList.add(`ql-table-caption--switch`),t.innerHTML=Lr,t.addEventListener(`click`,function(){e.scroll.isEnabled()&&(e.side=e.side===`top`?`bottom`:`top`)}),t}},{key:`tableId`,get:function(){return this.domNode.dataset.tableId}},{key:`side`,get:function(){return this.domNode.style.captionSide===`bottom`?`bottom`:`top`},set:function(e){this.domNode.style.captionSide=e===`bottom`?`bottom`:`top`}},{key:`format`,value:function(e,n){(!this.scroll.query(e,Rr.Scope.BLOCK_BLOT)||e===this.statics.blotName)&&I(t,`format`,this,3)([e,n])}},{key:`checkMerge`,value:function(){var e=this.next;return e!==null&&e.statics.blotName===this.statics.blotName&&e.tableId===this.tableId}},{key:`optimize`,value:function(e){var n=this.parent;if(n!==null&&n.statics.blotName!==R.tableMain){var r=this.tableId;this.wrap(R.tableMain,{tableId:r})}this.children.length===0?this.remove():(I(t,`optimize`,this,3)([e]),this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove()))}}],[{key:`create`,value:function(e){var n=e.tableId,r=I(t,`create`,this,2)([]);return r.dataset.tableId=n,e.side===`bottom`&&(r.style.captionSide=`bottom`),r}},{key:`formats`,value:function(e){var t=e.dataset.tableId;return{tableId:String(t),side:e.style.captionSide===`bottom`?`bottom`:`top`}}}])}(kr);x(Vr,`blotName`,R.tableCaption),x(Vr,`tagName`,`caption`),x(Vr,`className`,`ql-table-caption`),x(Vr,`allowedChildren`,[zr,Br]);var J=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t,[{key:`rowId`,get:function(){return this.domNode.dataset.rowId}},{key:`tableId`,get:function(){return this.domNode.dataset.tableId}},{key:`wrapTag`,get:function(){return this.domNode.dataset.wrapTag||`tbody`}},{key:`setHeight`,value:function(e){this.foreachCellInner(function(t){t.setFormatValue(`height`,e,!0)})}},{key:`getCellByColId`,value:function(e,t){for(var n=U(this,R.tableMain).getColIds(),r=n.indexOf(e),i=this.children.iterator(),a=null;a=i();){if(a.colId===e)return a;var o=n.indexOf(a.colId);if(o<r&&o+a.colspan>r)return a}return this[t]&&this[t].statics.blotName===R.tableRow?this[t].getCellByColId(e,t):null}},{key:`insertCell`,value:function(e,t){for(var n=[],r=this.children.iterator(),i=0,a;(a=r())&&(i+=a.colspan,!(i>e));)if(a.rowspan!==1)for(var o=0;o<a.rowspan-1;o++)n[o]=(n[o]||0)+a.colspan;if(a&&i-a.colspan<e){var s=a.getCellInner();s.colspan+=1,a.rowspan!==1&&(n.skipRowNum=a.rowspan-1)}else{var c=this.scroll.create(R.tableCell,t),l=this.scroll.create(R.tableCellInner,t),u=this.scroll.create(`block`);u.appendChild(this.scroll.create(`break`)),l.appendChild(u),c.appendChild(l),this.insertBefore(c,a)}return n}},{key:`getCellByColumIndex`,value:function(e){var t=[],n=null,r=0;if(e<0)return[n,r,t];for(var i=this.children.iterator();n=i();){if(r+=n.colspan,n.rowspan!==1)for(var a=0;a<n.rowspan-1;a++)t[a]=(t[a]||0)+n.colspan;if(r>e)break}return[n,r,t]}},{key:`removeCell`,value:function(e){if(e<0)return[];var t=this.getCellByColumIndex(e),n=F(t,2),r=n[0],i=n[1],a=t[2];if(!r)return a;if(i-r.colspan<e||r.colspan>1){var o=F(r.descendants(q),1)[0];if(r.colspan!==1&&e===i-r.colspan){var s=U(this,R.tableMain).getColIds();o.colId=s[s.indexOf(o.colId)+1]}r.rowspan!==1&&(a.skipRowNum=r.rowspan-1),--o.colspan}else r.remove();return a}},{key:`foreachCellInner`,value:function(e){for(var t=this.children.iterator(),n=0,r;r=t();){var i=F(r.descendants(q),1)[0];if(i&&e(i,n++))break}}},{key:`checkMerge`,value:function(){var e=this.next;return e!==null&&e.statics.blotName===this.statics.blotName&&e.rowId===this.rowId}},{key:`wrapParentTag`,value:function(){var e={thead:R.tableHead,tbody:R.tableBody,tfoot:R.tableFoot},t=this.parent;if(t!==null&&t.statics.blotName!==e[this.wrapTag])if(Object.values(e).includes(t.statics.blotName)){var n=this.offset(this.parent),r=this.parent.split(n);r&&r.length()<=0&&r.remove();var i=this.parent.splitAfter(this);i&&i.length()<=0&&i.remove(),this.parent.replaceWith(e[this.wrapTag],this.tableId)}else this.wrap(e[this.wrapTag],this.tableId)}},{key:`optimize`,value:function(e){this.wrapParentTag(),this.enforceAllowedChildren(),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}},{key:`remove`,value:function(){I(t,`remove`,this,3)([]),this.next&&this.next instanceof t&&this.next.length()<=0&&this.next.remove()}}],[{key:`create`,value:function(e){var n=e.tableId,r=e.rowId,i=e.wrapTag,a=i===void 0?`tbody`:i,o=I(t,`create`,this,2)([]);return o.dataset.tableId=n,o.dataset.rowId=r,o.dataset.wrapTag=a,o}}])}(K);x(J,`blotName`,R.tableRow),x(J,`tagName`,`tr`),x(J,`className`,`ql-table-row`),x(J,`allowDataAttrs`,new Set([`table-id`,`row-id`,`wrap-tag`])),x(J,`allowDataAttrsChangeHandler`,{"wrap-tag":`wrapParentTag`});var Y=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t,[{key:`isChildHeadTableCellInner`,value:function(){var e=this.children.head;return e&&e.statics.blotName===R.tableCellInner}},{key:`setFormatValue`,value:function(e,t){if(this.statics.allowAttrs.has(e)||this.statics.allowDataAttrs.has(e)){var n=e;this.statics.allowDataAttrs.has(e)&&(n=`data-${e}`),t?this.domNode.setAttribute(n,t):this.domNode.removeAttribute(n)}else this.statics.isAllowStyle(e)&&(Object.assign(this.domNode.style,x({},e,t)),e.startsWith(`border`)&&this.setStyleBoder(e,t));var r=this.children.head;this.isChildHeadTableCellInner()&&this.domNode.style.cssText&&this.domNode.style.cssText!==r.domNode.dataset.style&&(r.domNode.dataset.style=this.domNode.style.cssText),this.parent&&this.parent.statics.blotName===R.tableRow&&this.parent.setFormatValue(e,t)}},{key:`setStyleBoder`,value:function(e,t){var n=t||null;if(![`left`,`right`,`top`,`bottom`].some(function(t){return e.includes(t)})&&e.startsWith(`border-`)){var r=b(this.getNearByCell(`left`).map(function(e){return e.descendant(q,0)[0]}).filter(Boolean)),i;try{for(r.s();!(i=r.n()).done;)i.value.setFormatValue(e.replace(`border-`,`border-right-`),n,!0)}catch(e){r.e(e)}finally{r.f()}var a=b(this.getNearByCell(`top`).map(function(e){return e.descendant(q,0)[0]}).filter(Boolean)),o;try{for(a.s();!(o=a.n()).done;)o.value.setFormatValue(e.replace(`border-`,`border-bottom-`),n,!0)}catch(e){a.e(e)}finally{a.f()}}}},{key:`getNearByCell`,value:function(e){var t=[];try{var n=U(this,R.tableMain);t.push.apply(t,L(n.getColIds()))}catch(e){console.error(`Cell is not in table! ${e}`)}if(t.length===0)return[];if(e===`left`){for(var r=new Set,i=this.parent,a=0;a<this.rowspan&&i instanceof J;a++){for(var o=i.children.iterator(),s=null;s=o();){var c=t.indexOf(s.colId)+s.colspan;this.colId===t[c]&&r.add(s)}i=i.next}return Array.from(r)}else if(e===`top`){if(!(this.parent instanceof J)||!this.parent.prev)return[];for(var l=new Set,u=this.getColumnIndex(),d=u+this.colspan,f=new Set(t.filter(function(e,t){return t>=u&&t<d})),p=1,m=this.parent.prev;m;){for(var h=!1,g=m.children.iterator(),_=null,v=0;_=g();)f.has(_.colId)&&_.rowspan>=p&&(l.add(_),f.delete(_.colId)),v+=_.colspan,_.rowspan>=p&&(h=!0);if(!h&&v===t.length)break;m=m.prev,p+=1}return Array.from(l)}return[]}},{key:`tableId`,get:function(){return this.domNode.dataset.tableId}},{key:`rowId`,get:function(){return this.domNode.dataset.rowId}},{key:`colId`,get:function(){return this.domNode.dataset.colId}},{key:`rowspan`,get:function(){return Number(this.domNode.getAttribute(`rowspan`))}},{key:`colspan`,get:function(){return Number(this.domNode.getAttribute(`colspan`))}},{key:`emptyRow`,get:function(){try{return JSON.parse(this.domNode.dataset.emptyRow)}catch(e){return[]}}},{key:`wrapTag`,get:function(){return this.domNode.dataset.wrapTag||`tbody`}},{key:`getColumnIndex`,value:function(){return U(this,R.tableMain).getColIds().indexOf(this.colId)}},{key:`getCellInner`,value:function(){return this.children.head}},{key:`convertTableCell`,value:function(){var e=this.statics.formats(this.domNode),t=e.tag===`td`?`th`:`td`,n=this.children.head;this.isChildHeadTableCellInner()&&n.domNode.dataset.tag!==t&&(n.domNode.dataset.tag=t),this.replaceWith(R.tableCell,j(j({},e),{},{tag:t}))}},{key:`checkMerge`,value:function(){var e=this.colId,t=this.rowId,n=this.colspan,r=this.rowspan,i=this.next;return i!==null&&i.statics.blotName===this.statics.blotName&&i.rowId===t&&i.colId===e&&i.colspan===n&&i.rowspan===r}},{key:`optimize`,value:function(e){var n=this.tableId,r=this.rowId,i=this.wrapTag;if(this.parent!==null&&this.parent.statics.blotName!==R.tableRow&&this.wrap(R.tableRow,{tableId:n,rowId:r,wrapTag:i}),this.parent.statics.blotName===R.tableRow&&this.parent.wrapTag!==i&&this.parent.setFormatValue(`wrap-tag`,i),this.emptyRow.length>0){var a=this.parent.parent;if(a instanceof Mr){var o=this.parent.next,s=b(this.emptyRow),c;try{for(s.s();!(c=s.n()).done;){var l=c.value,u=this.scroll.create(R.tableRow,{tableId:n,rowId:l,wrapTag:i});a.insertBefore(u,o),o=u.next}}catch(e){s.e(e)}finally{s.f()}}}I(t,`optimize`,this,3)([e])}}],[{key:`isAllowStyle`,value:function(e){var t=mr(e),n=b(this.allowStyle),r;try{for(n.s();!(r=n.n()).done;){var i=r.value;if(t.startsWith(mr(i)))return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:`create`,value:function(e){var t,n=e.tableId,r=e.rowId,i=e.colId,a=e.rowspan,o=e.colspan,s=e.style,c=e.emptyRow,l=e.tag,u=l===void 0?`td`:l,d=e.wrapTag,f=d===void 0?`tbody`:d,p=document.createElement(u);(t=p.classList).add.apply(t,L(Ne(this.className))),p.dataset.tableId=n,p.dataset.rowId=r,p.dataset.colId=i,p.dataset.wrapTag=f,p.setAttribute(`rowspan`,String(Cr(a))),p.setAttribute(`colspan`,String(Cr(o))),s&&(p.style.cssText=s);try{c&&(p.dataset.emptyRow=JSON.stringify(c))}catch(e){}return p}},{key:`formats`,value:function(e){var t=e.dataset,n=t.tableId,r=t.rowId,i=t.colId,a=t.emptyRow,o=t.wrapTag,s=o===void 0?`tbody`:o,c=Number(e.getAttribute(`rowspan`)),l=Number(e.getAttribute(`colspan`)),u={tableId:n,rowId:r,colId:i,rowspan:Cr(c),colspan:Cr(l),tag:e.tagName.toLowerCase(),wrapTag:s},d=hr(e),f=Object.entries(d).filter(function(e){var t=F(e,2)[1];return![`initial`,`inherit`].includes(t)});f.length>0&&(u.style=f.map(function(e){var t=F(e,2);return`${t[0]}: ${t[1]}`}).join(`;`));try{a&&(u.emptyRow=JSON.parse(a))}catch(e){}return u}}])}(K);x(Y,`blotName`,R.tableCell),x(Y,`tagName`,`td`),x(Y,`className`,`ql-table-cell`),x(Y,`allowAttrs`,new Set([`rowspan`,`colspan`])),x(Y,`allowDataAttrs`,new Set([`table-id`,`row-id`,`col-id`,`empty-row`,`wrap-tag`])),x(Y,`allowStyle`,new Set([`background-color`,`border`,`height`]));var Hr=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t,[{key:`width`,get:function(){var e=this.domNode.getAttribute(`width`);if(!e){if(e=this.domNode.getBoundingClientRect().width,this.full){var t=this.domNode.closest(`table`);return t?e/100*t.getBoundingClientRect().width:z[this.full?`colMinWidthPre`:`colMinWidthPx`]}return e}return Number.parseFloat(String(e))},set:function(e){var t=Number.parseFloat(String(e));Number.isNaN(t)&&(t=z[this.full?`colMinWidthPre`:`colMinWidthPx`]),this.domNode.setAttribute(`width`,this.statics.validWidth(t,!!this.full))}},{key:`tableId`,get:function(){return this.domNode.dataset.tableId}},{key:`colId`,get:function(){return this.domNode.dataset.colId}},{key:`full`,get:function(){return Object.hasOwn(this.domNode.dataset,`full`)},set:function(e){e?this.domNode.dataset.full=`true`:this.domNode.removeAttribute(`data-full`)}},{key:`align`,get:function(){return this.domNode.dataset.align||``},set:function(e){e===`right`||e===`center`?this.domNode.dataset.align=e:this.domNode.removeAttribute(`data-align`)}},{key:`checkMerge`,value:function(){var e=this.next,t=this.tableId,n=this.colId;return e!==null&&e.statics.blotName===this.statics.blotName&&e.tableId===t&&e.colId===n}},{key:`optimize`,value:function(e){var n=this.parent;if(n!=null&&n.statics.blotName!==R.tableColgroup){var r=this.statics.value(this.domNode);this.wrap(R.tableColgroup,r)}var i=U(this,R.tableColgroup);i.align=this.align,this.next!=null&&this.checkMerge()&&this.next.remove(),I(t,`optimize`,this,3)([e]);try{var a=U(this,R.tableColgroup),o=!0;a.children.forEach(function(e){o&&(o=e.full)}),a.full=o}catch(e){}}},{key:`insertAt`,value:function(e,n,r){var i=this;if(r!=null){if(n===this.statics.blotName&&r.tableId!==this.tableId)try{var a=U(this,R.tableWrapper),o=a.split(this.offset(a)),s=this.scroll.create(n,r);o.parent.insertBefore(s,o)}catch(e){console.warn(`TableCol not in TableColgroup`)}else I(t,`insertAt`,this,3)([e,n,r]);return}try{var c=U(this,R.tableWrapper),l=c.split(this.offset(c)),u=n.split(`
`),d=u.pop(),f=b(u.map(function(e){var t=i.scroll.create(`block`);return t.insertAt(0,e),t})),p;try{for(f.s();!(p=f.n()).done;){var m=p.value;l.parent.insertBefore(m,l)}}catch(e){f.e(e)}finally{f.f()}d&&l.parent.insertBefore(this.scroll.create(`text`,d),l)}catch(e){console.warn(`TableCol not in TableColgroup`)}}}],[{key:`validWidth`,value:function(e,t){var n=Number.parseFloat(String(e));return Number.isNaN(n)&&(n=z[t?`colMinWidthPre`:`colMinWidthPx`]),`${n}${t?`%`:`px`}`}},{key:`create`,value:function(e){var n=e.width,r=e.tableId,i=e.colId,a=e.full,o=e.align,s=I(t,`create`,this,2)([]);return s.setAttribute(`width`,this.validWidth(n,!!a)),a&&(s.dataset.full=String(a)),o&&o!==`left`&&(s.dataset.align=o),s.dataset.tableId=r,s.dataset.colId=i,s}},{key:`value`,value:function(e){var t=e.dataset,n=t.tableId,r=t.colId,i=e.getAttribute(`width`)||String(z.colDefaultWidth),a=e.dataset.align,o=Object.hasOwn(e.dataset,`full`),s={tableId:String(n),colId:String(r),full:o,width:Number.parseFloat(i)};return a&&(s.align=a),s}}])}(t.default.import(`blots/block/embed`));x(Hr,`blotName`,R.tableCol),x(Hr,`tagName`,`col`);var X=function(e){function t(e,n,r){var i;return _(this,t),i=g(this,t,[e,n]),x(i,`scroll`,void 0),i.scroll=e,i.updateAlign(),i}return w(t,e),y(t,[{key:`colWidthFillTable`,value:function(){if(this.full){Object.assign(this.domNode.style,{width:null});return}var e=this.getCols();if(e){var t=e.reduce(function(e,t){return t.width+e},0);if(!(t===0||Number.isNaN(t)))return this.domNode.style.width=`${t}px`,t}}},{key:`tableId`,get:function(){return this.domNode.dataset.tableId}},{key:`full`,get:function(){return Object.hasOwn(this.domNode.dataset,`full`)},set:function(e){e?this.domNode.dataset.full=`true`:this.domNode.removeAttribute(`data-full`),this.colWidthFillTable()}},{key:`align`,get:function(){return this.domNode.dataset.align||``},set:function(e){e===`right`||e===`center`?this.domNode.dataset.align=e:this.domNode.removeAttribute(`data-align`),this.updateAlign()}},{key:`setFull`,value:function(){if(!this.full){var e=this.getCols();if(e.length!==0){var t=Math.floor(this.domNode.getBoundingClientRect().width),n=b(e),r;try{for(n.s();!(r=n.n()).done;){var i=r.value,a=i.width/t*100;i.full=!0,i.width=a}}catch(e){n.e(e)}finally{n.f()}}}}},{key:`cancelFull`,value:function(){if(this.full){var e=this.getCols();if(e.length!==0){var t=Math.floor(this.domNode.getBoundingClientRect().width),n=b(e),r;try{for(n.s();!(r=n.n()).done;){var i=r.value;i.full=!1,i.width=Math.max(i.width/100*t,z.colMinWidthPx)}}catch(e){n.e(e)}finally{n.f()}}}}},{key:`updateAlign`,value:function(){var e=this.align,t={marginLeft:null,marginRight:null};switch(e){case`center`:t.marginLeft=`auto`,t.marginRight=`auto`;break;case``:case`left`:t.marginRight=`auto`;break;case`right`:t.marginLeft=`auto`;break;default:break}Object.assign(this.domNode.style,t)}},{key:`getBodys`,value:function(){var e=this;return Array.from(this.domNode.querySelectorAll(`thead, tbody, tfoot`)).map(function(t){return e.scroll.find(t)}).filter(Boolean)}},{key:`getRows`,value:function(){var e=this;return Array.from(this.domNode.querySelectorAll(`tr`)).map(function(t){return e.scroll.find(t)}).filter(Boolean)}},{key:`getRowIds`,value:function(){return this.getRows().map(function(e){return e.rowId})}},{key:`getCols`,value:function(){return this.descendants(Hr)}},{key:`getColIds`,value:function(){return this.getCols().map(function(e){return e.colId})}},{key:`checkMerge`,value:function(){var e=this.next;return e!==null&&e.statics.blotName===this.statics.blotName&&e.domNode.dataset.tableId===this.tableId}},{key:`optimize`,value:function(e){var n=this.parent;n!==null&&n.statics.blotName!==R.tableWrapper&&this.wrap(R.tableWrapper,this.tableId),I(t,`optimize`,this,3)([e]),this.mergeRow()}},{key:`mergeRow`,value:function(){if(this.parent){var e=this.getRows(),t={},n=b(e),r;try{for(n.s();!(r=n.n()).done;){var i=r.value;t[i.rowId]||(t[i.rowId]=[]),t[i.rowId].push(i)}}catch(e){n.e(e)}finally{n.f()}for(var a=0,o=Object.values(t);a<o.length;a++)for(var s=o[a],c=1;c<s.length;c++){var l=s[c];l.moveChildren(s[0]),l.remove()}}}},{key:`checkEmptyCol`,value:function(e){if(e){var t=this.getRows().length,n=this.getCols(),r=b(this.descendants(q)),i;try{var a=function(){var e=i.value;if(e.colspan>1&&e.rowspan>=t){for(var r=n.findIndex(function(t){return t.colId===e.colId}),a=n[r],o=r+1;o<r+e.colspan;o++)n[o].remove(),a.width+=n[o].width;e.colspan=1}};for(r.s();!(i=r.n()).done;)a()}catch(e){r.e(e)}finally{r.f()}}}},{key:`checkEmptyRow`,value:function(e){for(var t=this,n=this.getRows(),r=new Set(n.map(function(e){return e.rowId})),i=function(){var i=n[a];if(e){if(i.children.length===0){for(var o=function(e){n[c].foreachCellInner(function(t){if(t.rowspan>e){--t.rowspan;var n=new Set(t.emptyRow);n.delete(i.rowId),t.emptyRow=Array.from(n)}})},s=1,c=a-1;c>=0;c--,s++)o(s);i.remove()}}else{if(i.children.length===0&&i.prev){for(var l=i.prev;l&&l.children.length===0;)l=l.prev;l.foreachCellInner(function(e){var t=new Set(e.emptyRow);t.has(i.rowId)||(e.emptyRow=[i.rowId].concat(L(t)))})}i.foreachCellInner(function(e){var n=b(e.emptyRow),a;try{for(n.s();!(a=n.n()).done;){var o=a.value;r.has(o)||i.parent.insertBefore(t.scroll.create(R.tableRow,{tableId:t.tableId,rowId:o}),i.next)}}catch(e){n.e(e)}finally{n.f()}})}},a=n.length-1;a>=0;a--)i()}},{key:`sortMergeChildren`,value:function(){var e=x(x(x(x(x({},R.tableCaption,[]),R.tableColgroup,[]),R.tableHead,[]),R.tableBody,[]),R.tableFoot,[]);this.children.forEach(function(t){e[t.statics.blotName]&&e[t.statics.blotName].push(t)});for(var t=0,n=Object.values(e);t<n.length;t++)for(var r=n[t],i=1;i<r.length;i++)r[i].moveChildren(r[0]);var a=e[R.tableCaption][0],o=e[R.tableColgroup][0],s=e[R.tableHead][0],c=e[R.tableBody][0],l=e[R.tableFoot][0],u=a&&this.children.head!==a,d=o&&a&&a.next!==o,f=o&&!a&&this.children.head!==o,p=s&&!c&&!l&&this.children.tail!==s,m=c&&s&&c.prev!==s,h=c&&!l&&this.children.tail!==c,g=c&&l&&c.next!==l,_=l&&this.children.tail!==l;if(u||d||f||p||m||h||g||_){var v=this.clone();a&&v.appendChild(a),o&&v.appendChild(o),s&&v.appendChild(s),c&&v.appendChild(c),l&&v.appendChild(l),this.children.forEach(function(e){return e.remove()}),v.moveChildren(this)}}},{key:`insertRow`,value:function(e){var t=this.getColIds(),n=this.descendants(J),r=new Set(t),i=0,a=b(n),o;try{for(a.s();!(o=a.n()).done;){var s=o.value;if(i===e)break;s.foreachCellInner(function(n){if(i+n.rowspan>e&&(n.rowspan+=1,r.delete(n.colId),n.colspan!==1))for(var a=t.indexOf(n.colId),o=0;o<n.colspan-1;o++)r.delete(t[a+o+1])}),i+=1}}catch(e){a.e(e)}finally{a.f()}var c=this.tableId,l=G(),u=this.scroll.create(R.tableRow,{tableId:c,rowId:l}),d=b(r),f;try{for(d.s();!(f=d.n()).done;){var p=f.value,m=this.scroll.create(`break`).wrap(`block`).wrap(R.tableCellInner,{tableId:c,rowId:l,colId:p,rowspan:1,colspan:1}).wrap(R.tableCell,{tableId:c,rowId:l,colId:p,rowspan:1,colspan:1});u.appendChild(m)}}catch(e){d.e(e)}finally{d.f()}var h=n[e]||null;h?h.parent.insertBefore(u,h):n[n.length-1].parent.appendChild(u)}}],[{key:`create`,value:function(e){var n=I(t,`create`,this,2)([]),r=e.tableId,i=e.full,a=e.align;return n.dataset.tableId=r,a===`right`||a===`center`?n.dataset.align=a:n.removeAttribute(`date-align`),i&&(n.dataset.full=String(i)),n.setAttribute(`cellpadding`,`0`),n.setAttribute(`cellspacing`,`0`),n}}])}(K);x(X,`blotName`,R.tableMain),x(X,`tagName`,`table`),x(X,`className`,`ql-table`);var Ur=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t,[{key:`tableId`,get:function(){return this.domNode.dataset.tableId}},{key:`full`,get:function(){return Object.hasOwn(this.domNode.dataset,`full`)},set:function(e){e?this.domNode.dataset.full=`true`:this.domNode.removeAttribute(`data-full`),this.parent&&this.parent instanceof X&&(this.parent.full=e)}},{key:`align`,get:function(){return this.domNode.dataset.align||``},set:function(e){e===`right`||e===`center`?this.domNode.dataset.align=e:this.domNode.removeAttribute(`data-align`)}},{key:`findCol`,value:function(e){for(var t=this.children.iterator(),n=0,r;(r=t())&&n!==e;)n++;return r}},{key:`insertColByIndex`,value:function(e,t){var n=this.parent;if(!(n instanceof X))throw TypeError(`TableColgroupFormat should be child of TableFormat`);var r=this.findCol(e),i=this.scroll.create(R.tableCol,t);if(n.full){for(var a=this.children.iterator(),o;o=a();)if(o.width-i.width>=z.colMinWidthPre){o.width-=i.width;break}}this.insertBefore(i,r)}},{key:`removeColByIndex`,value:function(e){var t=this.parent;if(!(t instanceof X))throw TypeError(`TableColgroupFormat should be child of TableMainFormat`);var n=this.findCol(e);n&&(t.full&&(n.next?n.next.width+=n.width:n.prev&&(n.prev.width+=n.width)),n.remove(),t.colWidthFillTable())}},{key:`checkMerge`,value:function(){var e=this.next,t=this.parent;return t instanceof X&&!t.full&&t.colWidthFillTable(),e!==null&&e.statics.blotName===this.statics.blotName&&e.tableId===this.tableId}},{key:`optimize`,value:function(e){var n=this.parent,r=this.tableId,i=this.full,a=this.align;n!=null&&n.statics.blotName!==R.tableMain&&this.wrap(R.tableMain,{tableId:r,full:i,align:a});var o=U(this,R.tableMain);o.align=a,I(t,`optimize`,this,3)([e])}}],[{key:`create`,value:function(e){var n=I(t,`create`,this,2)([]);return n.dataset.tableId=e.tableId,e.full&&(n.dataset.full=String(e.full)),e.align&&e.align!==`left`&&(n.dataset.align=e.align),n.setAttribute(`contenteditable`,`false`),n}}])}(K);x(Ur,`blotName`,R.tableColgroup),x(Ur,`tagName`,`colgroup`);var Wr=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t)}(Mr);x(Wr,`blotName`,R.tableFoot),x(Wr,`tagName`,`tfoot`);var Gr=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t)}(Mr);x(Gr,`blotName`,R.tableHead),x(Gr,`tagName`,`thead`);var Kr=t.default.import(`parchment`),qr=function(e){function n(e,r,i){var a;return _(this,n),a=g(this,n,[e,r]),x(a,`scroll`,void 0),x(a,`insertLineAround`,function(){(!a.prev||!a.isBlockLine(a.prev))&&a.parent.insertBefore(a.scroll.create(`block`),a),(!a.next||!a.isBlockLine(a.next))&&a.parent.insertBefore(a.scroll.create(`block`),a.next)}),a.scroll=e,a.scroll.emitter.on(t.default.events.TEXT_CHANGE,a.insertLineAround),a}return w(n,e),y(n,[{key:`tableId`,get:function(){return this.domNode.dataset.tableId}},{key:`checkMerge`,value:function(){var e=this.next;return e!==null&&e.statics.blotName===this.statics.blotName&&e.tableId===this.tableId}},{key:`optimize`,value:function(e){if(this.length()===0){this.remove();return}I(n,`optimize`,this,3)([e])}},{key:`deleteAt`,value:function(e,t){I(n,`deleteAt`,this,3)([e,t]);var r=this.descendants(Mr),i=this.descendants(Ur);r.length===0&&i.length===0&&this.remove()}},{key:`remove`,value:function(){I(n,`remove`,this,3)([]),this.scroll.emitter.off(t.default.events.TEXT_CHANGE,this.insertLineAround)}},{key:`isBlockLine`,value:function(e){return e instanceof Kr.BlockBlot||new Set([`list-container`,`code-block-container`]).has(e.statics.blotName)}}],[{key:`create`,value:function(e){var t=I(n,`create`,this,2)([]);return t.dataset.tableId=e,t.addEventListener(`dragstart`,function(e){e.preventDefault(),e.stopPropagation()},!0),t.addEventListener(`drop`,function(e){e.preventDefault()}),t.addEventListener(`dragover`,function(e){e.preventDefault(),e.dataTransfer.dropEffect=`none`}),t.setAttribute(`contenteditable`,`false`),t}}])}(K);x(qr,`blotName`,R.tableWrapper),x(qr,`tagName`,`div`),x(qr,`className`,`ql-table-wrapper`);function Z(e){for(var t=new Set([R.tableHead,R.tableBody,R.tableFoot]),n=e.children.iterator(),r=null,i={};r=n();)t.has(r.statics.blotName)&&(i[r.statics.blotName]=r);if(Object.values(i).length<=0)return{rect:null,head:null,body:null,foot:null};var a=Object.values(i).reduce(function(e,t){var n=t.domNode.getBoundingClientRect();return j(j({},e),{},{top:Math.min(e.top,n.top),bottom:Math.max(e.bottom,n.bottom),left:Math.min(e.left,n.left),right:Math.max(e.right,n.right)})},{top:1/0,bottom:0,left:1/0,right:0,width:0,height:0,x:1/0,y:1/0});return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,{rect:a,head:i[R.tableHead]||null,body:i[R.tableBody]||null,foot:i[R.tableFoot]||null}}var Jr=function(){function e(t,n){_(this,e),x(this,`tableModule`,void 0),x(this,`quill`,void 0),x(this,`table`,void 0),this.tableModule=t,this.quill=n,this.quill.root.addEventListener(`mousedown`,this.tableSelectHandler.bind(this))}return y(e,[{key:`tableSelectHandler`,value:function(e){var t=e.composedPath();if(!(e.button!==0||!t||t.length<=0)){var n=t.find(function(e){return e.tagName&&e.tagName.toUpperCase()===`TABLE`});this.setSelectionTable(n)}}},{key:`setSelectionTable`,value:function(e){this.table!==e&&(this.hide(),this.table=e,this.table&&this.show(),this.update())}},{key:`hide`,value:function(){}},{key:`show`,value:function(){}},{key:`update`,value:function(){}}])}(),Yr=function(e){function n(e,r,i){var a;return _(this,n),a=g(this,n,[e,r]),x(a,`tableModule`,void 0),x(a,`quill`,void 0),x(a,`tableBlot`,void 0),x(a,`tableWrapperBlot`,void 0),x(a,`alignBox`,void 0),x(a,`cleanup`,void 0),x(a,`bem`,H(`align`)),x(a,`resizeObserver`,void 0),x(a,`updateWhenTextChange`,function(e){e===t.default.events.TEXT_CHANGE&&(a.table&&!a.quill.root.contains(a.table)?a.setSelectionTable(void 0):a.update())}),a.tableModule=e,a.quill=r,a.alignBox=a.buildTools(),a.hide(),a.quill.on(t.default.events.EDITOR_CHANGE,a.updateWhenTextChange),a}return w(n,e),y(n,[{key:`buildTools`,value:function(){for(var e=this.tableModule.addContainer(this.bem.b()),n=t.default.import(`ui/icons`),r={left:n.align[``],center:n.align.center,right:n.align.right},i=0,a=Object.entries(r);i<a.length;i++){var o=F(a[i],2),s=o[0],c=o[1],l=document.createElement(`span`);l.dataset.align=s,l.classList.add(this.bem.be(`item`)),l.innerHTML=`<i class="icon">${c}</i>`,l.addEventListener(`click`,this.handleAlignItemClick.bind(this)),e.appendChild(l)}return e}},{key:`handleAlignItemClick`,value:function(e){var t=e.currentTarget;if(t){var n=t.dataset.align;n&&this.tableBlot&&this.setTableAlign(this.tableBlot,n)}}},{key:`setTableAlign`,value:function(e,t){var n=b(e.getCols()),r;try{for(n.s();!(r=n.n()).done;){var i=r.value;i.align=t}}catch(e){n.e(e)}finally{n.f()}}},{key:`show`,value:function(){var e=this;!this.table||!this.alignBox||(this.tableBlot=t.default.find(this.table),this.tableWrapperBlot=this.tableBlot.parent,this.alignBox.classList.remove(this.bem.is(`hidden`)),this.resizeObserver=or(function(){return e.update()},{ignoreFirstBind:!0}),this.resizeObserver.observe(this.table),this.cleanup&&this.cleanup(),this.cleanup=Gn(this.tableWrapperBlot.domNode,this.alignBox,function(){return e.update()}))}},{key:`hide`,value:function(){this.tableBlot=void 0,this.tableWrapperBlot=void 0,this.alignBox&&this.alignBox.classList.add(this.bem.is(`hidden`)),this.cleanup&&(this.cleanup(),this.cleanup=void 0)}},{key:`update`,value:function(){var e=this;if(!(!this.alignBox||!this.tableBlot||!this.tableWrapperBlot)){if(!this.table||this.tableBlot.full||this.tableBlot.domNode.offsetWidth>=this.quill.root.offsetWidth){this.hide();return}Xn(this.tableWrapperBlot.domNode,this.alignBox,{placement:`top`,middleware:[Jn(),qn({limiter:Yn()}),Kn(16)]}).then(function(t){var n=t.x,r=t.y;Object.assign(e.alignBox.style,{left:`${n}px`,top:`${r}px`})})}}},{key:`destroy`,value:function(){this.hide(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0),this.quill.off(t.default.events.TEXT_CHANGE,this.updateWhenTextChange),this.alignBox&&(this.alignBox.remove(),this.alignBox=null)}}])}(Jr);x(Yr,`moduleName`,`table-align`);var Xr=t.default.import(`delta`);function Zr(e,t,n){var r=Qr(t),i=r.rows,a=r.cols,o=$r(n),s=o.rows,c=o.cols,l=o.cells;i===s&&a===c?ti(t,l,e):ii(e,t,l)}function Qr(e){return e.length===0?{rows:0,cols:0}:ei(ni(e))}function $r(e){var t=new Map,n=b(e),r;try{for(n.s();!(r=n.n()).done;){var i=r.value,a=i.attributes;if(a){var o=a[R.tableCellInner];if(o){var s=`${o.rowId}-${o.colId}`;if(!t.has(s)){var c={rowId:o.rowId,colId:o.colId,rowspan:o.rowspan||1,colspan:o.colspan||1,deltaOps:[]};o.emptyRow&&o.emptyRow.length>0&&(c.emptyRow=o.emptyRow),t.set(s,c)}var l=t.get(s),u=R.tableCellInner;a[u];var d=M(a,[u].map(ie));l.deltaOps.push({insert:i.insert,attributes:j({},d)})}}}}catch(e){n.e(e)}finally{n.f()}var f=Array.from(t.values());return j(j({},ei(ni(f))),{},{cells:f})}function ei(e){var t=1/0,n=-1/0,r=1/0,i=-1/0,a=b(e),o;try{for(a.s();!(o=a.n()).done;){var s=o.value,c=s.cell,l=s.rowIndex,u=s.colIndex,d=c.colspan||1,f=c.rowspan||1;t=Math.min(t,l),n=Math.max(n,l+f-1),r=Math.min(r,u),i=Math.max(i,u+d-1)}}catch(e){a.e(e)}finally{a.f()}return{rows:Math.max(n-t+1,0),cols:Math.max(i-r+1,0)}}function ti(e,t,n){var r=ni(e),i=ni(t),a=new Map,o=b(i),s;try{for(o.s();!(s=o.n()).done;){var c=s.value;a.set(`${c.rowIndex}-${c.colIndex}`,c.cell)}}catch(e){o.e(e)}finally{o.f()}var l=[],u=new Set,d=b(r),f;try{for(d.s();!(f=d.n()).done;){var p=f.value,m=p.cell;if(!(!m.domNode.isConnected||u.has(m))){var h=a.get(`${p.rowIndex}-${p.colIndex}`);if(h){var g=ai(n,m,h.deltaOps,{rowspan:h.rowspan,colspan:h.colspan,emptyRow:h.emptyRow});l.push(g),u.add(m)}}}}catch(e){d.e(e)}finally{d.f()}oi(n,l)}function ni(e){var t=[],n=ri(e),r=-1,i=new Map,a=b(n.entries()),o;try{for(a.s();!(o=a.n()).done;){var s=F(o.value,2),c=s[0],l=s[1];i.has(c)||(r+=1,i.set(c,r));var u=0,d=b(l),f;try{for(d.s();!(f=d.n()).done;){var p=f.value;t.push({cell:p,rowIndex:i.get(c),colIndex:u}),u+=p.colspan||1;var m=b(p.emptyRow||[]),h;try{for(m.s();!(h=m.n()).done;){var g=h.value;i.has(g)||(r+=1,i.set(g,r))}}catch(e){m.e(e)}finally{m.f()}}}catch(e){d.e(e)}finally{d.f()}}}catch(e){a.e(e)}finally{a.f()}return t}function ri(e){var t=new Map,n=b(e),r;try{for(n.s();!(r=n.n()).done;){var i=r.value;t.has(i.rowId)||t.set(i.rowId,[]),t.get(i.rowId).push(i)}}catch(e){n.e(e)}finally{n.f()}return t}function ii(e,t,n){for(var r=ri(n),i=Array.from(r.values()),a=Qr(t).cols,o=[],s=0;s<t.length;s++){var c=t[s],l=Math.floor(s/a),u=s%a,d=i[l%i.length],f=d[u%d.length],p=ai(e,c,f.deltaOps);o.push(p)}oi(e,o)}function ai(e,t,n,r){var i=r||{},a=i.rowspan,o=a===void 0?1:a,s=i.colspan,c=s===void 0?1:s,l=i.emptyRow;r&&(t.rowspan=o,t.colspan=c,l&&l.length>0&&(t.emptyRow=l));var u=t.formats(),d=new Xr,f=b(n),p;try{for(f.s();!(p=f.n()).done;){var m=p.value;d.insert(m.insert,j(j({},m.attributes),u))}}catch(e){f.e(e)}finally{f.f()}return{offset:t.offset(e.quill.scroll),length:t.length(),insertDelta:d,cell:t,rowspan:o,colspan:c,emptyRow:l}}function oi(e,n){if(n.length!==0){n.sort(function(e,t){return e.offset-t.offset});for(var r=new Xr,i=0;i<n.length;i++){var a=n[i],o=a.offset;if(i!==0){var s=n[i-1];o=a.offset-s.offset-s.length}r=r.retain(o).concat(a.insertDelta).delete(a.length)}var c=b(n),l;try{for(c.s();!(l=c.n()).done;){var u=l.value;si(e,u)}}catch(e){c.e(e)}finally{c.f()}e.quill.updateContents(r,t.default.sources.USER)}}function si(e,t){var n=t.cell,r=t.rowspan,i=r===void 0?1:r,a=t.colspan,o=a===void 0?1:a;if(!(i===1&&o===1)){var s=U(n,R.tableMain);if(s){var c=n.getTableRow();if(c){var l=s.descendants(q),u=s.getRows(),d=u.indexOf(c),f=n.getColumnIndex(),p=[],m=b(l),h;try{for(m.s();!(h=m.n()).done;){var g=h.value;if(g!==n){var _=g.getTableRow();if(_){var v=u.indexOf(_),y=g.getColumnIndex(),x=v>=d&&v<d+i,S=y>=f&&y<f+o;x&&S&&p.push(g)}}}}catch(e){m.e(e)}finally{m.f()}for(var C=e.talbeModule.options.autoMergeCell,w=0,T=p;w<T.length;w++){var E=T[w];if(E.domNode.isConnected){var D=E.getTableRow();E.remove(),!C&&D&&D.length()<=0&&D.remove()}}}}}}var ci=[`style`],li=[`attributes`],ui=[`attributes`],di=[`background`],fi=t.default.import(`delta`),pi=t.default.import(`modules/clipboard`);function mi(e){var t=Number.parseFloat(e.getAttribute(`width`));if(Number.isNaN(t)){var n=e.style.width;t=n?Number.parseFloat(n):e.offsetWidth}return t||z.colDefaultWidth}function hi(e,t){for(var n=Array(t).fill(z.colDefaultWidth),r=Array.from(e.querySelectorAll(`tr`)),i=0,a=r;i<a.length;i++)for(var o=a[i],s=Array.from(o.querySelectorAll(`td`)),c=0,l=0,u=s;l<u.length;l++){var d=u[l],f=d.colSpan||1;if(c<t)for(var p=mi(d),m=0;m<f;m++)n[c+m]=p/f;else break;c+=f}return n}var gi=function(e){function t(e,n){var r;return _(this,t),r=g(this,t,[e,n]),x(r,`quill`,void 0),x(r,`tableId`,G()),x(r,`rowId`,G()),x(r,`colIds`,[]),x(r,`rowspanCount`,[]),x(r,`cellCount`,0),x(r,`colCount`,0),r.quill=e,r.addMatcher(`table`,r.matchTable.bind(r)),r.addMatcher(`thead`,r.matchThead.bind(r)),r.addMatcher(`tbody`,r.matchTbody.bind(r)),r.addMatcher(`tfoot`,r.matchTfoot.bind(r)),r.addMatcher(`colgroup`,r.matchColgroup.bind(r)),r.addMatcher(`col`,r.matchCol.bind(r)),r.addMatcher(`tr`,r.matchTr.bind(r)),r.addMatcher(`td`,r.matchTd.bind(r)),r.addMatcher(`th`,r.matchTd.bind(r)),r.addMatcher(`caption`,r.matchCaption.bind(r)),r.addMatcher(Node.ELEMENT_NODE,r.matchTdAttributor.bind(r)),r}return w(t,e),y(t,[{key:`getStyleBackgroundColor`,value:function(e,t){var n=e.style.backgroundColor;if(n){var r=b(t.ops),i;try{for(r.s();!(i=r.n()).done;){var a,o=i.value;if((a=o.attributes)!=null&&a[R.tableCellInner]){var s=o.attributes[R.tableCellInner],c=s.style,l=M(s,ci),u=gr(c||``);u.backgroundColor||(u.backgroundColor=n,o.attributes[R.tableCellInner]=j(j({},l),{},{style:_r(u)}))}}}catch(e){r.e(e)}finally{r.f()}}}},{key:`matchTable`,value:function(e,t){var n=this;if(t.ops.length===0)return t;for(var r=[],i=[],a=-1,o=0;o<t.ops.length;o++){var s=t.ops[o],c=s.attributes,l=s.insert;if(!Ae(l)&&(!c||!c[R.tableCellInner]&&!c[R.tableCaption])){t.ops.splice(o,1),--o;continue}var u=c||{},d=R.tableCell;u.table,u[d];var f=M(u,[`table`,d].map(ie)),p=Ae(l)&&l[R.tableCol];p?i.push({insert:l}):r.push({attributes:f,insert:l}),!(f!=null&&f[R.tableCellInner])&&!(f!=null&&f[R.tableCaption])&&!p&&Oe(l)&&l.trim().length>0&&(a=o)}var m=hi(e,this.colIds.length).reduce(function(e,t,r){return i[r]?e.push(i[r]):e.push({insert:x({},R.tableCol,{tableId:n.tableId,colId:n.colIds[r],width:t,full:!1})}),e},[]);r.splice.apply(r,[a+1,0].concat(L(m)));var h=new fi(r);return this.getStyleBackgroundColor(e,h),this.tableId=G(),this.colIds=[],this.rowspanCount=[],this.cellCount=0,this.colCount=0,h}},{key:`matchTbody`,value:function(e,t){this.getStyleBackgroundColor(e,t);for(var n=[],r=t.ops.length-1;r>=0;r--){var i,a=t.ops[r];if((i=a.attributes)!=null&&i[R.tableCellInner]){if(a.attributes){var o=a.attributes[R.tableCellInner];if(o.rowspan===1)n=[];else if(n.length>0&&(o.emptyRow||(o.emptyRow=[]),n.length>o.emptyRow.length)){var s;(s=o.emptyRow).push.apply(s,L(n.slice(o.emptyRow.length-n.length)))}}}else{n=[];for(var c=a.insert?Oe(a.insert)?a.insert.split(`
`).length-1:1:0,l=0;l<c;l++)n.push(G())}}return this.rowspanCount=[],t}},{key:`matchThead`,value:function(e,t){var n=this.matchTbody(e,t),r=b(n.ops),i;try{for(r.s();!(i=r.n()).done;){var a=i.value;if(a.attributes&&a.attributes[R.tableCellInner]){var o=a.attributes[R.tableCellInner];o.wrapTag=`thead`}}}catch(e){r.e(e)}finally{r.f()}return n}},{key:`matchTfoot`,value:function(e,t){var n=this.matchTbody(e,t),r=b(n.ops),i;try{for(r.s();!(i=r.n()).done;){var a=i.value;if(a.attributes&&a.attributes[R.tableCellInner]){var o=a.attributes[R.tableCellInner];o.wrapTag=`tfoot`}}}catch(e){r.e(e)}finally{r.f()}return n}},{key:`matchColgroup`,value:function(e,t){for(var n=[],r=0;r<t.ops.length;r++){var i=t.ops[r];i&&Ae(i.insert)&&i.insert[R.tableCol]&&n.push(i)}return new fi(n)}},{key:`matchCol`,value:function(e,t){var n=Number(e.getAttribute(`span`)||1);Number.isNaN(n)&&(n=1);for(var r=new fi,i=0;i<n;i++)this.colIds[this.colCount]=G(),r.insert(x({},R.tableCol,Object.assign(Hr.value(e),{tableId:this.tableId,colId:this.colIds[this.colCount]}))),this.colCount+=1;return r}},{key:`matchTr`,value:function(e,t){this.rowId=G(),this.cellCount=0;var n=b(this.rowspanCount.entries()),r;try{for(n.s();!(r=n.n()).done;){var i=F(r.value,2),a=i[0],o=i[1];o.rowspan>0&&--o.rowspan,o.rowspan<=0&&(this.rowspanCount[a]={rowspan:0,colspan:0})}}catch(e){n.e(e)}finally{n.f()}return this.getStyleBackgroundColor(e,t),t.ops.length===0?new fi([{insert:`
`}]):t}},{key:`matchTd`,value:function(e,t){var n=e,r=Y.formats(n);if(!this.colIds[this.cellCount]||!this.rowspanCount[this.cellCount])for(var i=this.cellCount;i>=0;i--)this.colIds[i]||(this.colIds[i]=G()),this.rowspanCount[i]||(this.rowspanCount[i]={rowspan:0,colspan:0});for(var a=this.cellCount;a<this.rowspanCount.length;a++){var o=this.rowspanCount[a],s=o.rowspan,c=o.colspan;if(s===0)break;this.cellCount+=c}r.rowspan>1&&(this.rowspanCount[this.cellCount]={rowspan:r.rowspan,colspan:r.colspan});var l=this.colIds[this.cellCount];this.cellCount+=r.colspan;var u=Object.assign(r,{tableId:this.tableId,rowId:this.rowId,colId:l});n.style.border===`none`&&(u.style=u.style.replaceAll(/border-(top|right|bottom|left)-style:none;?/g,``));var d=[],f=b(t.ops),p;try{for(f.s();!(p=f.n()).done;){var m=p.value,h=m.attributes,g=h===void 0?{}:h,_=M(m,li),v=R.tableCell;g[v];var y=M(g,[v].map(ie));d.push(j(j({},_),{},{attributes:j(j({},y),{},x({},R.tableCellInner,u))}))}}catch(e){f.e(e)}finally{f.f()}return(d.length<=0||!Oe(d[d.length-1].insert)||!d[d.length-1].insert.endsWith(`
`))&&d.push({insert:`
`,attributes:x({},R.tableCellInner,u)}),new fi(d)}},{key:`matchTdAttributor`,value:function(e,t){if(e.tagName.toLocaleLowerCase()===`td`){var n=[],r=b(t.ops),i;try{for(r.s();!(i=r.n()).done;){var a=i.value,o=a.attributes,s=M(a,ui),c=o==null?void 0:o[R.tableCellInner];if(o&&c&&c.style){var l=o.background,u=M(o,di),d=document.createElement(`div`);d.style.background=l;var f=document.createElement(`div`);if(f.style.cssText=c.style,d.style.background===f.style.backgroundColor){n.push(j(j({},s),{},{attributes:j({},u)}));continue}}n.push(a)}}catch(e){r.e(e)}finally{r.f()}return new fi(n)}return t}},{key:`convert`,value:function(e){var n=e.html,r=e.text,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=I(t,`convert`,this,3)([{html:n,text:r},i]);if(i[R.tableCellInner]){var o=b(a.ops),s;try{for(o.s();!(s=o.n()).done;){var c=s.value;if(Ae(c.insert)&&c.insert[R.tableCol]){c.insert=``;continue}c.attributes||(c.attributes={}),c.attributes[R.tableCellInner]=i[R.tableCellInner]}}catch(e){o.e(e)}finally{o.f()}}return a}},{key:`matchCaption`,value:function(e,t){for(var n=0;n<t.ops.length;n++){var r=t.ops[n],i=r.attributes;i&&i[R.tableCaption]&&(i[R.tableCaption].tableId=this.tableId,r.attributes=i)}return t}}])}(pi),_i=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <!-- Icon from Tabler Icons by Paweł Kuna - https://github.com/tabler/tabler-icons/blob/master/LICENSE -->
  <path
    fill="none"
    stroke="currentColor"
    stroke-linecap="round"
    stroke-linejoin="round"
    stroke-width="2"
    d="M4 12V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v6m-10 6H3m18 0h-7m-8-3l-3 3l3 3m12-6l3 3l-3 3"
  />
</svg>
`,vi=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="none"
    stroke="currentColor"
    stroke-linecap="round"
    stroke-linejoin="round"
    stroke-width="2"
    d="m4 8l4-4m6 0L4 14m0 6L20 4m0 6L10 20m10-4l-4 4"
  />
</svg>
`,yi=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="none"
    stroke="currentColor"
    stroke-linecap="round"
    stroke-linejoin="round"
    stroke-width="1.5"
    d="m12.01 16l-.01.011M12.01 12l-.01.011M12.01 8l-.01.011M8.01 12l-.01.011M16.01 12l-.01.011M21 3.6v16.8a.6.6 0 0 1-.6.6H3.6a.6.6 0 0 1-.6-.6V3.6a.6.6 0 0 1 .6-.6h16.8a.6.6 0 0 1 .6.6"
  />
</svg>
`,bi=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">\r
  <!-- Icon from Material Symbols by Google - https://github.com/google/material-design-icons/blob/master/LICENSE -->\r
  <path\r
    fill="currentColor"\r
    d="M11 21V9H3V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm2-2h6v-4h-6zm0-6h6V9h-6zM5 7h14V5H5zM3 22v-2h2.55q-1.2-.575-1.937-1.7t-.738-2.55q0-1.975 1.388-3.363T7.625 11v2q-1.125 0-1.937.8t-.813 1.95q0 .975.6 1.725t1.525.95V16h2v6z"\r
  />\r
</svg>\r
`,xi=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 256">
  <g fill="currentColor">
    <path d="M216 40v128h-48V88H88V40Z" opacity=".2" />
    <path
      d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"
    />
  </g>
</svg>
`,Si=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 32 32">
  <path
    fill="currentColor"
    d="m19.05 13.733l-1-1.733l-10.122 5.846l-.997-.576a3 3 0 0 0 .667-.769A3 3 0 1 0 3.5 17.599L5.928 19L3.5 20.402a3.034 3.034 0 1 0 3.44.323l.988-.57L14.59 24l1-1.73L9.928 19zM4.034 15.26a1 1 0 1 1 .466.607a1 1 0 0 1-.466-.607M5 22a1 1 0 1 1-.865 1.5A1 1 0 0 1 5 22m12 4h4v2h-4zm-7 0h4v2h-4z"
  />
  <path fill="currentColor" d="M28 28h-4v-2h4V4H7v4H5V4a2 2 0 0 1 2-2h21a2 2 0 0 1 2 2v22a2 2 0 0 1-2 2" />
</svg>
`,Ci=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="currentColor"
    d="M4 3h14a2 2 0 0 1 2 2v7.08a6 6 0 0 0-4.32.92H12v4h1.08c-.11.68-.11 1.35 0 2H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2m0 4v4h6V7zm8 0v4h6V7zm-8 6v4h6v-4zm11.94 5.5h2v-4h2v4h2l-3 3z"
  />
</svg>
`,wi=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="currentColor"
    d="M4 3h14a2 2 0 0 1 2 2v7.08a6 6 0 0 0-4.32.92H12v4h1.08c-.11.68-.11 1.35 0 2H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2m0 4v4h6V7zm8 0v4h6V7zm-8 6v4h6v-4zm14.44 2v2h4v2h-4v2l-3-3z"
  />
</svg>
`,Ti=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="currentColor"
    d="M4 3h14a2 2 0 0 1 2 2v7.08a6 6 0 0 0-4.32.92H12v4h1.08c-.11.68-.11 1.35 0 2H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2m0 4v4h6V7zm8 0v4h6V7zm-8 6v4h6v-4zm15.44 8v-2h-4v-2h4v-2l3 3z"
  />
</svg>
`,Ei=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="currentColor"
    d="M4 3h14a2 2 0 0 1 2 2v7.08a6 6 0 0 0-4.32.92H12v4h1.08c-.11.68-.11 1.35 0 2H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2m0 4v4h6V7zm8 0v4h6V7zm-8 6v4h6v-4zm17.94 4.5h-2v4h-2v-4h-2l3-3z"
  />
</svg>
`,Di=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="currentColor"
    d="M5 10H3V4h8v2H5zm14 8h-6v2h8v-6h-2zM5 18v-4H3v6h8v-2zM21 4h-8v2h6v4h2zM8 13v2l3-3l-3-3v2H3v2zm8-2V9l-3 3l3 3v-2h5v-2z"
  />
</svg>
`,Oi=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="currentColor"
    d="M4 2h7a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m0 8v4h7v-4zm0 6v4h7v-4zM4 4v4h7V4zm13.59 8L15 9.41L16.41 8L19 10.59L21.59 8L23 9.41L20.41 12L23 14.59L21.59 16L19 13.41L16.41 16L15 14.59z"
  />
</svg>
`,ki=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="currentColor"
    d="M9.41 13L12 15.59L14.59 13L16 14.41L13.41 17L16 19.59L14.59 21L12 18.41L9.41 21L8 19.59L10.59 17L8 14.41zM22 9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2zM4 9h4V6H4zm6 0h4V6h-4zm6 0h4V6h-4z"
  />
</svg>
`,Ai=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="currentColor"
    d="m15.46 15.88l1.42-1.42L19 16.59l2.12-2.13l1.42 1.42L20.41 18l2.13 2.12l-1.42 1.42L19 19.41l-2.12 2.13l-1.42-1.42L17.59 18zM4 3h14a2 2 0 0 1 2 2v7.08a6 6 0 0 0-4.32.92H12v4h1.08c-.11.68-.11 1.35 0 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2m0 4v4h6V7zm8 0v4h6V7zm-8 6v4h6v-4z"
  />
</svg>
`,ji=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <path
    fill="currentColor"
    d="M19 14h2v6H3v-6h2v4h14zM3 4v6h2V6h14v4h2V4zm8 7v2H8v2l-3-3l3-3v2zm5 0V9l3 3l-3 3v-2h-3v-2z"
  />
</svg>
`,Mi=`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
  <!-- Icon from TDesign Icons by TDesign - https://github.com/Tencent/tdesign-icons/blob/main/LICENSE -->
  <path fill="currentColor" d="M21 10v12h-2V12H5v10H3V10zm0-8v6H3V2zm-2 2H5v2h14z" />
</svg>
`,Ni=`color-selector`;function Pi(e,t){return Fi.apply(this,arguments)}function Fi(){return Fi=h(P().mark(function e(t,n){var r,i,a,o,s=arguments;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&s[2]!==void 0?s[2]:!1,i=t.getTextByCell(n),a=t.getHTMLByCell(n,r),o=new ClipboardItem({"text/plain":new Blob([i],{type:`text/plain`}),"text/html":new Blob([a],{type:`text/html`})}),e.next=1,navigator.clipboard.write([o]);case 1:case`end`:return e.stop()}},e)})),Fi.apply(this,arguments)}var Q={Break:{name:`break`},CopyCell:{name:`CopyCell`,tip:`Copy cell`,icon:xi,handle:function(e,t){Pi.call(this,e,t,!1)}},CutCell:{name:`CutCell`,tip:`Cut cell`,icon:Si,handle:function(e,t){Pi.call(this,e,t,!0)}},InsertTop:{name:`InsertTop`,icon:Ei,tip:`Insert row above`,handle:function(e,t){e.appendRow(t,!1)}},InsertRight:{name:`InsertRight`,icon:Ti,tip:`Insert column right`,handle:function(e,t){e.appendCol(t,!0)}},InsertBottom:{name:`InsertBottom`,icon:Ci,tip:`Insert row below`,handle:function(e,t){e.appendRow(t,!0)}},InsertLeft:{name:`InsertLeft`,icon:wi,tip:`Insert column Left`,handle:function(e,t){e.appendCol(t,!1)}},MergeCell:{name:`MergeCell`,icon:Di,tip:`Merge Cell`,handle:function(e,t){e.mergeCells(t)}},SplitCell:{name:`SplitCell`,icon:ji,tip:`Split Cell`,handle:function(e,t){e.splitCell(t)}},DeleteRow:{name:`DeleteRow`,icon:ki,tip:`Delete Row`,handle:function(e,t){e.removeRow(t)}},DeleteColumn:{name:`DeleteColumn`,icon:Oi,tip:`Delete Column`,handle:function(e,t){e.removeCol(t)}},DeleteTable:{name:`DeleteTable`,icon:Ai,tip:`Delete table`,handle:function(e,t){e.deleteTable(t)}},BackgroundColor:{name:`BackgroundColor`,icon:vi,isColorChoose:!0,tip:`Set background color`,key:`background-color`,handle:function(e,t,n){e.setCellAttrs(t,`background-color`,n,!0)}},BorderColor:{name:`BorderColor`,icon:yi,isColorChoose:!0,tip:`Set border color`,key:`border-color`,handle:function(e,t,n){e.setCellAttrs(t,`border-color`,n,!0)}},SwitchWidth:{name:`SwitchWidth`,icon:_i,tip:`Switch table width`,handle:function(){if(this.table){var e=t.default.find(this.table);e&&(e.full?e.cancelFull():e.setFull())}}},InsertCaption:{name:`InsertCaption`,icon:Mi,tip:`Insert table caption`,handle:function(){if(this.table){var e=t.default.find(this.table);if(e){var n=this.quill.scroll.create(`text`,`Table Caption`).wrap(R.tableCaption,{tableId:e.tableId});e.insertBefore(n,e.children.head)}}}},ToggleTdBetweenTh:{name:`ToggleTdBetweenTh`,icon:bi,tip:`Toggle td between th`,handle:function(e,t){var n=b(t),r;try{for(n.s();!(r=n.n()).done;)r.value.convertTableCell()}catch(e){n.e(e)}finally{n.f()}}},ConvertTothead:{name:`ConvertTothead`,icon:bi,tip:`Convert to thead`,handle:function(e,n){if(this.table){var r=t.default.find(this.table);r&&e.convertTableBodyByCells(r,n,`thead`)}}},ConvertTotfoot:{name:`ConvertTotfoot`,icon:bi,tip:`Convert to tfoot`,handle:function(e,n){if(this.table){var r=t.default.find(this.table);r&&e.convertTableBodyByCells(r,n,`tfoot`)}}}},Ii=10,Li=H(`color-map`),$={selectWrapper:Li.b(),used:Li.bm(`used`),item:Li.be(`item`),btn:Li.be(`btn`),map:Li.be(`content`),mapRow:Li.be(`content-row`)},Ri=function(e){function n(e,r,i){var a;_(this,n),a=g(this,n,[e,r]),x(a,`tableModule`,void 0),x(a,`quill`,void 0),x(a,`usedColors`,new Set),x(a,`options`,void 0),x(a,`menu`,null),x(a,`isMenuDisplay`,!1),x(a,`isColorPicking`,!1),x(a,`tooltipItem`,[]),x(a,`activeTooltip`,null),x(a,`bem`,H(`menu`)),x(a,`colorItemClass`,`color-${G()}`),x(a,`colorChooseTooltipOption`,{direction:`top`}),x(a,`updateUsedColor`,vr(function(e){if(e){if(a.usedColors.add(e),a.usedColors.size>Ii){var t=Array.from(a.usedColors).slice(-1*Ii);a.usedColors.clear(),t.map(function(e){return a.usedColors.add(e)})}localStorage.setItem(a.options.localstorageKey,JSON.stringify(Array.from(a.usedColors)));for(var n=Array.from(document.querySelectorAll(`.${a.colorItemClass}.${$.used}`)),r=0,i=n;r<i.length;r++){var o=i[r],s=document.createElement(`div`);s.classList.add($.item),s.style.backgroundColor=String(e),Array.from(o.querySelectorAll(`.${$.item}[style*="background-color: ${s.style.backgroundColor}"]`)).length<=0&&o.appendChild(s);var c=b(Array.from(o.querySelectorAll(`.${$.item}`)).slice(0,-1*Ii)),l;try{for(c.s();!(l=c.n()).done;)l.value.remove()}catch(e){c.e(e)}finally{c.f()}}}},1e3)),x(a,`hideWhenSelectionDragStart`,function(){a.hide()}),x(a,`updateWhenTextChange`,function(e){e===t.default.events.TEXT_CHANGE&&a.isMenuDisplay&&a.update()}),a.tableModule=e,a.quill=r,a.options=a.resolveOptions(i);try{var o=localStorage.getItem(a.options.localstorageKey)||`[]`,s=JSON.parse(o);De(s)||(s=[]),s.slice(-1*Ii).map(function(e){return a.usedColors.add(e)})}catch(e){}return a.quill.on(t.default.events.EDITOR_CHANGE,a.updateWhenTextChange),a.quill.on(B.TABLE_SELECTION_DRAG_START,a.hideWhenSelectionDragStart),a}return w(n,e),y(n,[{key:`resolveOptions`,value:function(e){return Object.assign({tipText:!0,tools:[Q.InsertTop,Q.InsertRight,Q.InsertBottom,Q.InsertLeft,Q.Break,Q.MergeCell,Q.SplitCell,Q.Break,Q.DeleteRow,Q.DeleteColumn,Q.DeleteTable,Q.Break,Q.BackgroundColor,Q.BorderColor],localstorageKey:`__table-bg-used-color`,defaultColorMap:ce},e)}},{key:`buildTools`,value:function(){var e=this,t=document.createElement(`div`);t.classList.add(this.bem.b()),Object.assign(t.style,{display:`flex`});var n=b(this.options.tools),r;try{var i=function(){var n=r.value,i=n.name,a=n.icon,o=n.handle,s=n.isColorChoose,c=n.key,l=n.tip,u=l===void 0?``:l,d=document.createElement(`span`);if(d.classList.add(e.bem.be(`item`)),i===`break`)d.classList.add(e.bem.is(`break`));else{var f=document.createElement(`i`);if(f.classList.add(`icon`),Ee(a)?f.appendChild(a(e.tableModule)):f.innerHTML=a,d.appendChild(f),s&&c){var p=e.createColorChoose(d,{name:i,icon:a,handle:o,isColorChoose:s,key:c,tip:u});e.tooltipItem.push(p),d.classList.add(Ni)}else Ee(o)&&d.addEventListener(`click`,function(t){e.quill.focus(),o.call(e,e.tableModule,e.getSelectedTds(),t)},!1);var m=e.tableModule.options.texts[i]||u;e.options.tipText&&m&&u&&e.createTipText(d,m)}t.appendChild(d)};for(n.s();!(r=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}return t}},{key:`createColorChoose`,value:function(e,t){var n=this,r=t.handle,i=t.key,a=document.createElement(`div`);if(a.classList.add($.selectWrapper),this.options.defaultColorMap.length>0){var o=document.createElement(`div`);o.classList.add($.map);var s=b(this.options.defaultColorMap),c;try{for(s.s();!(c=s.n()).done;){var l=c.value,u=document.createElement(`div`);u.classList.add($.mapRow);var d=b(l),f;try{for(d.s();!(f=d.n()).done;){var p=f.value,m=document.createElement(`div`);m.classList.add($.item),m.style.backgroundColor=p,u.appendChild(m)}}catch(e){d.e(e)}finally{d.f()}o.appendChild(u)}}catch(e){s.e(e)}finally{s.f()}a.appendChild(o)}var h=document.createElement(`div`);h.classList.add($.mapRow),Object.assign(h.style,{marginTop:`4px`});var g=document.createElement(`div`);g.classList.add($.btn,`transparent`),g.textContent=this.tableModule.options.texts.transparent,g.addEventListener(`click`,function(){r.call(n,n.tableModule,n.getSelectedTds(),`transparent`)});var _=document.createElement(`div`);_.classList.add($.btn,`clear`),_.textContent=this.tableModule.options.texts.clear,_.addEventListener(`click`,function(){r.call(n,n.tableModule,n.getSelectedTds(),null)});var v=document.createElement(`div`);v.classList.add($.btn,`custom`),v.textContent=this.tableModule.options.texts.custom;var y=Fe({onChange:function(e){r.call(n,n.tableModule,n.getSelectedTds(),e),n.updateUsedColor(e)}}),x=er(v,{direction:`right`,type:`click`,content:y,container:v}),S=x.hide,C=x.destroy;h.appendChild(g),h.appendChild(_),h.appendChild(v),a.appendChild(h);var w=document.createElement(`div`);w.classList.add($.used,this.colorItemClass);var T=b(this.usedColors),E;try{for(T.s();!(E=T.n()).done;){var D=E.value,O=document.createElement(`div`);O.classList.add($.item),O.style.backgroundColor=D,w.appendChild(O)}}catch(e){T.e(e)}finally{T.f()}a.appendChild(w),a.addEventListener(`click`,function(e){e.stopPropagation(),S();var t=e.target,r=t.style.backgroundColor,a=n.getSelectedTds();if(t&&r&&a.length>0){if(n.tableModule.setCellAttrs(a,i,r,!0),!t.closest(`.${$.item}`))return;n.updateUsedColor(r)}});var k=er(e,j({type:`click`,content:a,onOpen:function(){var e=n.tableModule.getModule(V.tableSelectionName);return n.isMenuDisplay&&e&&e.hideDisplay(),n.setActiveTooltip(k),!1},onClose:function(){var e=n.tableModule.getModule(V.tableSelectionName);return n.isMenuDisplay&&e&&(e.updateWithSelectedTds(),e.showDisplay()),a.contains(y)&&S(),n.activeTooltip===k&&(n.activeTooltip=null),!1},onDestroy:function(){C(),n.activeTooltip===k&&(n.activeTooltip=null)}},this.colorChooseTooltipOption));return k.isColorPick=!0,k}},{key:`setActiveTooltip`,value:function(e){this.activeTooltip&&this.activeTooltip!==e&&this.activeTooltip.hide(!0),this.activeTooltip=e}},{key:`getSelectedTds`,value:function(){var e=this.tableModule.getModule(V.tableSelectionName);return(e==null?void 0:e.selectedTds)||[]}},{key:`createTipText`,value:function(e,t){var n=er(e,{msg:t});n&&this.tooltipItem.push(n)}},{key:`show`,value:function(){this.table&&(this.menu&&this.hide(),this.menu=this.buildTools())}},{key:`update`,value:function(){this.table&&!this.quill.root.contains(this.table)&&this.setSelectionTable(void 0)}},{key:`hide`,value:function(){this.menu&&(this.menu.remove(),this.menu=null);var e=b(this.tooltipItem),t;try{for(e.s();!(t=e.n()).done;)t.value.hide(!0)}catch(t){e.e(t)}finally{e.f()}this.isMenuDisplay=!1}},{key:`destroy`,value:function(){this.quill.off(t.default.events.TEXT_CHANGE,this.updateWhenTextChange),this.quill.off(B.TABLE_SELECTION_DRAG_START,this.hideWhenSelectionDragStart),this.activeTooltip=null;var e=b(this.tooltipItem),n;try{for(e.s();!(n=e.n()).done;)n.value.destroy()}catch(t){e.e(t)}finally{e.f()}this.tooltipItem=[],this.hide()}}])}(Jr);x(Ri,`moduleName`,`table-menu`);var zi=function(e){function t(e,n,r){var i;return _(this,t),i=g(this,t,[e,n,r]),x(i,`tableModule`,void 0),x(i,`quill`,void 0),x(i,`colorChooseTooltipOption`,{direction:`right`}),x(i,`tableSelectioChange`,function(e){e.selectedTds.length<=0&&i.hide()}),x(i,`listenContextmenu`,function(e){var t;e.preventDefault();var n=e.composedPath();if(!(!n||n.length<=0)){var r=n.find(function(e){return e.tagName&&e.tagName.toUpperCase()===`TABLE`&&e.classList.contains(`ql-table`)}),a=i.tableModule.getModule(V.tableSelectionName);r&&a!=null&&(t=a.selectedTds)!=null&&t.length?(i.menu||(i.menu=i.buildTools()),Object.assign(i.menu.style,{display:`flex`}),i.isMenuDisplay=!0,i.update({x:e.clientX,y:e.clientY}),document.addEventListener(`click`,function(){i.hide()},{once:!0})):i.hide()}}),i.tableModule=e,i.quill=n,i.quill.root.addEventListener(`contextmenu`,i.listenContextmenu),i.quill.on(B.TABLE_SELECTION_CHANGE,i.tableSelectioChange),i.quill.on(B.TABLE_SELECTION_DISPLAY_CHANGE,i.tableSelectioChange),i}return w(t,e),y(t,[{key:`buildTools`,value:function(){var e=I(t,`buildTools`,this,3)([]);e.classList.add(this.bem.is(`contextmenu`));for(var n=e.getElementsByClassName(Ni),r=0,i=Array.from(n);r<i.length;r++)i[r].addEventListener(`click`,function(e){return e.stopPropagation()});return document.body.appendChild(e),e}},{key:`createTipText`,value:function(e,t){var n=document.createElement(`span`);n.textContent=t,e.appendChild(n)}},{key:`show`,value:function(){}},{key:`update`,value:function(e){I(t,`update`,this,3)([]);var n=this.tableModule.getModule(V.tableSelectionName);if(!this.table||!this.isMenuDisplay||!this.menu){this.hide();return}if(!(!e||!(n!=null&&n.isDisplaySelection))){var r={display:`flex`,left:0,top:0},i=e.x,a=e.y;r.left=i,r.top=a,Object.assign(this.menu.style,j(j({},r),{},{left:`${r.left+window.scrollX}px`,top:`${r.top+window.scrollY}px`}));var o=ar(this.menu.getBoundingClientRect()),s=o.left,c=o.top;Object.assign(this.menu.style,{left:`${s+window.scrollX}px`,top:`${c+window.scrollY}px`})}}},{key:`destroy`,value:function(){this.quill.root.removeEventListener(`contextmenu`,this.listenContextmenu),I(t,`destroy`,this,3)([]),this.quill.off(B.TABLE_SELECTION_CHANGE,this.tableSelectioChange),this.quill.off(B.TABLE_SELECTION_DISPLAY_CHANGE,this.tableSelectioChange)}}])}(Ri);x(zi,`moduleName`,`table-menu-contextmenu`);var Bi=function(e){function t(e,n,r){var i;return _(this,t),i=g(this,t,[e,n,r]),x(i,`tableModule`,void 0),x(i,`quill`,void 0),x(i,`tableSelectionDragStart`,function(){i.hide()}),x(i,`tableSelectionDragEnd`,function(e){e.selectedTds.length>0&&i.show()}),x(i,`tableSelectioChange`,function(e,t){t.length<=0&&i.hide()}),x(i,`tableSelectionDisplayChange`,function(e){e.dragging||i.update()}),i.tableModule=e,i.quill=n,i.quill.on(B.TABLE_SELECTION_DRAG_START,i.tableSelectionDragStart),i.quill.on(B.TABLE_SELECTION_DRAG_END,i.tableSelectionDragEnd),i.quill.on(B.TABLE_SELECTION_CHANGE,i.tableSelectioChange),i.quill.on(B.TABLE_SELECTION_DISPLAY_CHANGE,i.tableSelectionDisplayChange),i}return w(t,e),y(t,[{key:`buildTools`,value:function(){var e=I(t,`buildTools`,this,3)([]);return this.tableModule.addContainer(e),e}},{key:`show`,value:function(){I(t,`show`,this,3)([]),this.update()}},{key:`update`,value:function(){var e=this;if(I(t,`update`,this,3)([]),!this.menu&&this.table){this.show();return}var n=this.getSelectedTds();if(!this.menu||!this.table||n.length===0){(this.menu||!this.table)&&(this.isMenuDisplay=!1,this.menu&&this.menu.classList.add(this.bem.is(`hidden`)),this.hide());return}this.isMenuDisplay=!0,this.menu.classList.remove(this.bem.is(`hidden`));var r=this.tableModule.getModule(V.tableSelectionName);r!=null&&r.isDisplaySelection&&Xn(r.cellSelect,this.menu,{placement:`bottom`,middleware:[Jn(),qn({limiter:Yn()}),Kn(20)]}).then(function(t){var n=t.x,r=t.y;e.menu&&Object.assign(e.menu.style,{left:`${n}px`,top:`${r}px`})})}},{key:`destroy`,value:function(){I(t,`destroy`,this,3)([]),this.quill.off(B.TABLE_SELECTION_DRAG_START,this.tableSelectionDragStart),this.quill.off(B.TABLE_SELECTION_DRAG_END,this.tableSelectionDragEnd)}}])}(Ri);x(Bi,`moduleName`,`table-menu-select`);var Vi=function(e){return!e.full&&e.align===`right`};function Hi(e,t){if(t<0||t>=e.length)return null;for(var n=e[0].domNode.getBoundingClientRect().left,r=0;r<t;r++){var i=e[r].domNode.getBoundingClientRect();n+=i.width}var a=e[t].domNode.getBoundingClientRect().width;return{left:n,right:n+a,width:a}}var Ui=function(){function e(t,n){_(this,e),x(this,`maxRange`,1/0),x(this,`minRange`,-1/0),x(this,`startValue`,0),x(this,`dragBreak`,null),x(this,`tableModule`,void 0),x(this,`isX`,!1),this.tableModule=t,this.isX=n}return y(e,[{key:`createBreak`,value:function(){this.dragBreak&&this.dragBreak.remove();var e=H(`drag`);this.dragBreak=this.tableModule.addContainer(e.be(`line`)),this.dragBreak.classList.add(e.is(this.isX?`col`:`row`))}},{key:`getOffsetFromStart`,value:function(e){var t=0;if(!e)return t;var n=Z(e).rect;return n&&(t=n[this.isX?`x`:`y`]-this.startValue),t}},{key:`limitRange`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=0;return n&&(r=this.getOffsetFromStart(e)),Math.min(this.maxRange+r,Math.max(t,this.minRange+r))}}])}(),Wi=function(e){function t(e,n){var r;return _(this,t),r=g(this,t,[e,n]),x(r,`tableModule`,void 0),x(r,`quill`,void 0),x(r,`tableBlot`,void 0),x(r,`dragging`,!1),x(r,`colIndex`,-1),x(r,`rowIndex`,-1),x(r,`dragXCommon`,void 0),x(r,`dragYCommon`,void 0),r.tableModule=e,r.quill=n,r.dragXCommon=new Ui(e,!0),r.dragYCommon=new Ui(e,!1),r}return w(t,e),y(t,[{key:`findDragColIndex`,value:function(e){return-1}},{key:`calculateColDragRangeByFull`,value:function(){if(this.tableBlot){var e=Z(this.tableBlot).rect;if(e){var t=this.tableBlot.getCols();if(this.colIndex=this.findDragColIndex(t),this.colIndex!==-1){var n=Hi(t,this.colIndex),r=z.colMinWidthPre/100*e.width,i=e.right;t[this.colIndex+1]&&(i=Math.max(Hi(t,this.colIndex+1).right-r,n.left+r));var a=n.left+r;this.dragXCommon.minRange=a,this.dragXCommon.maxRange=i}}}}},{key:`calculateColDragRangeByFixed`,value:function(){if(this.tableBlot){var e=this.tableBlot.getCols();if(this.colIndex=this.findDragColIndex(e),this.colIndex!==-1){var t=Hi(e,this.colIndex);this.dragXCommon.minRange=Vi(this.tableBlot)?t.right-z.colMinWidthPx:t.left+z.colMinWidthPx,this.dragXCommon.maxRange=1/0}}}},{key:`calculateColDragRange`,value:function(){this.tableBlot&&(this.tableBlot.full?this.calculateColDragRangeByFull():this.calculateColDragRangeByFixed())}},{key:`updateTableCol`,value:function(){var e=h(P().mark(function e(t){var n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,x,S,C,w,T,E,D,O,k,A,j,M,N,ee,te,ne,I,L;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!this.tableBlot||this.colIndex===-1)){e.next=1;break}return e.abrupt(`return`);case 1:if(n=this.dragXCommon.limitRange(this.tableBlot,t,!0),r=this.tableBlot.getCols(),i=Hi(r,this.colIndex),a=n-i.left,Vi(this.tableBlot)&&(a=i.right-n),o=this.tableBlot.full,s=!1,c=[],o?(l=Z(this.tableBlot),u=l.rect,d=u.width,f=a/d*100,p=r[this.colIndex].width,f<p?(f=Math.max(z.colMinWidthPre,f),r[this.colIndex+1]||r[this.colIndex-1]?(m=r[this.colIndex+1]?this.colIndex+1:this.colIndex-1,c.push({index:m,width:r[m].width+p-f})):f=100,s=!0,c.push({index:this.colIndex,width:f})):r[this.colIndex+1]&&(h=p+r[this.colIndex+1].width,f=Math.min(h-z.colMinWidthPre,f),s=!0,c.push({index:this.colIndex,width:f},{index:this.colIndex+1,width:h-f}))):(this.tableBlot.domNode.style.width=`${Number.parseFloat(this.tableBlot.domNode.style.width)-r[this.colIndex].domNode.getBoundingClientRect().width+a}px`,s=!0,c.push({index:this.colIndex,width:a})),!s){e.next=13;break}if(g=this.tableBlot.domNode.getBoundingClientRect().width,!o){e.next=12;break}_=0,v=new Set(c.map(function(e){var t=e.index,n=e.width;return _+=n,t})),y=b(r.entries()),e.prev=2,y.s();case 3:if((x=y.n()).done){e.next=6;break}if(S=F(x.value,2),C=S[0],w=S[1],!v.has(C)){e.next=4;break}return e.abrupt(`continue`,5);case 4:_+=w.width;case 5:e.next=3;break;case 6:e.next=8;break;case 7:e.prev=7,L=e.catch(2),y.e(L);case 8:return e.prev=8,y.f(),e.finish(8);case 9:if(!(_>100)){e.next=12;break}return e.next=10,Re({message:this.tableModule.options.texts.perWidthInsufficient,confirm:this.tableModule.options.texts.confirmText,cancel:this.tableModule.options.texts.cancelText});case 10:if(e.sent){e.next=11;break}return e.abrupt(`return`);case 11:this.tableBlot.cancelFull(),o=!1,T=b(c.entries());try{for(T.s();!(E=T.n()).done;)D=F(E.value,2),O=D[0],k=D[1],A=k.width,j=k.index,c[O]={index:j,width:A/100*g}}catch(e){T.e(e)}finally{T.f()}case 12:M=b(c);try{for(M.s();!(N=M.n()).done;)ee=N.value,te=ee.index,ne=ee.width,I=Number.parseFloat(ne.toFixed(3)),r[te].width=`${I}${o?`%`:`px`}`}catch(e){M.e(e)}finally{M.f()}this.quill.emitter.emit(B.AFTER_TABLE_RESIZE);case 13:case`end`:return e.stop()}},e,this,[[2,7,8,9]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:`findDragRowIndex`,value:function(e){return-1}},{key:`calculateRowDragRange`,value:function(){if(this.tableBlot){var e=this.tableBlot.getRows();if(this.rowIndex=this.findDragRowIndex(e),this.rowIndex!==-1){var t=e[this.rowIndex].domNode.getBoundingClientRect();this.dragYCommon.minRange=t.y+z.rowMinHeightPx,this.dragYCommon.maxRange=1/0}}}},{key:`updateTableRow`,value:function(e){if(!(!this.tableBlot||this.rowIndex===-1)){var t=this.dragYCommon.limitRange(this.tableBlot,e,!0),n=this.tableBlot.getRows(),r=t-n[this.rowIndex].domNode.getBoundingClientRect().top;n[this.rowIndex].setHeight(`${r}px`),this.quill.emitter.emit(B.AFTER_TABLE_RESIZE)}}},{key:`removeBreak`,value:function(){this.dragXCommon.dragBreak&&(this.dragXCommon.dragBreak.remove(),this.dragXCommon.dragBreak=null),this.dragYCommon.dragBreak&&(this.dragYCommon.dragBreak.remove(),this.dragYCommon.dragBreak=null)}}])}(Jr),Gi=t.default.import(`delta`),Ki=function(e){function t(){var e;_(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=g(this,t,[].concat(r)),x(e,`minusY`,0),x(e,`minusX`,0),e}return w(t,e),y(t,[{key:`checkMinY`,value:function(e){return this.mouseY+this.minusY<e.top+this.scrollThresholdY}},{key:`checkMinX`,value:function(e){return this.mouseX+this.minusX<e.left+this.scrollThresholdX}}])}(fr),qi=function(){function e(t,n,r,i){_(this,e),x(this,`startPosition`,[]),x(this,`selectedIndex`,new Set),x(this,`moveToIndex`,-1),x(this,`tableModule`,void 0),x(this,`tableBlot`,void 0),x(this,`dragCommon`,void 0),x(this,`options`,void 0),this.tableModule=t,this.tableBlot=n,this.dragCommon=r,this.options=i}return y(e,[{key:`isDragX`,get:function(){return this.options.isDragX}},{key:`onStart`,value:function(e,t,n){var r=this.tableModule.getModule(V.tableSelectionName);if(!(r!=null&&r.boundary)||!this.tableBlot)return!1;var i=this.isCellSpan(r.selectedTds),a=i.isSpan,o=i.cellIndex;if(!a)return!1;var s=Z(this.tableBlot).rect;if(!s)return!1;t.preventDefault(),this.dragCommon.startValue=this.isDragX?s.x:s.y,this.selectedIndex=o,n==null||n(this),this.recalculateStartPosition()}},{key:`onMove`,value:function(e,t,n){this.moveToIndex=this.findTheMovedToIndex(t),n==null||n(this)}},{key:`onEnd`,value:function(e,t,n){n==null||n(this),this.moveToIndex=-1,this.selectedIndex=new Set}},{key:`recalculateStartPosition`,value:function(){if(this.isDragX){if(this.startPosition=[],!this.tableBlot)return;for(var e=this.tableBlot.getCols(),t=e[0].domNode.getBoundingClientRect().left,n=0;n<e.length;n++){var r=e[n].domNode.getBoundingClientRect();this.startPosition.push({size:r.width,position:t,index:n}),t+=r.width}}else{if(this.startPosition=[],!this.tableBlot)return;this.startPosition=this.tableBlot.getRows().map(function(e,t){var n=e.domNode.getBoundingClientRect();return{size:n.height,position:n.top,index:t}})}}},{key:`findTheMovedToIndex`,value:function(e){var t=this,n=this.dragCommon.getOffsetFromStart(this.tableBlot),r=this.startPosition.find(function(r){var i=r.position,a=r.size;return(t.isDragX?e.clientX:e.clientY)<i+a/2+n}),i=r==null?void 0:r.index;return(je(i)||i<0)&&(i=this.startPosition.length),i=Math.max(0,Math.min(i,this.startPosition.length)),this.selectedIndex.has(i)||this.options.allowMoveToIndex&&!this.options.allowMoveToIndex(i)?-1:i}},{key:`updateTableStructure`,value:function(e,t){var n=this,r=new Gi;if(!this.tableBlot||this.moveToIndex<0)return r;var i=this.tableModule.getModule(V.tableSelectionName);if(!i)return r;if(this.isDragX){var a=this.tableBlot.getCols(),o=a.length-1,s=this.moveToIndex>o,c=new Set(i.selectedTds.map(function(e){return e.colId})),l=a.filter(function(e){return c.has(e.colId)}).map(function(t){var n=t.length(),r=t.offset(t.scroll);return{offset:r,delta:e.slice(r,r+n),length:n}}),u=a[Math.min(o,this.moveToIndex)],d=u.offset(u.scroll)+(s?u.length():0),f=l.reduce(function(e,t){return e=e.concat(t.delta),e},new Gi().retain(d)),p=l.reduce(function(e,t,n){var r=l[n-1],i=r?r.offset+r.length:0;return e=e.retain(t.offset-i).delete(t.length),e},new Gi),m=t?p.compose(f):f.compose(p),h=i.selectedTds.map(function(t){var n=t.length(),r=t.offset(t.scroll);return{offset:r,delta:e.slice(r,r+n),length:n,rowId:t.rowId}}),g=h.reduce(function(e,n,r){var i=e.delta,a=e.insertDeltaInfo,o=h[r-1],s=o?o.offset+o.length:0,c=0;if(r!==0&&!t){var l;c=o.rowId===n.rowId?0:(l=a[o.rowId])==null?void 0:l.length()}return i=i.retain(n.offset-s+c).delete(n.length),a[n.rowId]||(a[n.rowId]=new Gi),a[n.rowId]=a[n.rowId].concat(n.delta),{delta:i,insertDeltaInfo:a}},{delta:new Gi,insertDeltaInfo:{}}),_=g.delta,v=g.insertDeltaInfo,y=this.tableBlot.getRows(),b=y.reduce(function(e,r,i){var a=e.delta,c=e.offset,l=r.getCellByColumIndex(Math.min(o,n.moveToIndex))[0];if(!l)return{delta:a,offset:c};var u=l.offset(l.scroll)+(s?l.length():0),d=u-c;if(i!==0&&t){var f=v[y[i-1].rowId];f&&(d-=f.length())}return a.retain(d),v[l.rowId]&&(a=a.concat(v[l.rowId])),{delta:a,offset:u}},{delta:new Gi,offset:0}).delta,x=t?_.compose(b):b.compose(_);r=m.compose(x)}else{var S=this.tableBlot.getRows(),C=S.length-1,w=this.moveToIndex>C,T=S[Math.min(C,this.moveToIndex)],E=Array.from(i.selectedTds.reduce(function(e,t){return e.add(t.getTableRow())},new Set)).filter(Boolean),D=0,O=E.reduce(function(e,t){var n=e.delta,r=e.start,i=e.end,a=t.offset(t.scroll),o=t.length();return n.retain(a-D).delete(o),D=a+o,{delta:n,start:Math.min(r,a),end:Math.max(i,a+o)}},{delta:new Gi,start:1/0,end:0}),k=O.delta,A=O.start,j=O.end,M=T.offset(T.scroll)+(w?T.length():0),N=new Gi().retain(M).concat(e.slice(A,j));r=t?k.compose(N):N.compose(k)}return r}},{key:`isCellSpan`,value:function(e){if(this.isDragX){var t,n=this.tableBlot.getCols().map(function(e){return e.colId}),r=new Set,i=new Map(n.map(function(e){return[e,0]})),a=new Set,o=b(e),s;try{for(o.s();!(s=o.n()).done;){var c=s.value;r.add(c.colId);var l=n.indexOf(c.colId);if(l!==-1){for(var u=l;u<l+c.colspan&&u<n.length;u++){a.add(u);var d=n[u];i.set(d,(i.get(d)||0)+c.rowspan)}a.add(Math.min(l+c.colspan,n.length))}}}catch(e){o.e(e)}finally{o.f()}var f=((t=this.tableBlot.getRows())==null?void 0:t.length)||0,p=b(i.entries()),m;try{for(p.s();!(m=p.n()).done;){var h=F(m.value,2),g=h[0];h[1]>=f&&r.delete(g)}}catch(e){p.e(e)}finally{p.f()}return{cellIndex:a,isSpan:r.size<=0}}else{var _,v=this.tableBlot.getRows().map(function(e){return e.rowId}),y=new Set,x=new Map(v.map(function(e){return[e,0]})),S=new Set,C=b(e),w;try{for(C.s();!(w=C.n()).done;){var T=w.value;y.add(T.rowId);var E=v.indexOf(T.rowId);if(E!==-1){for(var D=E;D<E+T.rowspan&&D<v.length;D++){S.add(D);var O=v[D];x.set(O,(x.get(O)||0)+T.colspan)}S.add(Math.min(E+T.rowspan,v.length))}}}catch(e){C.e(e)}finally{C.f()}var k=((_=this.tableBlot.getCols())==null?void 0:_.length)||0,A=b(x.entries()),j;try{for(A.s();!(j=A.n()).done;){var M=F(j.value,2),N=M[0];M[1]>=k&&y.delete(N)}}catch(e){A.e(e)}finally{A.f()}return{cellIndex:S,isSpan:y.size<=0}}}}])}(),Ji=function(e){function n(e,r,i){var a;return _(this,n),a=g(this,n,[e,r]),x(a,`tableModule`,void 0),x(a,`quill`,void 0),x(a,`options`,void 0),x(a,`root`,void 0),x(a,`tableWrapperBlot`,void 0),x(a,`resizeObserver`,void 0),x(a,`rowHeadWrapper`,null),x(a,`colHeadWrapper`,null),x(a,`corner`,null),x(a,`scrollHandler`,[]),x(a,`lastHeaderSelect`,null),x(a,`bem`,H(`resize-box`)),x(a,`draggingColIndex`,-1),x(a,`draggingRowIndex`,-1),x(a,`stopColDrag`,[]),x(a,`stopRowDrag`,[]),x(a,`dragWrapper`,null),x(a,`dragPlaceholder`,null),x(a,`markIndicator`,null),x(a,`stopColMoveDrag`,[]),x(a,`stopRowMoveDrag`,[]),x(a,`autoScroller`,null),x(a,`updateContentDraggingPosition`,void 0),x(a,`cellSpanIndex`,new Set),x(a,`updateWhenTextChange`,function(e){e===t.default.events.TEXT_CHANGE&&(a.table&&!a.quill.root.contains(a.table)?a.setSelectionTable(void 0):a.update())}),a.tableModule=e,a.quill=r,a.options=a.resolveOptions(i),a.updateContentDraggingPosition=function(){return a.updateContentDraggerPosition(null)},a.root=a.tableModule.addContainer(a.bem.b()),a.quill.on(t.default.events.EDITOR_CHANGE,a.updateWhenTextChange),a}return w(n,e),y(n,[{key:`resolveOptions`,value:function(e){return Object.assign({size:12,draggable:!0},e)}},{key:`setSelectionTable`,value:function(e){if(this.table!==e){if(this.hide(),this.table=e,this.table){var n=t.default.find(this.table);n&&(this.tableBlot=n,this.tableWrapperBlot=this.tableBlot.parent),this.show()}this.update()}}},{key:`handleResizerHeaderClick`,value:function(e,t,n){if(this.table){var r=n.clientX,i=n.clientY,a=this.table.getBoundingClientRect();n.shiftKey||(this.lastHeaderSelect=null);var o=[{x:e?a.left:r,y:e?i:a.top},{x:e?a.right:r,y:e?i:a.bottom}];if(this.lastHeaderSelect){var s,c;if(this.lastHeaderSelect.isX){var l=Array.from(this.root.getElementsByClassName(this.bem.be(`row-header`)))[this.lastHeaderSelect.index].getBoundingClientRect();s=Math.min(l.left,a.left),c=l.top+l.height/2}else{var u=Array.from(this.root.getElementsByClassName(this.bem.be(`col-header`)))[this.lastHeaderSelect.index].getBoundingClientRect();s=u.left+u.width/2,c=Math.min(u.top,a.top)}this.lastHeaderSelect.isX===e?e?(o[0].y=Math.min(o[0].y,c),o[1].y=Math.max(o[1].y,c)):(o[0].x=Math.min(o[0].x,s),o[1].x=Math.max(o[1].x,s)):(o[1]={x:Math.max(o[0].x,s),y:Math.max(o[0].y,c)},o[0]={x:Math.min(o[0].x,s),y:Math.min(o[0].y,c)})}else this.lastHeaderSelect={isX:e,index:t};var d=this.tableModule.getModule(V.tableSelectionName);d&&(d.table=this.table,d.setSelectedTds(d.computeSelectedTds.apply(d,o)),d.show())}}},{key:`findDragColIndex`,value:function(){return this.draggingColIndex}},{key:`findDragRowIndex`,value:function(){return this.draggingRowIndex}},{key:`updateContentDraggerPosition`,value:function(e){if(!(!e||!this.dragWrapper||!this.markIndicator||!this.tableBlot||!this.tableWrapperBlot)){var t=Z(this.tableBlot).rect;if(!(!t||e.moveToIndex<0)){var n=this.tableWrapperBlot.domNode.getBoundingClientRect(),r=this.quill.root.getBoundingClientRect();Object.assign(this.dragWrapper.style,{top:`${Math.max(t.y,n.y)-r.y}px`,left:`${Math.max(t.x,n.x)-r.x}px`});var i=(e.startPosition[e.moveToIndex]||{}).position,a=this.dragXCommon.getOffsetFromStart(this.tableBlot),o=this.dragYCommon.getOffsetFromStart(this.tableBlot),s=e.isDragX?{top:`${Math.max(t.y,n.y)-r.y}px`,left:`${i-r.left+a}px`}:{top:`${i-r.top+o}px`,left:`${Math.max(t.x,n.x)-r.x}px`};Object.assign(this.markIndicator.style,s)}}}},{key:`createContentDragger`,value:function(e,t,n){var r=this;if(this.tableBlot){var i=this.tableModule.getModule(V.tableSelectionName);if(!(!i||!this.tableWrapperBlot)){i.updateWithSelectedTds();var a=i.boundary.width,o=i.boundary.height,s=this.quill.root.getBoundingClientRect(),c=this.tableWrapperBlot.domNode.getBoundingClientRect(),l=H(`drag`);this.dragWrapper=this.tableModule.addContainer(l.b());var u=c.x-s.x,d=c.y-s.y;Object.assign(this.dragWrapper.style,{left:`${u}px`,top:`${d}px`,width:`${c.width}px`,height:`${c.height}px`}),this.dragPlaceholder=document.createElement(`div`),this.dragPlaceholder.classList.add(l.be(`placeholder`),l.is(`hidden`)),this.dragWrapper.appendChild(this.dragPlaceholder),Object.assign(this.dragPlaceholder.style,{left:`${t?i.boundary.x-u:0}px`,top:`${t?0:i.boundary.y-d}px`,width:`${a}px`,height:`${o}px`}),this.markIndicator=this.tableModule.addContainer(l.be(`indicator`));var f={};f=t?{top:`${d}px`,height:`${Math.min(i.boundary.height,c.height)}px`}:{left:`${u}px`,width:`${Math.min(i.boundary.width,c.width)}px`},Object.assign(this.markIndicator.style,f),this.updateContentDraggingPosition=function(){return r.updateContentDraggerPosition(n)},sr.call(this,this.quill.root,this.updateContentDraggingPosition),sr.call(this,this.tableWrapperBlot.domNode,this.updateContentDraggingPosition),t?(this.dragXCommon.minRange=0,this.dragXCommon.maxRange=c.width-a):(this.dragYCommon.minRange=0,this.dragYCommon.maxRange=c.height-o)}}}},{key:`bindColEvents`,value:function(){var e=this;if(this.tableWrapperBlot){var t=Array.from(this.root.getElementsByClassName(this.bem.be(`col-header`))),n=Array.from(this.root.getElementsByClassName(this.bem.be(`col-separator`)));if(sr.call(this,this.tableWrapperBlot.domNode,function(){e.colHeadWrapper.scrollLeft=e.tableWrapperBlot.domNode.scrollLeft}),this.stopColMoveDrag.length>0){var r=b(this.stopColMoveDrag),i;try{for(r.s();!(i=r.n()).done;){var a=i.value;a()}}catch(e){r.e(e)}finally{r.f()}this.stopColMoveDrag=[]}var o=new qi(this.tableModule,this.tableBlot,this.dragXCommon,{isDragX:!0,allowMoveToIndex:function(t){return e.allowMoveToIndex(t)}}),s=b(t.entries()),c;try{for(s.s();!(c=s.n()).done;){var l=F(c.value,2),u=l[0],d=l[1];if(d.addEventListener(`click`,this.handleResizerHeaderClick.bind(this,!1,u)),this.options.draggable){var f=tr(d,this.dragHeadOptions(!0,{index:u,dragHelper:o})).stop;this.stopColMoveDrag.push(f)}}}catch(e){s.e(e)}finally{s.f()}if(this.stopColDrag.length>0){var p=b(this.stopColDrag),m;try{for(p.s();!(m=p.n()).done;){var h=m.value;h()}}catch(e){p.e(e)}finally{p.f()}this.stopColDrag=[]}var g=b(n.entries()),_;try{var v=function(){var t=F(_.value,2),n=t[0],r=t[1],i=tr(r,{axis:`x`,onStart:function(t,r){if(e.dragging=!0,e.draggingColIndex=n,e.calculateColDragRange(),e.dragXCommon.createBreak(),e.tableBlot){var i=e.tableBlot.domNode.parentElement.getBoundingClientRect(),a=Z(e.tableBlot).rect;if(a){e.dragXCommon.startValue=a.x;var o=e.quill.root.getBoundingClientRect();Object.assign(e.dragXCommon.dragBreak.style,{top:`${Math.max(i.y,a.y)-o.y}px`,left:`${r.clientX-o.x}px`,height:`${Math.min(i.height,a.height)}px`})}}},onMove:function(t){var n=t.position;if(e.dragXCommon.dragBreak){var r=e.dragXCommon.limitRange(e.tableBlot,n.x,!0),i=e.quill.root.getBoundingClientRect();e.dragXCommon.dragBreak.style.left=`${r-i.x}px`}},onEnd:function(t){var n=t.position;e.dragging=!1,e.updateTableCol(n.x),e.removeBreak()}}).stop;e.stopColDrag.push(i),r.addEventListener(`dragstart`,function(e){return e.preventDefault()})};for(g.s();!(_=g.n()).done;)v()}catch(e){g.e(e)}finally{g.f()}}}},{key:`bindRowEvents`,value:function(){var e=this,t=Array.from(this.root.getElementsByClassName(this.bem.be(`row-header`))),n=Array.from(this.root.getElementsByClassName(this.bem.be(`row-separator`)));if(sr.call(this,this.tableWrapperBlot.domNode,function(){e.rowHeadWrapper.scrollTop=e.tableWrapperBlot.domNode.scrollTop}),this.stopRowMoveDrag.length>0){var r=b(this.stopRowMoveDrag),i;try{for(r.s();!(i=r.n()).done;){var a=i.value;a()}}catch(e){r.e(e)}finally{r.f()}this.stopRowMoveDrag=[]}var o=new qi(this.tableModule,this.tableBlot,this.dragYCommon,{isDragX:!1,allowMoveToIndex:function(t){return e.allowMoveToIndex(t)}}),s=b(t.entries()),c;try{for(s.s();!(c=s.n()).done;){var l=F(c.value,2),u=l[0],d=l[1],f=Number(d.dataset.index||u);if(d.addEventListener(`click`,this.handleResizerHeaderClick.bind(this,!0,u)),this.options.draggable){var p=tr(d,this.dragHeadOptions(!1,{index:f,dragHelper:o})).stop;this.stopRowMoveDrag.push(p)}}}catch(e){s.e(e)}finally{s.f()}if(this.stopRowDrag.length>0){var m=b(this.stopRowDrag),h;try{for(m.s();!(h=m.n()).done;){var g=h.value;g()}}catch(e){m.e(e)}finally{m.f()}this.stopRowDrag=[]}var _=b(n.entries()),v;try{var y=function(){var t=F(v.value,2),n=t[0],r=t[1],i=tr(r,{axis:`y`,onStart:function(t,r){if(e.dragging=!0,e.draggingRowIndex=n,e.calculateRowDragRange(),e.dragYCommon.createBreak(),e.tableBlot){var i=e.tableBlot.domNode.parentElement.getBoundingClientRect(),a=Z(e.tableBlot).rect;if(a){e.dragYCommon.startValue=a.y;var o=e.quill.root.getBoundingClientRect();Object.assign(e.dragYCommon.dragBreak.style,{top:`${r.clientY-o.y}px`,left:`${Math.max(i.x,a.x)-o.x}px`,width:`${Math.min(i.width,a.width)}px`})}}},onMove:function(t){var n=t.position;if(!(!e.dragYCommon.dragBreak||!e.table)){var r=e.dragYCommon.limitRange(e.tableBlot,n.y,!0),i=e.quill.root.getBoundingClientRect();e.dragYCommon.dragBreak.style.top=`${r-i.y}px`}},onEnd:function(t){var n=t.position;e.dragging=!1,e.updateTableRow(n.y),e.removeBreak()}}).stop;e.stopRowDrag.push(i),r.addEventListener(`dragstart`,function(e){return e.preventDefault()})};for(_.s();!(v=_.n()).done;)y()}catch(e){_.e(e)}finally{_.f()}}},{key:`allowMoveToIndex`,value:function(e){return!this.cellSpanIndex.has(e)}},{key:`recordCellSpan`,value:function(e){var t=new Set;if(!this.tableBlot)return t;var n=this.tableBlot.descendants(q),r=e?this.tableBlot.getColIds():this.tableBlot.getRowIds(),i=e?`colspan`:`rowspan`,a=b(n),o;try{for(a.s();!(o=a.n()).done;){var s=o.value;if(!(s[i]<=1)){var c=r.indexOf(e?s.colId:s.rowId);if(c!==-1)for(var l=c+1;l<c+s[i]&&l<r.length;l++)t.add(l)}}}catch(e){a.e(e)}finally{a.f()}return t}},{key:`dragHeadOptions`,value:function(e,t){var n=this,r=t.dragHelper,i=t.index;return{axis:e?`x`:`y`,onStart:function(t,a){var o=!1;return r.onStart(t,a,function(){o=new Set(Array.from(r.selectedIndex).slice(0,-1)).has(i),o!==!1&&(n.dragging=!0,e?n.draggingColIndex=i:n.draggingRowIndex=i,n.createContentDragger(a,e,r),n.cellSpanIndex=n.recordCellSpan(e),n.tableWrapperBlot&&(n.autoScroller=new Ki(50,40),n.autoScroller.minusY=n.options.size,n.autoScroller.minusX=n.options.size,n.autoScroller.updateMousePosition(a.clientX,a.clientY),n.autoScroller.start(n.tableWrapperBlot.domNode)))}),o},onMove:function(t,i){r.onMove(t,i,function(r){var a,o=t.position;if((a=n.autoScroller)==null||a.updateMousePosition(i.clientX,i.clientY),!(!n.dragPlaceholder||!n.markIndicator||!n.tableWrapperBlot)){n.dragPlaceholder.classList.remove(n.bem.is(`hidden`));var s=n.quill.root.getBoundingClientRect(),c=n.tableWrapperBlot.domNode.getBoundingClientRect(),l=r.dragCommon.limitRange(n.tableBlot,e?o.x-c.left:o.y-c.top,!1);if(n.dragPlaceholder.style[e?`left`:`top`]=`${l}px`,r.moveToIndex<0){Object.assign(n.markIndicator.style,{opacity:`0`});return}var u=r.moveToIndex>=r.startPosition.length,d=r.startPosition[u?r.moveToIndex-1:r.moveToIndex],f=d.position+(u?d.size:0),p=r.dragCommon.getOffsetFromStart(n.tableBlot);Object.assign(n.markIndicator.style,x({opacity:`1`},e?`left`:`top`,`${f-(e?s.left:s.top)+p}px`))}})},onEnd:function(t,i){r.onEnd(t,i,function(t){var r,i=t.updateTableStructure(n.quill.getContents(),(e?n.draggingColIndex:n.draggingRowIndex)>t.moveToIndex);n.quill.updateContents(i),n.dragging=!1,n.cellSpanIndex=new Set,(r=n.autoScroller)==null||r.stop(),cr.call(n,n.quill.root,n.updateContentDraggingPosition),cr.call(n,n.tableWrapperBlot.domNode,n.updateContentDraggingPosition),n.dragWrapper&&(n.dragWrapper.remove(),n.dragWrapper=null),n.markIndicator&&(n.markIndicator.remove(),n.markIndicator=null)})}}}},{key:`update`,value:function(){var e=this;if(!(!this.tableBlot||!this.tableWrapperBlot)){var t=Z(this.tableBlot).rect;if(t){this.root.innerHTML=``;var n=this.tableBlot.getCols(),r=this.tableBlot.getRows(),i=this.tableWrapperBlot.domNode.getBoundingClientRect(),a=this.quill.root.getBoundingClientRect();if(Object.assign(this.root.style,{top:`${Math.max(t.y,i.y)-a.y}px`,left:`${Math.max(t.x,i.x)-a.x}px`}),n.length>0&&r.length>0&&(this.corner=document.createElement(`div`),this.corner.classList.add(this.bem.be(`corner`)),Object.assign(this.corner.style,{width:`${this.options.size}px`,height:`${this.options.size}px`}),this.corner.addEventListener(`click`,function(){var t=e.tableModule.getModule(V.tableSelectionName);t&&e.tableBlot&&(t.setSelectedTds(e.tableBlot.descendants(q)),t.show(),t.updateWithSelectedTds())}),this.root.appendChild(this.corner)),n.length>0){var o=``,s=b(n),c;try{for(s.s();!(c=s.n()).done;){var l=c.value,u=l.domNode.getBoundingClientRect().width;u===0&&(u=Number.parseInt(l.domNode.getAttribute(`width`),10)),o+=`<div class="${this.bem.be(`col-header`)}" style="width: ${u}px">
          <div class="${this.bem.be(`col-separator`)}" style="height: ${t.height+this.options.size-3}px"></div>
        </div>`}}catch(e){s.e(e)}finally{s.f()}var d=document.createElement(`div`);d.classList.add(this.bem.be(`col`));var f=document.createElement(`div`);f.classList.add(this.bem.be(`col-wrapper`)),Object.assign(d.style,{transform:`translateY(-${this.options.size}px)`,maxWidth:`${i.width}px`,height:`${this.options.size}px`}),Object.assign(f.style,{width:`${t.width}px`}),f.innerHTML=o,d.appendChild(f),this.root.appendChild(d),d.scrollLeft=this.tableWrapperBlot.domNode.scrollLeft,this.colHeadWrapper=d,this.bindColEvents()}if(r.length>0){for(var p=``,m=0;m<r.length;m++){var h,g=m,_=r[m],v=_.domNode.getBoundingClientRect().height;if(_.children.length===1&&(((h=_.children.head)==null?void 0:h.emptyRow.length)||0)>0){for(var y=_.children.head.emptyRow.length,x=m+1;x<r.length&&x<=m+y;x++){var S=r[x];v+=S.domNode.getBoundingClientRect().height}m+=y}p+=`<div class="${this.bem.be(`row-header`)}" data-index="${g}" style="height: ${v}px">
          <div class="${this.bem.be(`row-separator`)}" style="width: ${t.width+this.options.size-3}px"></div>
        </div>`}var C=document.createElement(`div`);C.classList.add(this.bem.be(`row`));var w=document.createElement(`div`);w.classList.add(this.bem.be(`row-wrapper`)),Object.assign(C.style,{transform:`translateX(-${this.options.size}px)`,width:`${this.options.size}px`,maxHeight:`${i.height}px`}),Object.assign(w.style,{height:`${t.height}px`}),w.innerHTML=p,C.appendChild(w),this.root.appendChild(C),C.scrollTop=this.tableWrapperBlot.domNode.scrollTop,this.rowHeadWrapper=C,this.bindRowEvents()}var T=F(he(this.tableBlot,Vr),1)[0],E=!T||!(T&&T.side===`top`);E?this.root.classList.remove(this.bem.is(`caption-bottom`)):this.root.classList.add(this.bem.is(`caption-bottom`));var D=-1*this.options.size,O=-1*this.options.size;Vi(this.tableBlot)?(this.root.classList.add(this.bem.is(`align-right`)),D=Math.min(i.width,t.width),O=Math.min(i.width,t.width)):this.root.classList.remove(this.bem.is(`align-right`)),this.corner&&Object.assign(this.corner.style,{transform:`translateY(${-1*this.options.size}px) translateX(${D}px)`,top:`${E?0:t.height+this.options.size}px`}),this.rowHeadWrapper&&Object.assign(this.rowHeadWrapper.style,{transform:`translateX(${O}px)`,maxHeight:`${i.height}px`}),this.colHeadWrapper&&Object.assign(this.colHeadWrapper.style,{top:`${E?0:t.height+this.options.size}px`,maxWidth:`${i.width}px`})}}}},{key:`show`,value:function(){var e=this;!this.table||!this.tableBlot||(this.root.classList.remove(this.bem.is(`hidden`)),this.resizeObserver=or(function(){return e.update()},{ignoreFirstBind:!0}),this.resizeObserver.observe(this.table),this.update(),sr.call(this,this.quill.root,function(){e.update()}))}},{key:`hide`,value:function(){this.root.classList.add(this.bem.is(`hidden`)),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0)}},{key:`destroy`,value:function(){this.hide(),lr.call(this),this.quill.off(t.default.events.EDITOR_CHANGE,this.updateWhenTextChange);var e=b(this.scrollHandler),n;try{for(e.s();!(n=e.n()).done;){var r=F(n.value,2),i=r[0],a=r[1];i.removeEventListener(`scroll`,a)}}catch(t){e.e(t)}finally{e.f()}this.root.remove()}}])}(Wi);x(Ji,`moduleName`,`table-resize-box`);var Yi=function(e){function n(e,r){var i;return _(this,n),i=g(this,n,[e,r]),x(i,`tableModule`,void 0),x(i,`quill`,void 0),x(i,`colResizer`,void 0),x(i,`rowResizer`,void 0),x(i,`currentTableCell`,void 0),x(i,`tableCellBlot`,void 0),x(i,`bem`,H(`resize-line`)),x(i,`stopColDrag`,void 0),x(i,`stopRowDrag`,void 0),x(i,`updateWhenTextChange`,function(e){e===t.default.events.TEXT_CHANGE&&(i.table&&!i.quill.root.contains(i.table)?i.setSelectionTable(void 0):i.update())}),x(i,`pointermoveHandler`,function(e){if(!i.dragging){var n=i.tableModule.getModule(V.tableSelectionName);if(!(n!=null&&n.dragging)){var r=i.findTableCell(e);if(!r)return i.hide();var a=t.default.find(r);a&&i.currentTableCell!==r&&(i.show(),i.currentTableCell=r,i.tableCellBlot=a,i.tableBlot=U(a,R.tableMain),i.tableBlot.getCols().length>0&&i.updateColResizer(),i.updateRowResizer())}}}),i.tableModule=e,i.quill=r,i.colResizer=i.tableModule.addContainer(i.bem.be(`col`)),i.rowResizer=i.tableModule.addContainer(i.bem.be(`row`)),i.quill.on(t.default.events.EDITOR_CHANGE,i.updateWhenTextChange),i}return w(n,e),y(n,[{key:`findTableCell`,value:function(e){var t=b(e.composedPath()),n;try{for(t.s();!(n=t.n()).done;){var r=n.value;if(r instanceof HTMLElement&&[`TD`,`TH`].includes(r.tagName))return r;if(r===document.body)return null}}catch(e){t.e(e)}finally{t.f()}return null}},{key:`findDragColIndex`,value:function(e){var t=this;return this.tableCellBlot?e.findIndex(function(e){return e.colId===t.tableCellBlot.colId}):-1}},{key:`updateColResizer`,value:function(){var e=this;if(!(!this.tableBlot||!this.tableCellBlot||!this.colResizer)){this.colResizer.remove();var t=Z(this.tableBlot).rect;if(t){this.colResizer=this.tableModule.addContainer(this.bem.be(`col`));var n=this.tableCellBlot.domNode.getBoundingClientRect(),r=this.quill.root.getBoundingClientRect(),i=n.right-r.x;Vi(this.tableBlot)&&(i=n.left-r.x),Object.assign(this.colResizer.style,{top:`${t.y-r.y}px`,left:`${i}px`,height:`${t.height}px`});var a=tr(this.colResizer,{axis:`x`,onStart:function(t,n){if(e.dragging=!0,e.calculateColDragRange(),e.dragXCommon.createBreak(),e.tableBlot){var r=e.tableBlot.domNode.parentElement.getBoundingClientRect(),i=Z(e.tableBlot).rect;if(i){e.dragXCommon.startValue=i.x;var a=e.quill.root.getBoundingClientRect();Object.assign(e.dragXCommon.dragBreak.style,{top:`${Math.max(r.y,i.y)-a.y}px`,left:`${n.clientX-a.x}px`,height:`${Math.min(r.height,i.height)}px`})}}},onMove:function(t){var n=t.position;if(e.dragXCommon.dragBreak){var r=e.dragXCommon.limitRange(e.tableBlot,n.x,!0),i=e.quill.root.getBoundingClientRect();e.dragXCommon.dragBreak.style.left=`${r-i.x}px`}},onEnd:function(t){var n=t.position;e.dragging=!1,e.updateTableCol(n.x),e.removeBreak()}}).stop;this.stopColDrag&&this.stopColDrag(),this.stopColDrag=a,this.colResizer.addEventListener(`dragstart`,function(e){return e.preventDefault()})}}}},{key:`findDragRowIndex`,value:function(e){if(!this.tableCellBlot)return-1;var t=this.tableCellBlot.parent;return t instanceof J?e.indexOf(t):-1}},{key:`updateRowResizer`,value:function(){var e=this;if(!(!this.tableBlot||!this.tableCellBlot||!this.rowResizer)){var t=this.tableCellBlot;this.rowResizer.remove();var n=Z(this.tableBlot).rect;if(n){this.rowResizer=this.tableModule.addContainer(this.bem.be(`row`));var r=t.domNode.getBoundingClientRect(),i=this.quill.root.getBoundingClientRect();Object.assign(this.rowResizer.style,{top:`${r.bottom-i.y}px`,left:`${n.x-i.x}px`,width:`${n.width}px`});var a=tr(this.rowResizer,{axis:`y`,onStart:function(t,n){if(e.dragging=!0,e.calculateRowDragRange(),e.dragYCommon.createBreak(),e.tableBlot){var r=e.tableBlot.domNode.parentElement.getBoundingClientRect(),i=Z(e.tableBlot).rect;if(i){e.dragYCommon.startValue=i.y;var a=e.quill.root.getBoundingClientRect();Object.assign(e.dragYCommon.dragBreak.style,{top:`${n.clientY-a.y}px`,left:`${Math.max(r.x,i.x)-a.x}px`,width:`${Math.min(r.width,i.width)}px`})}}},onMove:function(t){var n=t.position;if(!(!e.dragYCommon.dragBreak||!e.table)){var r=e.dragYCommon.limitRange(e.tableBlot,n.y,!0),i=e.quill.root.getBoundingClientRect();e.dragYCommon.dragBreak.style.top=`${r-i.y}px`}},onEnd:function(t){var n=t.position;e.dragging=!1,e.updateTableRow(n.y),e.removeBreak()}}).stop;this.stopRowDrag&&this.stopRowDrag(),this.stopRowDrag=a,this.rowResizer.addEventListener(`dragstart`,function(e){return e.preventDefault()})}}}},{key:`show`,value:function(){!this.table||!this.rowResizer||!this.colResizer||(this.rowResizer.classList.remove(this.bem.is(`hidden`)),this.colResizer.classList.remove(this.bem.is(`hidden`)),this.table.addEventListener(`pointermove`,this.pointermoveHandler))}},{key:`hide`,value:function(){this.currentTableCell=void 0,!(!this.rowResizer||!this.colResizer)&&(this.rowResizer.classList.add(this.bem.is(`hidden`)),this.colResizer.classList.add(this.bem.is(`hidden`)),this.table&&this.table.removeEventListener(`pointermove`,this.pointermoveHandler))}},{key:`update`,value:function(){this.updateColResizer(),this.updateRowResizer()}},{key:`destroy`,value:function(){this.colResizer&&(this.colResizer.remove(),this.colResizer=void 0),this.rowResizer&&(this.rowResizer.remove(),this.rowResizer=void 0),this.quill.off(t.default.events.EDITOR_CHANGE,this.updateWhenTextChange)}}])}(Wi);x(Yi,`moduleName`,`table-resize-line`);var Xi=function(e){function n(e,r,i){var a;return _(this,n),a=g(this,n,[e,r]),x(a,`tableModule`,void 0),x(a,`quill`,void 0),x(a,`scrollHandler`,[]),x(a,`tableMainBlot`,void 0),x(a,`tableWrapperBlot`,void 0),x(a,`bem`,H(`scale`)),x(a,`startX`,0),x(a,`startY`,0),x(a,`offset`,6),x(a,`options`,void 0),x(a,`root`,void 0),x(a,`block`,void 0),x(a,`resizeobserver`,new ResizeObserver(function(){return a.update()})),x(a,`updateWhenTextChange`,function(e){e===t.default.events.TEXT_CHANGE&&(a.table&&!a.quill.root.contains(a.table)?a.setSelectionTable(void 0):a.update())}),a.tableModule=e,a.quill=r,a.options=a.resolveOptions(i),a.quill.on(t.default.events.EDITOR_CHANGE,a.updateWhenTextChange),a}return w(n,e),y(n,[{key:`resolveOptions`,value:function(e){return Object.assign({blockSize:12},e)}},{key:`buildResizer`,value:function(){var e=this;if(!(!this.tableMainBlot||!this.tableWrapperBlot)){this.root=this.tableModule.addContainer(this.bem.b()),this.block=document.createElement(`div`),this.block.classList.add(this.bem.be(`block`)),Object.assign(this.block.style,{width:`${this.options.blockSize}px`,height:`${this.options.blockSize}px`}),this.root.appendChild(this.block);var t=[],n=[],r=function(r){if(e.tableMainBlot){var i=Vi(e.tableMainBlot)?-1:1,a=(r.clientX-e.startX)*i,o=r.clientY-e.startY,s=Math.floor(a/t.length),c=Math.floor(o/n.length),l=b(t),u;try{for(l.s();!(u=l.n()).done;){var d=u.value,f=d.blot,p=d.width;f.width=Math.max(p+s,z.colMinWidthPx)}}catch(e){l.e(e)}finally{l.f()}var m=b(n),h;try{for(m.s();!(h=m.n()).done;){var g=h.value,_=g.blot,v=g.height;_.setHeight(`${Math.max(v+c,z.rowMinHeightPx)}px`)}}catch(e){m.e(e)}finally{m.f()}}},i=function(){t=[],n=[],document.removeEventListener(`mousemove`,r),document.removeEventListener(`mouseup`,i)};this.block.addEventListener(`mousedown`,function(a){!e.tableMainBlot||e.isTableOutofEditor()||(e.startX=a.clientX,e.startY=a.clientY,t=e.tableMainBlot.getCols().map(function(e){return{blot:e,width:Math.floor(e.width)}}),n=e.tableMainBlot.getRows().map(function(e){return{blot:e,height:Math.floor(e.domNode.getBoundingClientRect().height)}}),document.addEventListener(`mousemove`,r),document.addEventListener(`mouseup`,i))}),this.block.addEventListener(`dragstart`,function(e){return e.preventDefault()})}}},{key:`isTableOutofEditor`,value:function(){if(!this.tableMainBlot||!this.tableWrapperBlot||this.tableMainBlot.full)return!1;var e=this.tableMainBlot.domNode.getBoundingClientRect(),t=this.tableWrapperBlot.domNode.getBoundingClientRect();if(e.width>t.width){var n=b(this.tableMainBlot.getCols()),r;try{for(n.s();!(r=n.n()).done;){var i=r.value;i.width=Math.floor(i.width/e.width*t.width)}}catch(e){n.e(e)}finally{n.f()}return this.tableMainBlot.colWidthFillTable(),!0}return!1}},{key:`update`,value:function(){if(!(!this.block||!this.root||!this.tableMainBlot||!this.tableWrapperBlot)){if(this.tableMainBlot.full){this.hide();return}var e=Z(this.tableMainBlot).rect;if(e){var t=this.tableWrapperBlot.domNode.getBoundingClientRect(),n=this.quill.root.getBoundingClientRect(),r=this.tableWrapperBlot.domNode,i=r.scrollTop,a=r.scrollLeft,o=this.options.blockSize*2+this.offset,s=Math.min(e.width,t.width)+o,c=Math.min(e.height,t.height)+o;Object.assign(this.root.style,{width:`${s}px`,height:`${c}px`,left:`${Math.max(e.x,t.x)-n.x-this.options.blockSize}px`,top:`${Math.max(e.y,t.y)-n.y-this.options.blockSize}px`});var l={left:`${e.width+o-a}px`,top:`${c-i}px`};Vi(this.tableMainBlot)?(this.root.classList.add(this.bem.is(`align-right`)),l.left=`${this.options.blockSize+-1*a}px`):this.root.classList.remove(this.bem.is(`align-right`)),Object.assign(this.block.style,l)}}}},{key:`show`,value:function(){var e=this;this.table&&(this.tableMainBlot=t.default.find(this.table),this.tableMainBlot&&!this.tableMainBlot.full&&(this.tableWrapperBlot=this.tableMainBlot.parent,this.resizeobserver.observe(this.tableMainBlot.domNode),sr.call(this,this.quill.root,function(){return e.update()})),this.buildResizer())}},{key:`hide`,value:function(){this.tableMainBlot=void 0,this.tableWrapperBlot=void 0,this.root&&(this.root.remove(),this.root=void 0,this.block=void 0)}},{key:`destroy`,value:function(){this.hide(),this.quill.off(t.default.events.TEXT_CHANGE,this.updateWhenTextChange),this.resizeobserver.disconnect(),lr.call(this)}}])}(Jr);x(Xi,`moduleName`,`table-resize-scale`);var Zi=function(){function e(n,r,i){var a=this;_(this,e),x(this,`quill`,void 0),x(this,`table`,void 0),x(this,`options`,void 0),x(this,`minSize`,20),x(this,`gap`,4),x(this,`move`,0),x(this,`cursorDown`,!1),x(this,`cursorLeave`,!1),x(this,`ratioY`,1),x(this,`ratioX`,1),x(this,`sizeWidth`,``),x(this,`sizeHeight`,``),x(this,`size`,``),x(this,`thumbState`,{X:0,Y:0}),x(this,`ob`,void 0),x(this,`container`,void 0),x(this,`scrollbar`,void 0),x(this,`thumb`,document.createElement(`div`)),x(this,`scrollHandler`,[]),x(this,`propertyMap`,void 0),x(this,`bem`,H(`scrollbar`)),x(this,`tableMainBlot`,void 0),x(this,`showScrollbar`,vr(function(){a.cursorLeave=!1,a.scrollbar.removeEventListener(`transitionend`,a.hideScrollbarTransitionend),a.scrollbar.style.display=a.size?`block`:`none`,requestAnimationFrame(function(){a.scrollbar.classList.remove(a.bem.is(`transparent`))})},200)),x(this,`hideScrollbar`,vr(function(){a.cursorLeave=!0,!a.cursorDown&&(a.scrollbar.removeEventListener(`transitionend`,a.hideScrollbarTransitionend),a.scrollbar.addEventListener(`transitionend`,a.hideScrollbarTransitionend,{once:!0}),a.scrollbar.classList.add(a.bem.is(`transparent`)))},200)),x(this,`hideScrollbarTransitionend`,function(){a.scrollbar.style.display=a.cursorDown&&a.size?`block`:`none`}),this.quill=n,this.table=r,this.options=i,this.tableMainBlot=t.default.find(this.table),this.container=r.parentElement,this.propertyMap=this.isVertical?{size:`height`,offset:`offsetHeight`,scrollDirection:`scrollTop`,scrollSize:`scrollHeight`,axis:`Y`,direction:`top`,client:`clientY`}:{size:`width`,offset:`offsetWidth`,scrollDirection:`scrollLeft`,scrollSize:`scrollWidth`,axis:`X`,direction:`left`,client:`clientX`},this.calculateSize(),this.ob=new ResizeObserver(function(){return a.update()}),this.ob.observe(r),this.scrollbar=this.createScrollbar(),this.setScrollbarPosition(),sr.call(this,this.quill.root,function(){return a.setScrollbarPosition()}),this.showScrollbar()}return y(e,[{key:`isVertical`,get:function(){return this.options.isVertical}},{key:`update`,value:function(){this.calculateSize(),this.setScrollbarPosition()}},{key:`setScrollbarPosition`,value:function(){var e=Z(this.tableMainBlot),t=e.rect,n=e.head,r=e.body,i=e.foot,a=n||r||i;if(!(!a||!t)){var o=this.quill.root,s=o.scrollLeft,c=o.scrollTop,l=o.offsetLeft,u=o.offsetTop,d=this.container,f=d.offsetLeft,p=d.offsetTop,m=a.domNode,h=m.offsetLeft,g=m.offsetTop,_=this.container.getBoundingClientRect(),v=_.width,y=_.height,b=f+h-l,S=p+g-u;this.isVertical?b+=Math.min(v,t.width):S+=Math.min(y,t.height),this.tableMainBlot&&this.tableMainBlot.align!==`left`&&(b+=this.table.offsetLeft-f),Object.assign(this.scrollbar.style,x(x({},this.propertyMap.size,`${this.isVertical?Math.min(y,t.height):v}px`),`transform`,`translate(${b-s}px, ${S-c}px)`)),this.containerScrollHandler(this.container)}}},{key:`calculateSize`,value:function(){var e=this.container.offsetHeight-this.gap,t=this.container.offsetWidth-this.gap,n=Math.pow(e,2)/this.container.scrollHeight,r=Math.pow(t,2)/this.container.scrollWidth,i=Math.max(n,this.minSize),a=Math.max(r,this.minSize);this.ratioY=n/(e-n)/(i/(e-i)),this.ratioX=r/(t-r)/(a/(t-a)),this.sizeWidth=a+this.gap<t?`${a}px`:``,this.sizeHeight=i+this.gap<e?`${i}px`:``,this.size=this.isVertical?this.sizeHeight:this.sizeWidth}},{key:`createScrollbar`,value:function(){var e=this,t=document.createElement(`div`);t.classList.add(this.bem.b(),this.isVertical?this.bem.is(`vertical`):this.bem.is(`horizontal`),this.bem.is(`transparent`)),Object.assign(t.style,{display:`none`}),this.thumb.classList.add(this.bem.be(`thumb`));var n=null,r=function(t){if(e.cursorDown!==!1){var n=e.thumbState[e.propertyMap.axis];if(n){var r=Math.pow(e.scrollbar[e.propertyMap.offset],2)/e.container[e.propertyMap.scrollSize]/(e.isVertical?e.ratioY:e.ratioX)/e.thumb[e.propertyMap.offset],i=((e.scrollbar.getBoundingClientRect()[e.propertyMap.direction]-t[e.propertyMap.client])*-1-(e.thumb[e.propertyMap.offset]-n))*100*r/e.scrollbar[e.propertyMap.offset];e.container[e.propertyMap.scrollDirection]=i*e.container[e.propertyMap.scrollSize]/100}}},i=function(){e.thumbState[e.propertyMap.axis]=0,e.cursorDown=!1,document.removeEventListener(`mousemove`,r),document.removeEventListener(`mouseup`,i),e.cursorLeave&&e.hideScrollbar(),document.onselectstart=n},a=function(t){t.stopImmediatePropagation(),e.cursorDown=!0,document.addEventListener(`mousemove`,r),document.addEventListener(`mouseup`,i),n=document.onselectstart,document.onselectstart=function(){return!1}};this.thumb.addEventListener(`mousedown`,function(t){var n;if(t.stopPropagation(),!(t.ctrlKey||[1,2].includes(t.button))){(n=window.getSelection())==null||n.removeAllRanges(),a(t);var r=t.currentTarget;r&&(e.thumbState[e.propertyMap.axis]=r[e.propertyMap.offset]-(t[e.propertyMap.client]-r.getBoundingClientRect()[e.propertyMap.direction]))}});for(var o=[this.table,t],s=0,c=o;s<c.length;s++){var l=c[s];l.addEventListener(`mouseenter`,this.showScrollbar),l.addEventListener(`mouseleave`,this.hideScrollbar)}return sr.call(this,this.container,function(){e.containerScrollHandler(e.container)}),t.appendChild(this.thumb),t}},{key:`containerScrollHandler`,value:function(e){var t=e[this.propertyMap.offset]-this.gap;this.move=e[this.propertyMap.scrollDirection]*100/t*(this.isVertical?this.ratioY:this.ratioX),Object.assign(this.thumb.style,x(x({},this.propertyMap.size,this.size),`transform`,`translate${this.propertyMap.axis}(${this.move}%)`))}},{key:`destroy`,value:function(){this.ob.disconnect(),lr.call(this),this.table.removeEventListener(`mouseenter`,this.showScrollbar),this.table.removeEventListener(`mouseleave`,this.hideScrollbar)}}])}(),Qi=function(e){function n(e,r,i){var a;_(this,n),a=g(this,n,[e,r]),x(a,`tableModule`,void 0),x(a,`quill`,void 0),x(a,`scrollbarContainer`,void 0),x(a,`scrollbar`,[]),x(a,`bem`,H(`scrollbar`)),x(a,`updateWhenTextChange`,function(e){e===t.default.events.TEXT_CHANGE&&(a.table&&!a.quill.root.contains(a.table)?a.setSelectionTable(void 0):a.update())}),a.tableModule=e,a.quill=r;var o=H(`scrollbar`);return a.quill.container.classList.add(o.bm(`virtual`)),a.scrollbarContainer=a.tableModule.addContainer(a.bem.be(`container`)),a.quill.on(t.default.events.EDITOR_CHANGE,a.updateWhenTextChange),a}return w(n,e),y(n,[{key:`hide`,value:function(){var e=b(this.scrollbar),t;try{for(e.s();!(t=e.n()).done;)t.value.destroy()}catch(t){e.e(t)}finally{e.f()}this.scrollbar=[],this.scrollbarContainer.innerHTML=``}},{key:`show`,value:function(){if(this.table){this.scrollbar=[new Zi(this.quill,this.table,{isVertical:!0}),new Zi(this.quill,this.table,{isVertical:!1})];var e=b(this.scrollbar),t;try{for(e.s();!(t=e.n()).done;){var n=t.value;this.scrollbarContainer.appendChild(n.scrollbar),n.showScrollbar()}}catch(t){e.e(t)}finally{e.f()}}}},{key:`update`,value:function(){if(this.table){this.scrollbar.length<=0&&this.show();var e=b(this.scrollbar),t;try{for(e.s();!(t=e.n()).done;){var n=t.value;n.calculateSize(),n.setScrollbarPosition()}}catch(t){e.e(t)}finally{e.f()}}else this.scrollbar.length>0&&this.hide()}},{key:`destroy`,value:function(){this.hide(),this.scrollbarContainer.remove(),this.quill.off(t.default.events.TEXT_CHANGE,this.updateWhenTextChange)}}])}(Jr);x(Qi,`moduleName`,`table-scrollbar`);var $i=0,ea=function(e){function n(e,r){var i,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return _(this,n),i=g(this,n,[e,r]),x(i,`tableModule`,void 0),x(i,`quill`,void 0),x(i,`options`,void 0),x(i,`boundary`,null),x(i,`scrollRecordEls`,[]),x(i,`startScrollRecordPosition`,[]),x(i,`selectedTableScrollX`,0),x(i,`selectedTableScrollY`,0),x(i,`selectedEditorScrollX`,0),x(i,`selectedEditorScrollY`,0),x(i,`selectedTds`,[]),x(i,`cellSelectWrap`,void 0),x(i,`cellSelect`,void 0),x(i,`scrollHandler`,[]),x(i,`resizeObserver`,void 0),x(i,`isDisplaySelection`,!1),x(i,`bem`,H(`selection`)),x(i,`lastSelection`,{anchorNode:null,anchorOffset:0,focusNode:null,focusOffset:0}),x(i,`_dragging`,!1),x(i,`handlePaste`,function(e){if(!(!(document.activeElement&&i.quill.root.contains(document.activeElement))||i.quill.getSelection())){var t=e.clipboardData;if(t){e.preventDefault();var n=i.selectedTds;if(!(n.length<=0)){var r=t.getData(`text/html`),a=i.quill.clipboard.convert({html:r}).ops.filter(function(e){return e.attributes&&e.attributes[R.tableCellInner]});a.length!==0&&Zr({quill:i.quill,talbeModule:i.tableModule},n,a)}}}}),x(i,`keyboardHandler`,function(){var e=h(P().mark(function e(t){var n;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ctrlKey){e.next=4;break}n=t.key,e.next=n===`c`||n===`x`?1:3;break;case 1:return e.next=2,Pi(i.tableModule,i.selectedTds,t.key===`x`);case 2:return e.abrupt(`continue`,3);case 3:e.next=5;break;case 4:(t.key===`Backspace`||t.key===`Delete`)&&i.removeCellBySelectedTds();case 5:case`end`:return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),x(i,`updateWhenTextChange`,function(e){e===t.default.events.TEXT_CHANGE&&(i.table&&!i.quill.root.contains(i.table)?i.setSelectionTable(void 0):i.updateAfterEvent())}),x(i,`updateAfterEvent`,function(){for(var e=0;e<i.selectedTds.length;e++)if(!i.selectedTds[e].domNode.isConnected){i.selectedTds=[];break}i.updateWithSelectedTds()}),x(i,`quillSelectionChangeHandler`,function(e,n,r){if(r!==t.default.sources.API&&e&&!i.quill.composition.isComposing&&i.selectedTds.length>0){var a=i.quill.getFormat(e),o=F(i.quill.getLine(e.index),1)[0],s=!!a[R.tableCellInner]&&!!o,c=o&&i.selectedTds.some(function(e){return e.domNode.contains(o.domNode)});if(s&&!c)try{var l=U(o,R.tableCellInner);i.setSelectedTds([l]),i.updateWithSelectedTds()}catch(e){}else s&&c||i.hide()}}),i.tableModule=e,i.quill=r,i.options=i.resolveOptions(a),i.scrollRecordEls=[i.quill.root,document.documentElement],i.cellSelectWrap=e.addContainer(i.bem.b()),i.cellSelect=i.helpLinesInitial(),i.resizeObserver=or(i.updateAfterEvent,{ignoreFirstBind:!0}),i.resizeObserver.observe(i.quill.root),document.addEventListener(`paste`,i.handlePaste),i.quill.emitter.listenDOM(`selectionchange`,document,i.selectionChangeHandler.bind(i)),i.quill.on(B.AFTER_TABLE_RESIZE,i.updateAfterEvent),i.quill.on(t.default.events.SELECTION_CHANGE,i.quillSelectionChangeHandler),i.quill.on(t.default.events.EDITOR_CHANGE,i.updateWhenTextChange),i.hide(),i}return w(n,e),y(n,[{key:`dragging`,get:function(){return this._dragging},set:function(e){this._dragging!==e&&(this._dragging=e,this.quill.emitter.emit(e?B.TABLE_SELECTION_DRAG_START:B.TABLE_SELECTION_DRAG_END,this))}},{key:`removeCellBySelectedTds`,value:function(){var e=this.quill.getSelection(),n=document.activeElement;if(!(e||!this.quill.root.contains(n))){if(this.table){var r=t.default.find(this.table),i=r.descendants(q);if(this.selectedTds.length===i.length){r.remove();return}}var a=b(this.selectedTds),o;try{for(a.s();!(o=a.n()).done;){var s=o.value,c=s.clone();c.appendChild(s.scroll.create(`block`)),s.parent.insertBefore(c,s),s.remove()}}catch(e){a.e(e)}finally{a.f()}}}},{key:`setSelectedTds`,value:function(e){var t=new Set(this.selectedTds),n=this.selectedTds.length===e.length&&e.every(function(e){return t.has(e)});this.selectedTds=e,n||this.quill.emitter.emit(B.TABLE_SELECTION_CHANGE,this,this.selectedTds)}},{key:`setSelectionData`,value:function(e,t){var n=t.anchorNode,r=t.anchorOffset,i=t.focusNode,a=t.focusOffset;if(!(!n||!i)){var o=document.createRange(),s=this.selectionDirectionUp(t);s?(o.setStart(n,r),o.setEnd(n,r)):(o.setStart(n,r),o.setEnd(i,a)),e.removeAllRanges(),e.addRange(o),s&&e.extend(i,a)}}},{key:`selectionDirectionUp`,value:function(e){var t=e.anchorNode,n=e.anchorOffset,r=e.focusNode,i=e.focusOffset;if(!t||!r)return!1;if(t===r)return n>i;var a=t.compareDocumentPosition(r);return a&Node.DOCUMENT_POSITION_CONTAINS||a&Node.DOCUMENT_POSITION_CONTAINED_BY?(a&Node.DOCUMENT_POSITION_FOLLOWING)!==0:(a&Node.DOCUMENT_POSITION_PRECEDING)!==0}},{key:`resolveOptions`,value:function(e){return Object.assign({selectColor:`#0589f340`},e)}},{key:`selectionChangeHandler`,value:function(){var e=window.getSelection();if(e){var n=e.anchorNode,r=e.focusNode,i=e.anchorOffset,a=e.focusOffset;if(!(!n||!r)){var o=t.default.find(n),s=t.default.find(r);if(!(!o||!s||o.scroll!==this.quill.scroll||s.scroll!==this.quill.scroll)){var c=me(o),l=me(s),u=c.has(R.tableColgroup),d=l.has(R.tableColgroup);if(u||d){var f=n,p=i,m=r,h=a;if(u){var g=c.get(R.tableWrapper).descendants(q);g.length>0&&(f=g[0].domNode,p=0)}if(d){var _=l.get(R.tableWrapper).descendants(q);_.length>0&&(m=_[0].domNode,h=0)}this.setSelectionData(e,{anchorNode:f,anchorOffset:p,focusNode:m,focusOffset:h});return}var v=c.has(R.tableCellInner),y=l.has(R.tableCellInner),b=v&&y;if(b){var x=c.get(R.tableCellInner),S=l.get(R.tableCellInner);b&&(b=x!==S)}if(v&&y&&b||!v&&y||!y&&v){this.setSelectionData(e,this.lastSelection),this.selectedTds.length>0&&this.hide();return}this.lastSelection={anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:a}}}}}},{key:`helpLinesInitial`,value:function(){this.cellSelectWrap.style.setProperty(`--select-color`,this.options.selectColor);var e=document.createElement(`div`);return e.classList.add(this.bem.be(`line`)),this.cellSelectWrap.appendChild(e),e}},{key:`computeSelectedTds`,value:function(e,n){if(!this.table)return[];var r=t.default.find(this.table);if(!r)return[];var i=new Set(r.descendants(Y).map(function(e,t){return e.index=t,e})),a=this.getScrollPositionDiff(),o=Z(r).rect;if(!o)return[];for(var s=e.x+a.x,c=e.y+a.y,l={x:Math.max(o.left,Math.min(n.x,s)),y:Math.max(o.top,Math.min(n.y,c)),x1:Math.min(o.right,Math.max(n.x,s)),y1:Math.min(o.bottom,Math.max(n.y,c))},u=new Set,d=!0;d;){d=!1;var f=b(i),p;try{for(f.s();!(p=f.n()).done;){var m=p.value;m.__rect||(m.__rect=m.domNode.getBoundingClientRect());var h=m.__rect,g=h.x,_=h.y,v=h.right,y=h.bottom;if(nr({x:Math.floor(l.x),y:Math.floor(l.y),x1:Math.floor(l.x1),y1:Math.floor(l.y1)},{x:Math.floor(g),y:Math.floor(_),x1:Math.floor(v),y1:Math.floor(y)},$i,u.size===0)){u.add(m),i.delete(m),l={x:Math.min(l.x,g),y:Math.min(l.y,_),x1:Math.max(l.x1,v),y1:Math.max(l.y1,y)},d=!0;break}}}catch(e){f.e(e)}finally{f.f()}}for(var x=0,S=[].concat(L(u),L(i));x<S.length;x++){var C=S[x];delete C.__rect}return this.boundary=rr(j(j({},l),{},{width:l.x1-l.x,height:l.y1-l.y}),this.quill.root),Array.from(u).toSorted(function(e,t){return e.index-t.index}).map(function(e){return delete e.index,e.getCellInner()})}},{key:`getScrollPositionDiff`,value:function(){var e=this,t=this.getTableViewScroll(),n=t.x,r=t.y,i=ur(this.quill.root),a=i.x,o=i.y;return this.selectedTableScrollX=n,this.selectedTableScrollY=r,this.selectedEditorScrollX=a,this.selectedEditorScrollY=o,this.startScrollRecordPosition.reduce(function(t,n,r){var i=n.x,a=n.y,o=ur(e.scrollRecordEls[r]),s=o.x,c=o.y;return t.x+=i-s,t.y+=a-c,t},{x:0,y:0})}},{key:`recordScrollPosition`,value:function(){this.clearRecordScrollPosition();var e=b(this.scrollRecordEls),t;try{for(e.s();!(t=e.n()).done;){var n=t.value;this.startScrollRecordPosition.push(ur(n))}}catch(t){e.e(t)}finally{e.f()}}},{key:`clearRecordScrollPosition`,value:function(){this.startScrollRecordPosition=[]}},{key:`tableSelectHandler`,value:function(e){var t=this,n=e.button,r=e.target,i=e.clientX,a=e.clientY,o=r.closest(`table`),s=r.closest(`caption`);if(!(n!==0||!o||s)){this.setSelectionTable(o);var c=o.dataset.tableId,l={x:i,y:a};this.recordScrollPosition(),this.setSelectedTds(this.computeSelectedTds(l,l)),this.show();var u=function(e){t.dragging=!0;var n=e.button,r=e.target,i=e.clientX,a=e.clientY,o=r.closest(`.ql-table`),s=r.closest(`caption`);if(!(n!==0||s||!o||o.dataset.tableId!==c)){var u={x:i,y:a};t.setSelectedTds(t.computeSelectedTds(l,u)),t.selectedTds.length>1&&t.quill.blur(),t.update()}},d=function(){document.body.removeEventListener(`mousemove`,u,!1),document.body.removeEventListener(`mouseup`,d,!1),t.dragging=!1,t.clearRecordScrollPosition()};document.body.addEventListener(`mousemove`,u,!1),document.body.addEventListener(`mouseup`,d,!1)}}},{key:`updateWithSelectedTds`,value:function(){if(this.selectedTds.length<=0){this.hide();return}var e={x:1/0,y:1/0},t={x:-1/0,y:-1/0},n=b(this.selectedTds),r;try{for(n.s();!(r=n.n()).done;){var i=r.value.domNode.getBoundingClientRect();e.x=Math.min(e.x,i.left),e.y=Math.min(e.y,i.top),t.x=Math.max(t.x,i.right),t.y=Math.max(t.y,i.bottom)}}catch(e){n.e(e)}finally{n.f()}this.setSelectedTds(this.computeSelectedTds(e,t)),this.selectedTds.length>0?this.update():this.hide()}},{key:`update`,value:function(){if(!this.table){this.hide();return}if(!(this.selectedTds.length===0||!this.boundary)){var e=ur(this.quill.root),t=e.x,n=e.y,r=this.getTableViewScroll(),i=r.x,a=r.y,o=this.table.parentElement.getBoundingClientRect(),s=this.quill.root.getBoundingClientRect(),c=o.x-s.x,l=o.y-s.y;Object.assign(this.cellSelect.style,{left:`${this.selectedEditorScrollX*2-t+this.boundary.x+this.selectedTableScrollX-i-c}px`,top:`${this.selectedEditorScrollY*2-n+this.boundary.y+this.selectedTableScrollY-a-l}px`,width:`${this.boundary.width}px`,height:`${this.boundary.height}px`}),Object.assign(this.cellSelectWrap.style,{left:`${c}px`,top:`${l}px`,width:`${o.width}px`,height:`${o.height}px`}),this.quill.emitter.emit(B.TABLE_SELECTION_DISPLAY_CHANGE,this)}}},{key:`getTableViewScroll`,value:function(){return this.table?ur(this.table.parentElement):{x:0,y:0}}},{key:`setSelectionTable`,value:function(e){this.table!==e&&(this.table=e,this.table?this.scrollRecordEls.push(this.table.parentElement):this.scrollRecordEls.pop())}},{key:`showDisplay`,value:function(){Object.assign(this.cellSelectWrap.style,{display:`block`}),this.isDisplaySelection=!0,this.table&&this.resizeObserver.observe(this.table)}},{key:`show`,value:function(){var e=this;this.table&&(lr.call(this),this.showDisplay(),this.update(),this.quill.root.addEventListener(`keydown`,this.keyboardHandler),sr.call(this,this.quill.root,function(){e.update()}),sr.call(this,this.table.parentElement,function(){e.update()}))}},{key:`hideDisplay`,value:function(){Object.assign(this.cellSelectWrap.style,{display:`none`}),this.isDisplaySelection=!1,this.table&&this.resizeObserver.unobserve(this.table)}},{key:`hide`,value:function(){lr.call(this),this.quill.root.removeEventListener(`keydown`,this.keyboardHandler),this.hideDisplay(),this.boundary=null,this.setSelectedTds([]),this.setSelectionTable(void 0)}},{key:`destroy`,value:function(){this.resizeObserver.disconnect(),this.hide(),this.cellSelectWrap.remove(),lr.call(this),document.removeEventListener(`paste`,this.handlePaste),this.quill.off(B.AFTER_TABLE_RESIZE,this.updateAfterEvent),this.quill.off(t.default.events.EDITOR_CHANGE,this.updateWhenTextChange),this.quill.off(t.default.events.SELECTION_CHANGE,this.quillSelectionChangeHandler)}}])}(Jr);x(ea,`moduleName`,V.tableSelectionName);var ta=[`attributes`],na=[`style`],ra=[`emptyRow`],ia=t.default.import(`parchment`),aa=t.default.import(`delta`),oa=t.default.import(`ui/icons`),sa=t.default.import(`blots/break`),ca=t.default.import(`blots/block`),la=t.default.import(`blots/block/embed`);function ua(e,t){var n={tableId:t.tableId,rowId:t.rowId,colId:t.colId,colspan:1,rowspan:1},r=e.create(R.tableCell,n),i=e.create(R.tableCellInner,n),a=e.create(`block`);return a.appendChild(e.create(`break`)),i.appendChild(a),r.appendChild(i),r}function da(e){ue.delete(R.tableCellInner),Object.assign(R,e.blotName||{}),Object.assign(z,e.tableUpSize||{}),Object.assign(B,e.tableUpEvent||{}),Object.assign(V,e.tableUpInternal||{}),ma.moduleName=V.moduleName,ma.toolName=R.tableWrapper,K.blotName=R.container,Vr.blotName=R.tableCaption,qr.blotName=R.tableWrapper,X.blotName=R.tableMain,Ur.blotName=R.tableColgroup,Hr.blotName=R.tableCol,Gr.blotName=R.tableHead,Mr.blotName=R.tableBody,Wr.blotName=R.tableFoot,J.blotName=R.tableRow,Y.blotName=R.tableCell,q.blotName=R.tableCellInner,ue.add(R.tableCellInner)}function fa(e,n){return Ue({onSelect:function(r,i){e.insertTable(r,i,t.default.sources.USER),n&&n.close()},customBtn:e.options.customBtn,texts:e.options.texts})}function pa(e){return{bindInHead:!1,key:e?`ArrowUp`:`ArrowDown`,collapsed:!0,format:[R.tableCellInner],handler:function(n,r){var i=e?`prev`:`next`,a=e?`tail`:`head`;if(r.line[i])return!0;var o=this.quill.selection.getBounds(n.index),s=r.line.domNode.getBoundingClientRect();if(!o||!s)return!0;if(e){if(o.top-s.top>3)return!0}else if(s.bottom-o.bottom>3)return!0;var c,l,u,d;try{var f=F(pe(r.line,[R.tableWrapper,R.tableMain,R.tableRow,R.tableCell]),4);c=f[0],l=f[1],u=f[2],d=f[3]}catch(e){return!0}var p=l.getColIds(),m=c.descendants(Vr,0)[0],h;if(m){var g=window.getComputedStyle(m.domNode);h=i===`next`&&g.captionSide===`bottom`?m:i===`next`?c.next:m}else h=c[i];if(r.line[i]||!h)return!0;var _=u[i];if(_){var v=p.indexOf(d.colId),y=_.getCellByColId(p[v],i);if(!y)return!0;var b=y.children[a];b.children&&(b=b.children[a]);var x=b.offset(this.quill.scroll)+Math.min(r.offset,b.length()-1);this.quill.setSelection(x,0,t.default.sources.USER)}else{var S=h.offset(this.quill.scroll)+(e?h.length()-1:0);this.quill.setSelection(S,0,t.default.sources.USER)}return!1}}}var ma=function(){function e(t,n){var r=this;_(this,e),x(this,`quill`,void 0),x(this,`options`,void 0),x(this,`toolBox`,void 0),x(this,`fixTableByLisenter`,vr(this.balanceTables,100)),x(this,`selector`,void 0),x(this,`resizeOb`,void 0),x(this,`modules`,{}),this.quill=t,this.options=this.resolveOptions(n||{}),this.toolBox=this.initialContainer();var i=this.quill.getModule(`toolbar`);if(i&&this.quill.theme.pickers){var a=F((i.controls||[]).find(function(e){return F(e,1)[0]===r.statics.toolName})||[],2)[1];if(a&&a.tagName.toLocaleLowerCase()===`select`){var o=this.quill.theme.pickers.find(function(e){return e.select===a});o&&(o.label.innerHTML=this.options.icon,this.buildCustomSelect(this.options.customSelect,o),o.label.addEventListener(`mousedown`,function(){if(!(!r.selector||!o))if(ar(r.selector.getBoundingClientRect()).leftLimited){var e=o.label.getBoundingClientRect();Object.assign(o.options.style,{transform:`translateX(calc(-100% + ${e.width}px))`})}else Object.assign(o.options.style,{transform:void 0})}))}}for(var s=this.quill.getModule(`keyboard`),c=0,l=Object.values(e.keyboradHandler);c<l.length;c++){var u=l[c];u.bindInHead?s.bindings[u.key].unshift(u):s.addBinding(u.key,u)}this.initModules(),this.quillHack(),this.listenBalanceCells()}return y(e,[{key:`statics`,get:function(){return this.constructor}},{key:`initialContainer`,value:function(){var e=this,t=H(`toolbox`),n=this.quill.addContainer(t.b());return this.resizeOb=new ResizeObserver(function(){var t=e.quill.root.getBoundingClientRect(),r=e.quill.root,i=r.offsetLeft,a=r.offsetTop;Object.assign(n.style,{top:`${a}px`,left:`${i}px`,width:`${t.width}px`,height:`${t.height}px`})}),this.resizeOb.observe(this.quill.root),n}},{key:`addContainer`,value:function(e){if(Oe(e)){var t=document.createElement(`div`),n=b(e.split(` `)),r;try{for(n.s();!(r=n.n()).done;){var i=r.value;t.classList.add(i)}}catch(e){n.e(e)}finally{n.f()}return this.toolBox.appendChild(t),t}else return this.toolBox.appendChild(e),e}},{key:`resolveOptions`,value:function(e){return Object.assign({customBtn:!1,texts:this.resolveTexts(e.texts||{}),full:!1,fullSwitch:!0,icon:oa.table,autoMergeCell:!0,modules:[]},e)}},{key:`resolveTexts`,value:function(e){return Object.assign({fullCheckboxText:`Insert full width table`,customBtnText:`Custom`,confirmText:`Confirm`,cancelText:`Cancel`,rowText:`Row`,colText:`Column`,notPositiveNumberError:`Please enter a positive integer`,custom:`Custom`,clear:`Clear`,transparent:`Transparent`,perWidthInsufficient:`The percentage width is insufficient. To complete the operation, the table needs to be converted to a fixed width. Do you want to continue?`,CopyCell:`Copy cell`,CutCell:`Cut cell`,InsertTop:`Insert row above`,InsertRight:`Insert column right`,InsertBottom:`Insert row below`,InsertLeft:`Insert column Left`,MergeCell:`Merge Cell`,SplitCell:`Split Cell`,DeleteRow:`Delete Row`,DeleteColumn:`Delete Column`,DeleteTable:`Delete table`,BackgroundColor:`Set background color`,BorderColor:`Set border color`},e)}},{key:`initModules`,value:function(){var e=b(this.options.modules),t;try{for(e.s();!(t=e.n()).done;){var n=t.value;this.modules[n.module.moduleName]=new n.module(this,this.quill,n.options)}}catch(t){e.e(t)}finally{e.f()}}},{key:`getModule`,value:function(e){return this.modules[e]}},{key:`quillHack`,value:function(){var e=this,n=this.quill.getSemanticHTML;this.quill.getSemanticHTML=function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0,a=n.call(e.quill,r,i),o=t.default.import(`formats/${R.tableWrapper}`),s=new DOMParser().parseFromString(a,`text/html`),c=0,l=Array.from(s.querySelectorAll(`.${o.className} caption[contenteditable], .${o.className} .${Y.className} > [contenteditable]`));c<l.length;c++)l[c].removeAttribute(`contenteditable`);return s.body.innerHTML};var r=this.quill.format;this.quill.format=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.default.sources.API;if(!(this.scroll.query(e).prototype instanceof ia.EmbedBlot)){var a=this.getModule(V.moduleName),o=this.getSelection(!0),s=this.getFormat(o),c=a.getModule(V.tableSelectionName);if(!s[R.tableCellInner]||o.length>0||a&&c&&c.selectedTds.length<=1)return r.call(this,e,n,i);if(a&&c&&c.selectedTds.length>0){var l=c.selectedTds,u=!1,d=[],f=b(l),p;try{for(f.s();!(p=f.n()).done;){var m=p.value,h=m.offset(this.scroll),g=m.length();d.push({index:h,length:g}),this.getFormat(h,g)[e]!==n&&(u=!0)}}catch(e){f.e(e)}finally{f.f()}var _=u?n:!1,v=new aa,y=b(d.entries()),S;try{for(y.s();!(S=y.n()).done;){var C=F(S.value,2),w=C[0],T=C[1],E=T.index,D=T.length,O=w===0?0:d[w-1].index+d[w-1].length;v.retain(E-O).retain(D,x({},e,_))}}catch(e){y.e(e)}finally{y.f()}var k=this.updateContents(v,i);return this.blur(),k}}return r.call(this,e,n,i)};var i=this.quill.theme.modules.toolbar;if(i){var a,o=(a=i.handlers)==null?void 0:a.clean;if(o){var s=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return``},i=e.quill.getText(t,n),a=F(e.quill.getLine(t+n),2),o=a[0],s=a[1],c=0,l=new aa;o!=null&&(c=o.length()-s,l=o.delta().slice(s,s+c-1).insert(`
`));var u=e.quill.getContents(t,n+c),d=u.diff(new aa().insert(i).concat(l)),f=0;return new aa(d.ops.map(function(e){var t=e.attributes,n=M(e,ta);if(e.insert?f-=Oe(e.insert)?e.insert.length:1:e.retain?f+=ke(e.retain)?e.retain:1:e.delete&&(f+=e.delete),t){var i=R.tableCellInner;t[i];var a=M(t,[i].map(ie));if(r){var o=u.slice(f-1,f).ops[0];if(o&&o.attributes&&o.attributes[R.tableCellInner]){var s=o.attributes[R.tableCellInner],c=s.style,l=M(s,na),d=r(c);return d?j(j({},n),{},{attributes:j(j({},a),{},x({},R.tableCellInner,j({style:d},l)))}):j(j({},n),{},{attributes:j(j({},a),{},x({},R.tableCellInner,l))})}}return j(j({},n),{},{attributes:j({},a)})}return e}))};i.handlers.clean=function(e){var n=this,r=this.quill.getModule(V.moduleName),i=this.quill.getSelection();if(i&&i.length>0&&this.quill.getFormat(i)[R.tableCellInner]){var a=s(i.index,i.length,!1),c=new aa().retain(i.index).concat(a);this.quill.updateContents(c,t.default.sources.USER);return}var l=r.getModule(V.tableSelectionName);if(r&&l&&l.selectedTds.length>0&&l.table){var u=t.default.find(l.table);if(!u){console.warn(`TableMainFormat not found`);return}var d=l.selectedTds,f=new Set,p=[],m=b(d),h;try{for(m.s();!(h=m.n()).done;){var g=h.value;if(g.parent instanceof Y){var _=b(g.parent.getNearByCell(`top`)),v;try{for(_.s();!(v=_.n()).done;){var y=v.value;f.has(y)||(f.add(y),p.push({td:y,cleanBorder:`bottom`}))}}catch(e){_.e(e)}finally{_.f()}var x=b(g.parent.getNearByCell(`left`)),S;try{for(x.s();!(S=x.n()).done;){var C=S.value;f.has(C)||(f.add(C),p.push({td:C,cleanBorder:`right`}))}}catch(e){x.e(e)}finally{x.f()}f.add(g.parent),p.push({td:g.parent,cleanBorder:!0})}}}catch(e){m.e(e)}finally{m.f()}var w=u.descendants(Y),T=new Map(w.map(function(e,t){return[e,t]}));p.sort(function(e,t){return T.get(e.td)-T.get(t.td)});for(var E=new aa,D=0,O=function(){var e=A[k],t=e.td,r=e.cleanBorder,i=t.getCellInner().offset(n.quill.scroll),a=t.getCellInner().length(),o=s(i,a-1,function(e){if(!e||r===!0)return``;var t=gr(e);return _r(Object.keys(t).filter(function(e){return!e.startsWith(mr(`border-${r}`))}).reduce(function(e,n){return e[n]=t[n],e},{}))}),c=new aa().retain(i-D).concat(o);E=E.concat(c),D=i+a},k=0,A=p;k<A.length;k++)O();this.quill.updateContents(E,t.default.sources.USER),d.length>1&&this.quill.blur();return}return o.call(this,e)}}}}},{key:`buildCustomSelect`,value:function(){var e=h(P().mark(function e(t,n){var r=this,i,a,o,s,c;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t||!Ee(t))){e.next=1;break}return e.abrupt(`return`);case 1:return i=document.createElement(`div`),i.classList.add(`ql-custom-select`),e.next=2,t(this,n);case 2:this.selector=e.sent,i.appendChild(this.selector),this.options.fullSwitch&&(a=H(`creator`),o=document.createElement(`label`),o.classList.add(a.be(`checkbox`)),s=document.createElement(`input`),s.type=`checkbox`,s.checked=this.options.full,s.addEventListener(`change`,function(){r.options.full=s.checked}),c=document.createElement(`span`),c.textContent=this.options.texts.fullCheckboxText,o.appendChild(s),o.appendChild(c),i.appendChild(o)),n.options.innerHTML=``,n.options.appendChild(i);case 3:case`end`:return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:`setCellAttrs`,value:function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e.length!==0){var i=b(e),a;try{for(i.s();!(a=i.n()).done;)a.value.setFormatValue(t,n,r)}catch(e){i.e(e)}finally{i.f()}}}},{key:`getTextByCell`,value:function(e){var t=``,n=b(e),r;try{for(n.s();!(r=n.n()).done;){var i=r.value,a=i.offset(this.quill.scroll),o=i.length(),s=b(this.quill.getContents(a,o).ops),c;try{for(s.s();!(c=s.n()).done;){var l=c.value;Oe(l.insert)&&(t+=l.insert)}}catch(e){s.e(e)}finally{s.f()}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:`getHTMLByCell`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.length===0)return``;var n=null;try{var r=b(e),i;try{for(r.s();!(i=r.n()).done;){var a=i.value,o=U(a,R.tableMain);if(n||(n=o),o!==n)return console.error(`tableMain is not same`),``}}catch(e){r.e(e)}finally{r.f()}}catch(e){return console.error(`tds must be in same tableMain`),``}if(!n)return``;var s=this.quill.getIndex(n),c=n.length(),l=this.quill.getSemanticHTML(s,c),u=new DOMParser().parseFromString(l,`text/html`),d=Array.from(u.querySelectorAll(`col`)),f=d.map(function(e){return e.dataset.colId}),p=[],m=new Set,h=new Set,g=b(e),_;try{for(g.s();!(_=g.n()).done;){var v=_.value;m.add(v.colId);for(var y=v.colId,x=f.indexOf(y),S=0;S<v.colspan;S++)m.add(f[x+S]);h.add(`${v.rowId}-${v.colId}`)}}catch(e){g.e(e)}finally{g.f()}for(var C=0;C<d.length;C++){var w=d[C];m.has(w.dataset.colId)?p.push(w.getAttribute(`width`)):(w.remove(),d.splice(C--,1))}for(var T=0,E=null,D=0,O=Array.from(u.querySelectorAll(`td, th`));D<O.length;D++){var k=O[D];if(h.has(`${k.dataset.rowId}-${k.dataset.colId}`))E!==k.dataset.rowId&&(T+=1,E=k.dataset.rowId);else{var A=k.parentElement;k.remove(),A&&A.children.length<=0&&A.remove()}}var j=d.map(function(e){return Hr.value(e)});if(n.full){var M=j.reduce(function(e,t){return t.width+e},0),N=b(j.entries()),ee;try{for(N.s();!(ee=N.n()).done;){var P=F(ee.value,2),te=P[0],ne=P[1];ne.width=Math.round(ne.width/M*100),d[te].setAttribute(`width`,`${ne.width}%`)}}catch(e){N.e(e)}finally{N.f()}}else{var I=0,L=b(j),re;try{for(L.s();!(re=L.n()).done;){var ie=re.value;I+=ie.width}}catch(e){L.e(e)}finally{L.f()}var ae=u.querySelector(`table`);ae.style.width=`${I}px`}if(t){var oe=n.getRows();if(T===oe.length)this.removeCol(e);else{var se=b(e),z;try{for(se.s();!(z=se.n()).done;){var B=z.value;B.domNode.innerHTML=`<p><br></p>`}}catch(e){se.e(e)}finally{se.f()}}}return u.body.innerHTML}},{key:`insertTable`,value:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.default.sources.API;if(e>=30||n>=30)throw Error(`Both rows and columns must be less than 30.`);this.quill.focus();var i=this.quill.getSelection();if(i!=null){var a=F(this.quill.getLeaf(i.index),1)[0];if(a){if(fe(a))throw Error(`Not supported ${a.statics.blotName} insert into table.`);var o=G(),s=Array(n).fill(0).map(function(){return G()}),c=this.calculateTableCellBorderWidth(),l=getComputedStyle(this.quill.root),u=Number.parseInt(l.paddingLeft),d=Number.parseInt(l.paddingRight),f=this.quill.root.scrollHeight>this.quill.root.clientHeight?dr({target:this.quill.root}):0,p=Number.parseInt(l.width)-u-d-c-f,m=this.options.full?`${Math.max(1/n*100,z.colMinWidthPre)}%`:`${Math.max(Math.floor(p/n),z.colMinWidthPx)}px`,h=[{retain:i.index}],g=this.quill.getContents(i.index,1),_=F(this.quill.getLine(i.index),2)[1];g.ops[0].insert!==`
`&&_!==0&&h.push({insert:`
`});for(var v=0;v<n;v++)h.push({insert:x({},R.tableCol,{width:m,tableId:o,colId:s[v],full:this.options.full})});for(var y=0;y<e;y++)for(var b=G(),S=0;S<n;S++)h.push({insert:`
`,attributes:x({},R.tableCellInner,{tableId:o,rowId:b,colId:s[S],rowspan:1,colspan:1})});this.quill.updateContents(new aa(h),r),this.quill.setSelection(i.index+n,t.default.sources.SILENT),this.quill.focus()}}}},{key:`calculateTableCellBorderWidth`,value:function(){var e=`
      <table class="${X.className}">
        <tbody>
          <tr>
            <td class="${Y.className}"></td>
          </tr>
        </tbody>
      </table>
    `,t=document.createElement(`div`);t.className=qr.className,t.innerHTML=e,t.style.position=`absolute`,t.style.left=`-9999px`,t.style.top=`-9999px`,t.style.visibility=`hidden`,this.quill.root.appendChild(t);var n=window.getComputedStyle(t.querySelector(`td`)),r=Number.parseFloat(n.borderWidth)||0;return this.quill.root.removeChild(t),r}},{key:`fixUnusuaDeletelTable`,value:function(e){var t=e.getColIds();if(t.length===0){e.remove();return}var n=e.getBodys(),r=e.tableId,i=b(n),a;try{for(i.s();!(a=i.n()).done;){var o=a.value,s=o.getRows();if(s.length===0){o.remove();continue}var c=Array(s.length).fill(0).map(function(){return Array(t.length).fill(!1)}),l=b(s.entries()),u;try{for(l.s();!(u=l.n()).done;){for(var d=F(u.value,2),f=d[0],p=d[1],m=0,h=0,g=c[f],_=p.descendants(Y);h<t.length;){if(g[h]){h+=1;continue}var v=_[m];if(!v||v.colId!==t[h])p.insertBefore(ua(this.quill.scroll,{tableId:r,colId:t[h],rowId:p.rowId}),v);else{f+v.rowspan-1>=s.length&&(v.getCellInner().rowspan=s.length-f);var y=v.colspan,x=v.rowspan;if(y>1)for(var S=1;S<y;S++)g[h+S]=!0;if(x>1)for(var C=f+1;C<f+x;C++)for(var w=0;w<y;w++)c[C][h+w]=!0;m+=1}h+=1}if(m<_.length)for(var T=m;T<_.length;T++)_[T].remove()}}catch(e){l.e(e)}finally{l.f()}}}catch(e){i.e(e)}finally{i.f()}}},{key:`balanceTables`,value:function(){var e=b(this.quill.scroll.descendants(X)),t;try{for(e.s();!(t=e.n()).done;){var n=t.value;n.checkEmptyCol(this.options.autoMergeCell),n.checkEmptyRow(this.options.autoMergeCell),this.fixUnusuaDeletelTable(n)}}catch(t){e.e(t)}finally{e.f()}}},{key:`listenBalanceCells`,value:function(){var e=this;this.quill.on(t.default.events.SCROLL_OPTIMIZE,function(n){n.some(function(t){return[`TD`,`TR`,`TBODY`,`TABLE`].includes(t.target.tagName)?(e.fixTableByLisenter(),!0):!1});var r=b(n),i;try{for(r.s();!(i=r.n()).done;){var a=i.value.target;if(a.tagName===`TABLE`){var o=t.default.find(a);if(o){o.sortMergeChildren();break}}}}catch(e){r.e(e)}finally{r.f()}})}},{key:`deleteTable`,value:function(e){if(e.length!==0){var t=U(e[0],R.tableMain);t&&t.remove()}}},{key:`appendRow`,value:function(e,t){if(!(e.length<=0)){var n=e[t?e.length-1:0],r=F(pe(n,[R.tableMain,R.tableRow]),2),i=r[0],a=r[1],o=i.getRows().indexOf(a)+(t?n.rowspan:0);i.insertRow(o)}}},{key:`appendCol`,value:function(e,t){if(!(e.length<=0)){var n=F(e.reduce(function(e,n){var r=n.getColumnIndex();return(!t&&r<=e[1]||t&&r>=e[1])&&(e=[n,r]),e},[e[0],e[0].getColumnIndex()]),1)[0],r=n.getColumnIndex()+(t?n.colspan:0),i=U(n,R.tableMain),a=i.tableId,o=G(),s=F(i.descendants(Ur),1)[0];s&&s.insertColByIndex(r,{tableId:a,colId:o,width:i.full?6:160,full:i.full});for(var c=i.getRows(),l=[],u=0,d=0,f=Object.values(c);d<f.length;d++){var p=f[d],m=l.shift()||0;if(u>0){--u;continue}var h=p.insertCell(r-m,{tableId:a,rowId:p.rowId,colId:o,rowspan:1,colspan:1});h.skipRowNum&&(u+=h.skipRowNum);var g=b(h.entries()),_;try{for(g.s();!(_=g.n()).done;){var v=F(_.value,2),y=v[0],x=v[1];l[y]=(l[y]||0)+x}}catch(e){g.e(e)}finally{g.f()}}}}},{key:`fixTableByRemove`,value:function(e){if(this.options.autoMergeCell){var t=e.getRows(),n=e.getCols(),r=n.reduce(function(e,t){return e[t.colId]=0,e},{}),i=t.toReversed(),a=[],o=b(i.entries()),s;try{var c=function(){var e=F(s.value,2),n=e[0],i=e[1],o=t.length-n-1;i.children.length<=0?a.push(o):i.foreachCellInner(function(e){var t=a.reduce(function(t,n){return e.rowspan+o>n?t+1:t},0);e.rowspan-=t,r[e.colId]+=1})};for(o.s();!(s=o.n()).done;)c()}catch(e){o.e(e)}finally{o.f()}for(var l=0,u=0,d=Object.values(r);u<d.length;u++)if(d[u]===0)for(var f=[],p=0,m=0,h=Object.values(t);m<h.length;m++){var g=h[m],_=f.shift()||0,v=[];p>0?(v=g.getCellByColumIndex(l-_)[2],--p):(v=g.removeCell(l-_),v.skipRowNum&&(p+=v.skipRowNum));var y=b(v.entries()),x;try{for(y.s();!(x=y.n()).done;){var S=F(x.value,2),C=S[0],w=S[1];f[C]=(f[C]||0)+w}}catch(e){y.e(e)}finally{y.f()}}else l+=1;var T=b(n),E;try{for(T.s();!(E=T.n()).done;){var D=E.value;r[D.colId]===0&&(D.prev?D.prev.width+=D.width:D.next&&(D.next.width+=D.width),D.remove())}}catch(e){T.e(e)}finally{T.f()}}}},{key:`removeRow`,value:function(e){if(!(e.length<=0)){var t=e[0],n=U(t,R.tableMain),r=n.getRows(),i=r.length,a=-1,o=b(e),s;try{for(o.s();!(s=o.n()).done;){var c=s.value,l=U(c,R.tableRow),u=r.indexOf(l);u<i&&(i=u),u+c.rowspan>a&&(a=u+c.rowspan)}}catch(e){o.e(e)}finally{o.f()}for(var d={},f=function(e){var t=r[e];t.foreachCellInner(function(t){t.rowspan+e>a&&(d[t.colId]={rowspan:t.rowspan+e-a,colspan:t.colspan,colIndex:t.getColumnIndex()}),t.parent.remove()}),t.length()===0&&t.remove()},p=i;p<Math.min(r.length,a);p++)f(p);if(r[a])for(var m=r[a],h=n.tableId,g=0,_=Object.entries(d);g<_.length;g++){var v=F(_[g],2),y=v[0],x=v[1],S=x.colIndex,C=x.colspan,w=x.rowspan;m.insertCell(S,{tableId:h,rowId:m.rowId,colId:y,colspan:C,rowspan:w})}this.fixTableByRemove(n)}}},{key:`removeCol`,value:function(e){if(!(e.length<=0)){var t=e[0],n=U(t,R.tableMain),r={},i=b(e),a;try{for(i.s();!(a=i.n()).done;){var o=a.value;r[o.rowId]||(r[o.rowId]=0),r[o.rowId]+=o.colspan}}catch(e){i.e(e)}finally{i.f()}for(var s=Math.max.apply(Math,L(Object.values(r))),c=t.getColumnIndex(),l=n.descendants(J),u=0;u<s;u++)for(var d=[],f=0,p=0,m=Object.values(l);p<m.length;p++){var h=m[p],g=d.shift()||0;if(f>0){--f;continue}var _=h.removeCell(c-g);_.skipRowNum&&(f+=_.skipRowNum);var v=b(_.entries()),y;try{for(v.s();!(y=v.n()).done;){var x=F(y.value,2),S=x[0],C=x[1];d[S]=(d[S]||0)+C}}catch(e){v.e(e)}finally{v.f()}}var w=F(n.descendants(Ur),1)[0];if(w)for(var T=0;T<s;T++)w.removeColByIndex(c);this.fixTableByRemove(n)}}},{key:`mergeCells`,value:function(e){if(!(e.length<=1)){var n=e[0],r=n.getTableBody(),i=n.getTableRow();if(!(!r||!i)){for(var a=1;a<e.length;a++){var o=e[a],s=o.getTableBody();if(s&&s!==r){var c=o.getTableRow();c&&(i.parent.insertBefore(c,i.next),i=c)}}r.convertBody(n.wrapTag);var l=e.reduce(function(e,t,n){var r=t.colId;e[0][r]||(e[0][r]=0),e[0][r]+=t.rowspan;var i=t.rowId;return e[1][i]||(e[1][i]=0),e[1][i]+=t.colspan,n!==0&&(t.moveChildren(e[2]),t.parent.remove()),e},[{},{},n]),u=Math.max.apply(Math,L(Object.values(l[0]))),d=Math.max.apply(Math,L(Object.values(l[1]))),f=l[2];f.colspan=d,f.rowspan=u;var p=this.quill.getIndex(f);this.quill.setSelection({index:p,length:0},t.default.sources.SILENT);var m=U(f,R.tableMain);this.fixTableByRemove(m)}}}},{key:`splitCell`,value:function(e){if(e.length===1){var t=e[0];if(!(t.colspan===1&&t.rowspan===1)){var n=F(pe(t,[R.tableMain,R.tableRow]),2),r=n[0],i=n[1],a=r.getRows(),o=r.tableId,s=t.getColumnIndex(),c=r.getColIds().slice(s,s+t.colspan).toReversed(),l=t.formats()[R.tableCellInner];l.emptyRow;var u=M(l,ra),d=a.indexOf(i);if(d!==-1){var f=a[d],p=t.rowspan;for(t.colspan=1,t.rowspan=1;f&&p>0;){var m=b(c),h;try{for(m.s();!(h=m.n()).done;){var g=h.value;f===i&&g===t.colId||f.insertCell(s+(f===i?1:0),j(j({},u),{},{tableId:o,rowId:f.rowId,colId:g,rowspan:1,colspan:1}))}}catch(e){m.e(e)}finally{m.f()}--p,d+=1,f=a[d]}}}}}},{key:`convertTableBodyByCells`,value:function(e,t,n){var r,i,a=e.getRows(),o=b(t),s;try{for(o.s();!(s=o.n()).done;){var c=s.value.getTableRow();if(c){var l=a.indexOf(c);je(r)&&(r=l),je(i)&&(i=l),l<r?(i=r,r=l):l>i&&(i=l)}}}catch(e){o.e(e)}finally{o.f()}if(je(r)||je(i)){console.warn(`TableRow not found`);return}var u=a[r],d=a[i];e.split(d.offset(e)+d.length());var f=e.split(u.offset(e)),p=f.getRows(),m=F(f.getBodys(),1)[0],h=m.clone();f.appendChild(h);var g=b(p),_;try{for(g.s();!(_=g.n()).done;){var v=_.value;v.length()>0&&h.appendChild(v)}}catch(e){g.e(e)}finally{g.f()}h.convertBody(n),m.remove()}}],[{key:`register`,value:function(){var e;qr.allowedChildren=[X],X.allowedChildren=[Ur,Vr,Gr,Mr,Wr],X.requiredContainer=qr,Vr.requiredContainer=X,Ur.allowedChildren=[Hr],Ur.requiredContainer=X,Gr.allowedChildren=[J],Gr.requiredContainer=X,Mr.allowedChildren=[J],Mr.requiredContainer=X,Wr.allowedChildren=[J],Wr.requiredContainer=X,J.allowedChildren=[Y],Y.allowedChildren=[q,sa],Y.requiredContainer=J,q.requiredContainer=Y;var n=new Set([`table`]),r=Object.entries(t.default.imports).filter(function(e){var t=F(e,2),r=t[0],i=t[1],a=r.split(`formats/`)[1];return r.startsWith(`formats/`)&&!n.has(a)&&(ve(i,ca)||ve(i,la))}).reduce(function(e,t){var n=F(t,2),r=n[0],i=n[1];return e[r]=function(e){function t(){return _(this,t),g(this,t,arguments)}return w(t,e),y(t,null,[{key:`register`,value:function(){}}])}(_e(i,[ve(i,la)?Ar:kr])),e},{});t.default.register(j(j({"blots/scroll":Ir,"blots/block":kr,"blots/block/embed":Ar},r),{},(e={},x(x(x(x(x(x(x(x(x(x(e,`blots/${R.container}`,K),`formats/${R.tableCell}`,Y),`formats/${R.tableCellInner}`,q),`formats/${R.tableRow}`,J),`formats/${R.tableHead}`,Gr),`formats/${R.tableBody}`,Mr),`formats/${R.tableFoot}`,Wr),`formats/${R.tableCol}`,Hr),`formats/${R.tableColgroup}`,Ur),`formats/${R.tableCaption}`,Vr),x(x(x(e,`formats/${R.tableMain}`,X),`formats/${R.tableWrapper}`,qr),`modules/clipboard`,gi))),!0)}}])}();x(ma,`moduleName`,V.moduleName),x(ma,`toolName`,R.tableWrapper),x(ma,`keyboradHandler`,{"forbid remove table by backspace":{bindInHead:!0,key:`Backspace`,collapsed:!0,offset:0,handler:function(e,t){var n=this.quill.getLine(e.index)[0];return n.prev instanceof qr?(n.prev.remove(),!1):!(t.format[R.tableCellInner]&&n.offset(U(n,R.tableCellInner))===0)}},"forbid remove table by delete":{bindInHead:!0,key:`Delete`,collapsed:!0,handler:function(e,t){var n=this.quill.getLine(e.index),r=n[0],i=n[1];return!((r.next instanceof qr||r.next instanceof Hr)&&i===r.length()-1||t.format[R.tableCellInner]&&r===U(r,R.tableCellInner).children.tail&&i===r.length()-1)}},"table up":pa(!0),"table down":pa(!1),"table caption break":{bindInHead:!0,key:`Enter`,shiftKey:null,format:[R.tableCaption],handler:function(e,t){return!1}}});var ha=ma;e.BlockEmbedOverride=Ar,e.BlockOverride=kr,e.ContainerFormat=K,e.ScrollOverride=Ir,e.Scrollbar=Zi,e.TableAlign=Yr,e.TableBodyFormat=Mr,e.TableCaptionFormat=Vr,e.TableCellFormat=Y,e.TableCellInnerFormat=q,e.TableClipboard=gi,e.TableColFormat=Hr,e.TableColgroupFormat=Ur,e.TableDomSelector=Jr,e.TableFootFormat=Wr,e.TableHeadFormat=Gr,e.TableMainFormat=X,e.TableMenuCommon=Ri,e.TableMenuContextmenu=zi,e.TableMenuSelect=Bi,e.TableResizeBox=Ji,e.TableResizeCommon=Wi,e.TableResizeCommonHelper=Ui,e.TableResizeLine=Yi,e.TableResizeScale=Xi,e.TableRowFormat=J,e.TableSelection=ea,e.TableUp=ma,e.TableVirtualScrollbar=Qi,e.TableWrapperFormat=qr,e.applyCellUpdates=oi,e.blotName=R,e.createColorPicker=Fe,e.createSelectBox=Ue,e.createTooltip=er,e.default=ha,e.defaultCustomSelect=fa,e.findParentBlot=U,e.findParentBlots=pe,e.getCellPositions=ni,e.getColRect=Hi,e.getCountByPosition=ei,e.getTableCellStructure=Qr,e.getTableMainRect=Z,e.groupCellByRow=ri,e.isTableAlignRight=Vi,e.parsePasteDelta=$r,e.pasteCells=Zr,e.pasteWithLoop=ii,e.pasteWithStructure=ti,e.prepareCellUpdate=ai,e.randomId=G,e.removeOverlappingCells=si,e.tableMenuTools=Q,e.tableUpEvent=B,e.tableUpInternal=V,e.tableUpSize=z,e.updateTableConstants=da});
//# sourceMappingURL=index.umd.js.map